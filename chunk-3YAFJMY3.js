import{a as fa}from"./chunk-VSA5H45Z.js";import{c as wn,d as Xe,f as qe,g as Ke,h as Ze}from"./chunk-ZSSD5RUB.js";import{b as ca,i as ua,k as da,m as ha,n as Tt}from"./chunk-66MMXZ4U.js";import{$ as Oe,A as bi,Ab as re,B as un,Ba as Qs,C as dn,Ca as ta,D as Qr,E as wi,Fa as ea,G as hn,Ga as gn,Gb as oa,Hb as yn,Ia as Ei,K as pe,L as to,La as v,Ma as oo,Mb as Zt,Oa as je,R as fn,Ra as ia,Rb as sa,T as eo,Tb as xn,U as ct,Ua as D,V as io,Vb as bn,W as me,Wb as ge,Xb as aa,Y as it,Ya as Z,Zb as la,a as ht,b as Ws,ba as no,bb as _n,ca as w,d as Pe,db as V,e as Xs,eb as gt,f as ln,fb as Ne,gb as q,h as qs,ha as pn,hb as _t,ib as rt,ja as nt,jb as ot,k as Y,ka as ft,kb as g,la as pt,lb as m,ma as mn,mb as T,na as Zs,nb as St,o as Se,oa as ro,ob as W,pb as H,qa as Ut,qb as k,rb as lt,s as cn,sb as bt,t as Mt,ta as mt,tb as na,ua as ne,ub as We,vb as Dt,wb as vn,xa as Pt,xb as ra,yb as ut,z as Ks,za as Js,zb as $t}from"./chunk-MMANLKD6.js";var It={KMT:{EMBLEM:"https://upload.wikimedia.org/wikipedia/commons/a/a1/Emblem_of_the_Kuomintang.svg",CN_FULL_NAME:"\u4E2D\u570B\u570B\u6C11\u9EE8",CN_SHORT_NAME:"\u570B\u6C11\u9EE8",EN_FULL_NAME:"Kuomintang Chinese Nationalist Party",EN_SHORT_NAME:"KMT",PRESIDENT_3D_IMG:"images/3d-president/man-vampire.png",REPRESENTATIVE_COLOR:"#8082FF"},DPP:{EMBLEM:"https://upload.wikimedia.org/wikipedia/zh/c/c1/Emblem_of_Democratic_Progressive_Party_%28new%29.svg",CN_FULL_NAME:"\u6C11\u4E3B\u9032\u6B65\u9EE8",CN_SHORT_NAME:"\u6C11\u9032\u9EE8",EN_FULL_NAME:"Democratic Progressive Party",EN_SHORT_NAME:"DPP",PRESIDENT_3D_IMG:"images/3d-president/troll.png",REPRESENTATIVE_COLOR:"#57D2A9"},TPP:{EMBLEM:"https://upload.wikimedia.org/wikipedia/commons/0/0c/Emblem_of_Taiwan_People%27s_Party_2019.svg",CN_FULL_NAME:"\u53F0\u7063\u6C11\u773E\u9EE8",CN_SHORT_NAME:"\u6C11\u773E\u9EE8",EN_FULL_NAME:"Taiwan People's Party",EN_SHORT_NAME:"TPP",PRESIDENT_3D_IMG:"images/3d-president/man_in_steamy_room.png",REPRESENTATIVE_COLOR:"#77DBEE"},PFP:{EMBLEM:"https://upload.wikimedia.org/wikipedia/zh/6/65/Flag_of_People_First_Party.png",CN_FULL_NAME:"\u89AA\u6C11\u9EE8",CN_SHORT_NAME:"\u89AA\u6C11\u9EE8",EN_FULL_NAME:"People First Party",EN_SHORT_NAME:"PFP",PRESIDENT_3D_IMG:"images/3d-president/man-elf.png",REPRESENTATIVE_COLOR:"#F4A76F"},NP:{EMBLEM:"https://upload.wikimedia.org/wikipedia/commons/0/01/Np_logo.svg",CN_FULL_NAME:"\u65B0\u9EE8",CN_SHORT_NAME:"\u65B0\u9EE8",EN_FULL_NAME:"New Party",EN_SHORT_NAME:"NP",PRESIDENT_3D_IMG:"images/3d-president/person-mage.png",REPRESENTATIVE_COLOR:"#F9DA4A"},PETITION:{EMBLEM:"",CN_FULL_NAME:"\u9023\u7F72",CN_SHORT_NAME:"",EN_FULL_NAME:"Petition",EN_SHORT_NAME:"PETITION",PRESIDENT_3D_IMG:"images/3d-president/man-genie.png",REPRESENTATIVE_COLOR:"#CED4DA"},EMPTY:{EMBLEM:"",CN_FULL_NAME:"\u7121\u9EE8\u7C4D\u53CA\u672A\u7D93\u653F\u9EE8\u63A8\u85A6",CN_SHORT_NAME:"",EN_FULL_NAME:"Empty",EN_SHORT_NAME:"EMPTY",PRESIDENT_3D_IMG:"images/3d-president/woman-zombie.png",REPRESENTATIVE_COLOR:"#CED4DA"}};var Je=class{NO;VOTE_COUNT;constructor(t){this.NO=Number.isNaN(parseInt(t?.NO))?null:t.NO,this.VOTE_COUNT=Number.isNaN(parseInt(t?.VOTE_COUNT))?null:t.VOTE_COUNT}};var En=class{CANDIDATES_VOTES;VALID_VOTES;INVALID_VOTES;TOTAL_VOTES;UNRETURNED_BALLOTS;TOTAL_ISSUED_BALLOTS;UNUSED_BALLOTS;ELIGIBLE_VOTERS;TURNOUT_RATE;constructor(t){this.CANDIDATES_VOTES=Array.isArray(t?.CANDIDATES_VOTES)?t.CANDIDATES_VOTES.map(i=>new Je(i)):[],this.VALID_VOTES=Number.isNaN(parseInt(t?.VALID_VOTES))?null:t.VALID_VOTES,this.INVALID_VOTES=Number.isNaN(parseInt(t?.INVALID_VOTES))?null:t.INVALID_VOTES,this.TOTAL_VOTES=Number.isNaN(parseInt(t?.TOTAL_VOTES))?null:t.TOTAL_VOTES,this.UNRETURNED_BALLOTS=Number.isNaN(parseInt(t?.UNRETURNED_BALLOTS))?null:t.UNRETURNED_BALLOTS,this.TOTAL_ISSUED_BALLOTS=Number.isNaN(parseInt(t?.TOTAL_ISSUED_BALLOTS))?null:t.TOTAL_ISSUED_BALLOTS,this.UNUSED_BALLOTS=Number.isNaN(parseInt(t?.UNUSED_BALLOTS))?null:t.UNUSED_BALLOTS,this.ELIGIBLE_VOTERS=Number.isNaN(parseInt(t?.ELIGIBLE_VOTERS))?null:t.ELIGIBLE_VOTERS,this.TURNOUT_RATE=Number.isNaN(parseInt(t?.TURNOUT_RATE))?null:t.TURNOUT_RATE}};var ke=class extends En{ADMIN_LEVEL;ADMIN_NAME;ADMIN_CODE;constructor(t){super(t),this.ADMIN_LEVEL=t?.ADMIN_LEVEL||"\u672A\u77E5",this.ADMIN_NAME=t?.ADMIN_NAME||"",this.ADMIN_CODE=t?.ADMIN_CODE||""}};var Qe=class{NO;PARTY;PRESIDENT;VICE_PRESIDENT;constructor(t){this.NO=Number.isNaN(parseInt(t?.NO))?null:t.NO,this.PARTY=t?.PARTY||"",this.PRESIDENT=t?.PRESIDENT||"",this.VICE_PRESIDENT=t?.VICE_PRESIDENT||""}};var Yt=class{ELECTION_TITLE;ELECTION_TERM;ELECTION_GREGORIAN_YEAR;CANDIDATES;TOTAL_STATISTICS;ADMIN_COLLECTION;constructor(t){this.ELECTION_TITLE=t?.ELECTION_TITLE||"",this.ELECTION_TERM=Number.isNaN(parseInt(t?.ELECTION_TERM))?null:t.ELECTION_TERM,this.ELECTION_GREGORIAN_YEAR=t?.ELECTION_GREGORIAN_YEAR||"",this.CANDIDATES=Array.isArray(t?.CANDIDATES)?t.CANDIDATES.map(i=>new Qe(i)):[],this.TOTAL_STATISTICS=new ke(t?.TOTAL_STATISTICS),this.ADMIN_COLLECTION=Array.isArray(t?.ADMIN_COLLECTION)?t.ADMIN_COLLECTION.map(i=>new ke(i)):[]}};var Ci=class{COUNTYCODE;COUNTYENG;COUNTYID;COUNTYNAME;NOTE;TOWNCODE;TOWNID;TOWNNAME;VILLCODE;VILLENG;VILLNAME;constructor(t){this.COUNTYCODE=t.COUNTYCODE||"",this.COUNTYENG=t.COUNTYENG||"",this.COUNTYID=t.COUNTYID||"",this.COUNTYNAME=t.COUNTYNAME||"",this.NOTE=t.NOTE||"",this.TOWNCODE=t.TOWNCODE||"",this.TOWNID=t.TOWNID||"",this.TOWNNAME=t.TOWNNAME||"",this.VILLCODE=t.VILLCODE||"",this.VILLENG=t.VILLENG||"",this.VILLNAME=t.VILLNAME||""}};var ti=class e{constructor(t,i){this.http=t;this.commonService=i}fetchCountyGeoJson(){let t="COUNTY_MOI_1130718",i="map-topo-json/"+t+".json";return this.http.get(i).pipe(Mt(n=>n),Mt(n=>this.commonService.convertTopoToFeatures(n,t)),Mt(n=>n.features),io(n=>n.forEach(r=>r.properties=new Ci(r.properties))),fn(1))}fetchTownshipGeoJson(){let t="TOWN_MOI_1130718",i="map-topo-json/"+t+".json";return this.http.get(i).pipe(Mt(n=>n),Mt(n=>this.commonService.convertTopoToFeatures(n,t)),Mt(n=>n.features),io(n=>n.forEach(r=>r.properties=new Ci(r.properties))),fn(1))}fetchCentralVotesJson(t){let i=`presidential-election-json/${t}/CENTRAL.json`;return this.http.get(i).pipe(Mt(n=>new Yt(n)))}fetchCountyVotesJson(t,i){let n=`presidential-election-json/${t}/COUNTY_${i}.json`;return this.http.get(n).pipe(Mt(r=>new Yt(r)))}fetchTownVotesJson(t,i){let n=`presidential-election-json/${t}/TOWN_${i}.json`;return this.http.get(n).pipe(Mt(r=>new Yt(r)))}static \u0275fac=function(i){return new(i||e)(no(ca),no(Tt))};static \u0275prov=it({token:e,factory:e.\u0275fac,providedIn:"root"})};function so(e){return Array.isArray(e)?e:[e]}function at(e){return e==null?"":typeof e=="string"?e:`${e}px`}function pa(e){return e instanceof Pt?e.nativeElement:e}var ao;try{ao=typeof Intl<"u"&&Intl.v8BreakIterator}catch{ao=!1}var Le=(()=>{class e{_platformId=w(Qs);isBrowser=this._platformId?la(this._platformId):typeof document=="object"&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!!(window.chrome||ao)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(n){return new(n||e)};static \u0275prov=it({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var Me;function lo(){if(Me==null){if(typeof document!="object"||!document||typeof Element!="function"||!Element)return Me=!1,Me;if("scrollBehavior"in document.documentElement.style)Me=!0;else{let e=Element.prototype.scrollTo;e?Me=!/\{\s*\[native code\]\s*\}/.test(e.toString()):Me=!1}}return Me}function co(e){return e.composedPath?e.composedPath()[0]:e.target}function uo(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}var Hu=new Oe("cdk-dir-doc",{providedIn:"root",factory:zu});function zu(){return w(Zt)}var Du=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function $u(e){let t=e?.toLowerCase()||"";return t==="auto"&&typeof navigator<"u"&&navigator?.language?Du.test(navigator.language)?"rtl":"ltr":t==="rtl"?"rtl":"ltr"}var ma=(()=>{class e{value="ltr";change=new mt;constructor(){let i=w(Hu,{optional:!0});if(i){let n=i.body?i.body.dir:null,r=i.documentElement?i.documentElement.dir:null;this.value=$u(n||r||"ltr")}}ngOnDestroy(){this.change.complete()}static \u0275fac=function(n){return new(n||e)};static \u0275prov=it({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var Yu=20,xa=(()=>{class e{_ngZone=w(ne);_platform=w(Le);_renderer=w(je).createRenderer(null,null);_cleanupGlobalListener;constructor(){}_scrolled=new Y;_scrolledCount=0;scrollContainers=new Map;register(i){this.scrollContainers.has(i)||this.scrollContainers.set(i,i.elementScrolled().subscribe(()=>this._scrolled.next(i)))}deregister(i){let n=this.scrollContainers.get(i);n&&(n.unsubscribe(),this.scrollContainers.delete(i))}scrolled(i=Yu){return this._platform.isBrowser?new qs(n=>{this._cleanupGlobalListener||(this._cleanupGlobalListener=this._ngZone.runOutsideAngular(()=>this._renderer.listen("document","scroll",()=>this._scrolled.next())));let r=i>0?this._scrolled.pipe(Qr(i)).subscribe(n):this._scrolled.subscribe(n);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||(this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0)}}):Se()}ngOnDestroy(){this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0,this.scrollContainers.forEach((i,n)=>this.deregister(n)),this._scrolled.complete()}ancestorScrolled(i,n){let r=this.getAncestorScrollContainers(i);return this.scrolled(n).pipe(dn(o=>!o||r.indexOf(o)>-1))}getAncestorScrollContainers(i){let n=[];return this.scrollContainers.forEach((r,o)=>{this._scrollableContainsElement(o,i)&&n.push(o)}),n}_scrollableContainsElement(i,n){let r=pa(n),o=i.getElementRef().nativeElement;do if(r==o)return!0;while(r=r.parentElement);return!1}static \u0275fac=function(n){return new(n||e)};static \u0275prov=it({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var Uu=20,fo=(()=>{class e{_platform=w(Le);_listeners;_viewportSize;_change=new Y;_document=w(Zt,{optional:!0});constructor(){let i=w(ne),n=w(je).createRenderer(null,null);i.runOutsideAngular(()=>{if(this._platform.isBrowser){let r=o=>this._change.next(o);this._listeners=[n.listen("window","resize",r),n.listen("window","orientationchange",r)]}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){this._listeners?.forEach(i=>i()),this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let i={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),i}getViewportRect(){let i=this.getViewportScrollPosition(),{width:n,height:r}=this.getViewportSize();return{top:i.top,left:i.left,bottom:i.top+r,right:i.left+n,height:r,width:n}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let i=this._document,n=this._getWindow(),r=i.documentElement,o=r.getBoundingClientRect(),s=-o.top||i.body.scrollTop||n.scrollY||r.scrollTop||0,a=-o.left||i.body.scrollLeft||n.scrollX||r.scrollLeft||0;return{top:s,left:a}}change(i=Uu){return i>0?this._change.pipe(Qr(i)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let i=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:i.innerWidth,height:i.innerHeight}:{width:0,height:0}}static \u0275fac=function(n){return new(n||e)};static \u0275prov=it({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var Ai=class{_attachedHost;attach(t){return this._attachedHost=t,t.attach(this)}detach(){let t=this._attachedHost;t!=null&&(this._attachedHost=null,t.detach())}get isAttached(){return this._attachedHost!=null}setAttachedHost(t){this._attachedHost=t}},oe=class extends Ai{component;viewContainerRef;injector;componentFactoryResolver;projectableNodes;constructor(t,i,n,r,o){super(),this.component=t,this.viewContainerRef=i,this.injector=n,this.projectableNodes=o}},Pn=class extends Ai{templateRef;viewContainerRef;context;injector;constructor(t,i,n,r){super(),this.templateRef=t,this.viewContainerRef=i,this.context=n,this.injector=r}get origin(){return this.templateRef.elementRef}attach(t,i=this.context){return this.context=i,super.attach(t)}detach(){return this.context=void 0,super.detach()}},po=class extends Ai{element;constructor(t){super(),this.element=t instanceof Pt?t.nativeElement:t}},mo=class{_attachedPortal;_disposeFn;_isDisposed=!1;hasAttached(){return!!this._attachedPortal}attach(t){if(t instanceof oe)return this._attachedPortal=t,this.attachComponentPortal(t);if(t instanceof Pn)return this._attachedPortal=t,this.attachTemplatePortal(t);if(this.attachDomPortal&&t instanceof po)return this._attachedPortal=t,this.attachDomPortal(t)}attachDomPortal=null;detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(t){this._disposeFn=t}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}};var Sn=class extends mo{outletElement;_appRef;_defaultInjector;_document;constructor(t,i,n,r,o){super(),this.outletElement=t,this._appRef=n,this._defaultInjector=r,this._document=o}attachComponentPortal(t){let i;if(t.viewContainerRef){let n=t.injector||t.viewContainerRef.injector,r=n.get(ia,null,{optional:!0})||void 0;i=t.viewContainerRef.createComponent(t.component,{index:t.viewContainerRef.length,injector:n,ngModuleRef:r,projectableNodes:t.projectableNodes||void 0}),this.setDisposeFn(()=>i.destroy())}else i=yn(t.component,{elementInjector:t.injector||this._defaultInjector||Ut.NULL,environmentInjector:this._appRef.injector,projectableNodes:t.projectableNodes||void 0}),this._appRef.attachView(i.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(i.hostView),i.destroy()});return this.outletElement.appendChild(this._getComponentRootNode(i)),this._attachedPortal=t,i}attachTemplatePortal(t){let i=t.viewContainerRef,n=i.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return n.rootNodes.forEach(r=>this.outletElement.appendChild(r)),n.detectChanges(),this.setDisposeFn(()=>{let r=i.indexOf(n);r!==-1&&i.remove(r)}),this._attachedPortal=t,n}attachDomPortal=t=>{let i=t.element;i.parentNode;let n=this._document.createComment("dom-portal");i.parentNode.insertBefore(n,i),this.outletElement.appendChild(i),this._attachedPortal=t,super.setDisposeFn(()=>{n.parentNode&&n.parentNode.replaceChild(i,n)})};dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(t){return t.hostView.rootNodes[0]}};var On=new WeakMap,go=(()=>{class e{_appRef;_injector=w(Ut);_environmentInjector=w(pn);load(i){let n=this._appRef=this._appRef||this._injector.get(_n),r=On.get(n);r||(r={loaders:new Set,refs:[]},On.set(n,r),n.onDestroy(()=>{On.get(n)?.refs.forEach(o=>o.destroy()),On.delete(n)})),r.loaders.has(i)||(r.loaders.add(i),r.refs.push(yn(i,{environmentInjector:this._environmentInjector})))}static \u0275fac=function(n){return new(n||e)};static \u0275prov=it({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var _o={},ba=(()=>{class e{_appId=w(Js);getId(i){return this._appId!=="ng"&&(i+=this._appId),_o.hasOwnProperty(i)||(_o[i]=0),`${i}${_o[i]++}`}static \u0275fac=function(n){return new(n||e)};static \u0275prov=it({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var wa=lo(),vo=class{_viewportRuler;_previousHTMLStyles={top:"",left:""};_previousScrollPosition;_isEnabled=!1;_document;constructor(t,i){this._viewportRuler=t,this._document=i}attach(){}enable(){if(this._canBeEnabled()){let t=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=t.style.left||"",this._previousHTMLStyles.top=t.style.top||"",t.style.left=at(-this._previousScrollPosition.left),t.style.top=at(-this._previousScrollPosition.top),t.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){let t=this._document.documentElement,i=this._document.body,n=t.style,r=i.style,o=n.scrollBehavior||"",s=r.scrollBehavior||"";this._isEnabled=!1,n.left=this._previousHTMLStyles.left,n.top=this._previousHTMLStyles.top,t.classList.remove("cdk-global-scrollblock"),wa&&(n.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),wa&&(n.scrollBehavior=o,r.scrollBehavior=s)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;let i=this._document.body,n=this._viewportRuler.getViewportSize();return i.scrollHeight>n.height||i.scrollWidth>n.width}};var yo=class{_scrollDispatcher;_ngZone;_viewportRuler;_config;_scrollSubscription=null;_overlayRef;_initialScrollPosition;constructor(t,i,n,r){this._scrollDispatcher=t,this._ngZone=i,this._viewportRuler=n,this._config=r}attach(t){this._overlayRef,this._overlayRef=t}enable(){if(this._scrollSubscription)return;let t=this._scrollDispatcher.scrolled(0).pipe(dn(i=>!i||!this._overlayRef.overlayElement.contains(i.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=t.subscribe(()=>{let i=this._viewportRuler.getViewportScrollPosition().top;Math.abs(i-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=t.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}_detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}},Nn=class{enable(){}disable(){}attach(){}};function xo(e,t){return t.some(i=>{let n=e.bottom<i.top,r=e.top>i.bottom,o=e.right<i.left,s=e.left>i.right;return n||r||o||s})}function Ea(e,t){return t.some(i=>{let n=e.top<i.top,r=e.bottom>i.bottom,o=e.left<i.left,s=e.right>i.right;return n||r||o||s})}var bo=class{_scrollDispatcher;_viewportRuler;_ngZone;_config;_scrollSubscription=null;_overlayRef;constructor(t,i,n,r){this._scrollDispatcher=t,this._viewportRuler=i,this._ngZone=n,this._config=r}attach(t){this._overlayRef,this._overlayRef=t}enable(){if(!this._scrollSubscription){let t=this._config?this._config.scrollThrottle:0;this._scrollSubscription=this._scrollDispatcher.scrolled(t).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){let i=this._overlayRef.overlayElement.getBoundingClientRect(),{width:n,height:r}=this._viewportRuler.getViewportSize();xo(i,[{width:n,height:r,bottom:r,right:n,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}})}}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}},ju=(()=>{class e{_scrollDispatcher=w(xa);_viewportRuler=w(fo);_ngZone=w(ne);_document=w(Zt);constructor(){}noop=()=>new Nn;close=i=>new yo(this._scrollDispatcher,this._ngZone,this._viewportRuler,i);block=()=>new vo(this._viewportRuler,this._document);reposition=i=>new bo(this._scrollDispatcher,this._viewportRuler,this._ngZone,i);static \u0275fac=function(n){return new(n||e)};static \u0275prov=it({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),wo=class{positionStrategy;scrollStrategy=new Nn;panelClass="";hasBackdrop=!1;backdropClass="cdk-overlay-dark-backdrop";width;height;minWidth;minHeight;maxWidth;maxHeight;direction;disposeOnNavigation=!1;constructor(t){if(t){let i=Object.keys(t);for(let n of i)t[n]!==void 0&&(this[n]=t[n])}}};var Eo=class{connectionPair;scrollableViewProperties;constructor(t,i){this.connectionPair=t,this.scrollableViewProperties=i}};var Na=(()=>{class e{_attachedOverlays=[];_document=w(Zt);_isAttached;constructor(){}ngOnDestroy(){this.detach()}add(i){this.remove(i),this._attachedOverlays.push(i)}remove(i){let n=this._attachedOverlays.indexOf(i);n>-1&&this._attachedOverlays.splice(n,1),this._attachedOverlays.length===0&&this.detach()}static \u0275fac=function(n){return new(n||e)};static \u0275prov=it({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Wu=(()=>{class e extends Na{_ngZone=w(ne);_renderer=w(je).createRenderer(null,null);_cleanupKeydown;add(i){super.add(i),this._isAttached||(this._ngZone.runOutsideAngular(()=>{this._cleanupKeydown=this._renderer.listen("body","keydown",this._keydownListener)}),this._isAttached=!0)}detach(){this._isAttached&&(this._cleanupKeydown?.(),this._isAttached=!1)}_keydownListener=i=>{let n=this._attachedOverlays;for(let r=n.length-1;r>-1;r--)if(n[r]._keydownEvents.observers.length>0){this._ngZone.run(()=>n[r]._keydownEvents.next(i));break}};static \u0275fac=(()=>{let i;return function(r){return(i||(i=ro(e)))(r||e)}})();static \u0275prov=it({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Xu=(()=>{class e extends Na{_platform=w(Le);_ngZone=w(ne,{optional:!0});_cursorOriginalValue;_cursorStyleIsSet=!1;_pointerDownEventTarget;add(i){if(super.add(i),!this._isAttached){let n=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(n)):this._addEventListeners(n),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=n.style.cursor,n.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){let i=this._document.body;i.removeEventListener("pointerdown",this._pointerDownListener,!0),i.removeEventListener("click",this._clickListener,!0),i.removeEventListener("auxclick",this._clickListener,!0),i.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(i.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(i){i.addEventListener("pointerdown",this._pointerDownListener,!0),i.addEventListener("click",this._clickListener,!0),i.addEventListener("auxclick",this._clickListener,!0),i.addEventListener("contextmenu",this._clickListener,!0)}_pointerDownListener=i=>{this._pointerDownEventTarget=co(i)};_clickListener=i=>{let n=co(i),r=i.type==="click"&&this._pointerDownEventTarget?this._pointerDownEventTarget:n;this._pointerDownEventTarget=null;let o=this._attachedOverlays.slice();for(let s=o.length-1;s>-1;s--){let a=o[s];if(a._outsidePointerEvents.observers.length<1||!a.hasAttached())continue;if(Ca(a.overlayElement,n)||Ca(a.overlayElement,r))break;let u=a._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>u.next(i)):u.next(i)}};static \u0275fac=(()=>{let i;return function(r){return(i||(i=ro(e)))(r||e)}})();static \u0275prov=it({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Ca(e,t){let i=typeof ShadowRoot<"u"&&ShadowRoot,n=t;for(;n;){if(n===e)return!0;n=i&&n instanceof ShadowRoot?n.host:n.parentNode}return!1}var ka=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275cmp=D({type:e,selectors:[["ng-component"]],hostAttrs:["cdk-overlay-style-loader",""],decls:0,vars:0,template:function(n,r){},styles:[".cdk-overlay-container,.cdk-global-overlay-wrapper{pointer-events:none;top:0;left:0;height:100%;width:100%}.cdk-overlay-container{position:fixed}@layer cdk-overlay{.cdk-overlay-container{z-index:1000}}.cdk-overlay-container:empty{display:none}.cdk-global-overlay-wrapper{display:flex;position:absolute}@layer cdk-overlay{.cdk-global-overlay-wrapper{z-index:1000}}.cdk-overlay-pane{position:absolute;pointer-events:auto;box-sizing:border-box;display:flex;max-width:100%;max-height:100%}@layer cdk-overlay{.cdk-overlay-pane{z-index:1000}}.cdk-overlay-backdrop{position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:auto;-webkit-tap-highlight-color:rgba(0,0,0,0);opacity:0}@layer cdk-overlay{.cdk-overlay-backdrop{z-index:1000;transition:opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}}.cdk-overlay-backdrop-showing{opacity:1}@media(forced-colors: active){.cdk-overlay-backdrop-showing{opacity:.6}}@layer cdk-overlay{.cdk-overlay-dark-backdrop{background:rgba(0,0,0,.32)}}.cdk-overlay-transparent-backdrop{transition:visibility 1ms linear,opacity 1ms linear;visibility:hidden;opacity:1}.cdk-overlay-transparent-backdrop.cdk-overlay-backdrop-showing,.cdk-high-contrast-active .cdk-overlay-transparent-backdrop{opacity:0;visibility:visible}.cdk-overlay-backdrop-noop-animation{transition:none}.cdk-overlay-connected-position-bounding-box{position:absolute;display:flex;flex-direction:column;min-width:1px;min-height:1px}@layer cdk-overlay{.cdk-overlay-connected-position-bounding-box{z-index:1000}}.cdk-global-scrollblock{position:fixed;width:100%;overflow-y:scroll}"],encapsulation:2,changeDetection:0})}return e})(),Ma=(()=>{class e{_platform=w(Le);_containerElement;_document=w(Zt);_styleLoader=w(go);constructor(){}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._loadStyles(),this._containerElement||this._createContainer(),this._containerElement}_createContainer(){let i="cdk-overlay-container";if(this._platform.isBrowser||uo()){let r=this._document.querySelectorAll(`.${i}[platform="server"], .${i}[platform="test"]`);for(let o=0;o<r.length;o++)r[o].remove()}let n=this._document.createElement("div");n.classList.add(i),uo()?n.setAttribute("platform","test"):this._platform.isBrowser||n.setAttribute("platform","server"),this._document.body.appendChild(n),this._containerElement=n}_loadStyles(){this._styleLoader.load(ka)}static \u0275fac=function(n){return new(n||e)};static \u0275prov=it({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Co=class{_portalOutlet;_host;_pane;_config;_ngZone;_keyboardDispatcher;_document;_location;_outsideClickDispatcher;_animationsDisabled;_injector;_renderer;_backdropElement=null;_backdropTimeout;_backdropClick=new Y;_attachments=new Y;_detachments=new Y;_positionStrategy;_scrollStrategy;_locationChanges=ln.EMPTY;_cleanupBackdropClick;_cleanupBackdropTransitionEnd;_previousHostParent;_keydownEvents=new Y;_outsidePointerEvents=new Y;_renders=new Y;_afterRenderRef;_afterNextRenderRef;constructor(t,i,n,r,o,s,a,u,c,l=!1,d,h){this._portalOutlet=t,this._host=i,this._pane=n,this._config=r,this._ngZone=o,this._keyboardDispatcher=s,this._document=a,this._location=u,this._outsideClickDispatcher=c,this._animationsDisabled=l,this._injector=d,this._renderer=h,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy,this._afterRenderRef=oa(()=>ea(()=>{this._renders.next()},{injector:this._injector}))}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(t){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);let i=this._portalOutlet.attach(t);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._afterNextRenderRef?.destroy(),this._afterNextRenderRef=gn(()=>{this.hasAttached()&&this.updatePosition()},{injector:this._injector}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),typeof i?.onDestroy=="function"&&i.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),i}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();let t=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenEmpty(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),t}dispose(){let t=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._afterNextRenderRef?.destroy(),this._previousHostParent=this._pane=this._host=null,t&&this._detachments.next(),this._detachments.complete(),this._afterRenderRef.destroy(),this._renders.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(t){t!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=t,this.hasAttached()&&(t.attach(this),this.updatePosition()))}updateSize(t){this._config=ht(ht({},this._config),t),this._updateElementSize()}setDirection(t){this._config=Ws(ht({},this._config),{direction:t}),this._updateElementDirection()}addPanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!0)}removePanelClass(t){this._pane&&this._toggleClasses(this._pane,t,!1)}getDirection(){let t=this._config.direction;return t?typeof t=="string"?t:t.value:"ltr"}updateScrollStrategy(t){t!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=t,this.hasAttached()&&(t.attach(this),t.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;let t=this._pane.style;t.width=at(this._config.width),t.height=at(this._config.height),t.minWidth=at(this._config.minWidth),t.minHeight=at(this._config.minHeight),t.maxWidth=at(this._config.maxWidth),t.maxHeight=at(this._config.maxHeight)}_togglePointerEvents(t){this._pane.style.pointerEvents=t?"":"none"}_attachBackdrop(){let t="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._cleanupBackdropClick?.(),this._cleanupBackdropClick=this._renderer.listen(this._backdropElement,"click",i=>this._backdropClick.next(i)),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(t)})}):this._backdropElement.classList.add(t)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){let t=this._backdropElement;if(t){if(this._animationsDisabled){this._disposeBackdrop(t);return}t.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{this._cleanupBackdropTransitionEnd?.(),this._cleanupBackdropTransitionEnd=this._renderer.listen(t,"transitionend",i=>{this._disposeBackdrop(i.target)})}),t.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(t)},500))}}_toggleClasses(t,i,n){let r=so(i||[]).filter(o=>!!o);r.length&&(n?t.classList.add(...r):t.classList.remove(...r))}_detachContentWhenEmpty(){this._ngZone.runOutsideAngular(()=>{let t=this._renders.pipe(ct(un(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||this._pane.children.length===0)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),t.unsubscribe())})})}_disposeScrollStrategy(){let t=this._scrollStrategy;t&&(t.disable(),t.detach&&t.detach())}_disposeBackdrop(t){this._cleanupBackdropClick?.(),this._cleanupBackdropTransitionEnd?.(),t&&(t.remove(),this._backdropElement===t&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}},Aa="cdk-overlay-connected-position-bounding-box",qu=/([A-Za-z%]+)$/,Ao=class{_viewportRuler;_document;_platform;_overlayContainer;_overlayRef;_isInitialRender;_lastBoundingBoxSize={width:0,height:0};_isPushed=!1;_canPush=!0;_growAfterOpen=!1;_hasFlexibleDimensions=!0;_positionLocked=!1;_originRect;_overlayRect;_viewportRect;_containerRect;_viewportMargin=0;_scrollables=[];_preferredPositions=[];_origin;_pane;_isDisposed;_boundingBox;_lastPosition;_lastScrollVisibility;_positionChanges=new Y;_resizeSubscription=ln.EMPTY;_offsetX=0;_offsetY=0;_transformOriginSelector;_appliedPanelClasses=[];_previousPushAmount;positionChanges=this._positionChanges;get positions(){return this._preferredPositions}constructor(t,i,n,r,o){this._viewportRuler=i,this._document=n,this._platform=r,this._overlayContainer=o,this.setOrigin(t)}attach(t){this._overlayRef&&this._overlayRef,this._validatePositions(),t.hostElement.classList.add(Aa),this._overlayRef=t,this._boundingBox=t.hostElement,this._pane=t.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition){this.reapplyLastPosition();return}this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let t=this._originRect,i=this._overlayRect,n=this._viewportRect,r=this._containerRect,o=[],s;for(let a of this._preferredPositions){let u=this._getOriginPoint(t,r,a),c=this._getOverlayPoint(u,i,a),l=this._getOverlayFit(c,i,n,a);if(l.isCompletelyWithinViewport){this._isPushed=!1,this._applyPosition(a,u);return}if(this._canFitWithFlexibleDimensions(l,c,n)){o.push({position:a,origin:u,overlayRect:i,boundingBoxRect:this._calculateBoundingBoxRect(u,a)});continue}(!s||s.overlayFit.visibleArea<l.visibleArea)&&(s={overlayFit:l,overlayPoint:c,originPoint:u,position:a,overlayRect:i})}if(o.length){let a=null,u=-1;for(let c of o){let l=c.boundingBoxRect.width*c.boundingBoxRect.height*(c.position.weight||1);l>u&&(u=l,a=c)}this._isPushed=!1,this._applyPosition(a.position,a.origin);return}if(this._canPush){this._isPushed=!0,this._applyPosition(s.position,s.originPoint);return}this._applyPosition(s.position,s.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&Re(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(Aa),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;let t=this._lastPosition;if(t){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();let i=this._getOriginPoint(this._originRect,this._containerRect,t);this._applyPosition(t,i)}else this.apply()}withScrollableContainers(t){return this._scrollables=t,this}withPositions(t){return this._preferredPositions=t,t.indexOf(this._lastPosition)===-1&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(t){return this._viewportMargin=t,this}withFlexibleDimensions(t=!0){return this._hasFlexibleDimensions=t,this}withGrowAfterOpen(t=!0){return this._growAfterOpen=t,this}withPush(t=!0){return this._canPush=t,this}withLockedPosition(t=!0){return this._positionLocked=t,this}setOrigin(t){return this._origin=t,this}withDefaultOffsetX(t){return this._offsetX=t,this}withDefaultOffsetY(t){return this._offsetY=t,this}withTransformOriginOn(t){return this._transformOriginSelector=t,this}_getOriginPoint(t,i,n){let r;if(n.originX=="center")r=t.left+t.width/2;else{let s=this._isRtl()?t.right:t.left,a=this._isRtl()?t.left:t.right;r=n.originX=="start"?s:a}i.left<0&&(r-=i.left);let o;return n.originY=="center"?o=t.top+t.height/2:o=n.originY=="top"?t.top:t.bottom,i.top<0&&(o-=i.top),{x:r,y:o}}_getOverlayPoint(t,i,n){let r;n.overlayX=="center"?r=-i.width/2:n.overlayX==="start"?r=this._isRtl()?-i.width:0:r=this._isRtl()?0:-i.width;let o;return n.overlayY=="center"?o=-i.height/2:o=n.overlayY=="top"?0:-i.height,{x:t.x+r,y:t.y+o}}_getOverlayFit(t,i,n,r){let o=Sa(i),{x:s,y:a}=t,u=this._getOffset(r,"x"),c=this._getOffset(r,"y");u&&(s+=u),c&&(a+=c);let l=0-s,d=s+o.width-n.width,h=0-a,f=a+o.height-n.height,p=this._subtractOverflows(o.width,l,d),_=this._subtractOverflows(o.height,h,f),x=p*_;return{visibleArea:x,isCompletelyWithinViewport:o.width*o.height===x,fitsInViewportVertically:_===o.height,fitsInViewportHorizontally:p==o.width}}_canFitWithFlexibleDimensions(t,i,n){if(this._hasFlexibleDimensions){let r=n.bottom-i.y,o=n.right-i.x,s=Pa(this._overlayRef.getConfig().minHeight),a=Pa(this._overlayRef.getConfig().minWidth),u=t.fitsInViewportVertically||s!=null&&s<=r,c=t.fitsInViewportHorizontally||a!=null&&a<=o;return u&&c}return!1}_pushOverlayOnScreen(t,i,n){if(this._previousPushAmount&&this._positionLocked)return{x:t.x+this._previousPushAmount.x,y:t.y+this._previousPushAmount.y};let r=Sa(i),o=this._viewportRect,s=Math.max(t.x+r.width-o.width,0),a=Math.max(t.y+r.height-o.height,0),u=Math.max(o.top-n.top-t.y,0),c=Math.max(o.left-n.left-t.x,0),l=0,d=0;return r.width<=o.width?l=c||-s:l=t.x<this._viewportMargin?o.left-n.left-t.x:0,r.height<=o.height?d=u||-a:d=t.y<this._viewportMargin?o.top-n.top-t.y:0,this._previousPushAmount={x:l,y:d},{x:t.x+l,y:t.y+d}}_applyPosition(t,i){if(this._setTransformOrigin(t),this._setOverlayElementStyles(i,t),this._setBoundingBoxStyles(i,t),t.panelClass&&this._addPanelClasses(t.panelClass),this._positionChanges.observers.length){let n=this._getScrollVisibility();if(t!==this._lastPosition||!this._lastScrollVisibility||!Ku(this._lastScrollVisibility,n)){let r=new Eo(t,n);this._positionChanges.next(r)}this._lastScrollVisibility=n}this._lastPosition=t,this._isInitialRender=!1}_setTransformOrigin(t){if(!this._transformOriginSelector)return;let i=this._boundingBox.querySelectorAll(this._transformOriginSelector),n,r=t.overlayY;t.overlayX==="center"?n="center":this._isRtl()?n=t.overlayX==="start"?"right":"left":n=t.overlayX==="start"?"left":"right";for(let o=0;o<i.length;o++)i[o].style.transformOrigin=`${n} ${r}`}_calculateBoundingBoxRect(t,i){let n=this._viewportRect,r=this._isRtl(),o,s,a;if(i.overlayY==="top")s=t.y,o=n.height-s+this._viewportMargin;else if(i.overlayY==="bottom")a=n.height-t.y+this._viewportMargin*2,o=n.height-a+this._viewportMargin;else{let f=Math.min(n.bottom-t.y+n.top,t.y),p=this._lastBoundingBoxSize.height;o=f*2,s=t.y-f,o>p&&!this._isInitialRender&&!this._growAfterOpen&&(s=t.y-p/2)}let u=i.overlayX==="start"&&!r||i.overlayX==="end"&&r,c=i.overlayX==="end"&&!r||i.overlayX==="start"&&r,l,d,h;if(c)h=n.width-t.x+this._viewportMargin*2,l=t.x-this._viewportMargin;else if(u)d=t.x,l=n.right-t.x;else{let f=Math.min(n.right-t.x+n.left,t.x),p=this._lastBoundingBoxSize.width;l=f*2,d=t.x-f,l>p&&!this._isInitialRender&&!this._growAfterOpen&&(d=t.x-p/2)}return{top:s,left:d,bottom:a,right:h,width:l,height:o}}_setBoundingBoxStyles(t,i){let n=this._calculateBoundingBoxRect(t,i);!this._isInitialRender&&!this._growAfterOpen&&(n.height=Math.min(n.height,this._lastBoundingBoxSize.height),n.width=Math.min(n.width,this._lastBoundingBoxSize.width));let r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{let o=this._overlayRef.getConfig().maxHeight,s=this._overlayRef.getConfig().maxWidth;r.height=at(n.height),r.top=at(n.top),r.bottom=at(n.bottom),r.width=at(n.width),r.left=at(n.left),r.right=at(n.right),i.overlayX==="center"?r.alignItems="center":r.alignItems=i.overlayX==="end"?"flex-end":"flex-start",i.overlayY==="center"?r.justifyContent="center":r.justifyContent=i.overlayY==="bottom"?"flex-end":"flex-start",o&&(r.maxHeight=at(o)),s&&(r.maxWidth=at(s))}this._lastBoundingBoxSize=n,Re(this._boundingBox.style,r)}_resetBoundingBoxStyles(){Re(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){Re(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(t,i){let n={},r=this._hasExactPosition(),o=this._hasFlexibleDimensions,s=this._overlayRef.getConfig();if(r){let l=this._viewportRuler.getViewportScrollPosition();Re(n,this._getExactOverlayY(i,t,l)),Re(n,this._getExactOverlayX(i,t,l))}else n.position="static";let a="",u=this._getOffset(i,"x"),c=this._getOffset(i,"y");u&&(a+=`translateX(${u}px) `),c&&(a+=`translateY(${c}px)`),n.transform=a.trim(),s.maxHeight&&(r?n.maxHeight=at(s.maxHeight):o&&(n.maxHeight="")),s.maxWidth&&(r?n.maxWidth=at(s.maxWidth):o&&(n.maxWidth="")),Re(this._pane.style,n)}_getExactOverlayY(t,i,n){let r={top:"",bottom:""},o=this._getOverlayPoint(i,this._overlayRect,t);if(this._isPushed&&(o=this._pushOverlayOnScreen(o,this._overlayRect,n)),t.overlayY==="bottom"){let s=this._document.documentElement.clientHeight;r.bottom=`${s-(o.y+this._overlayRect.height)}px`}else r.top=at(o.y);return r}_getExactOverlayX(t,i,n){let r={left:"",right:""},o=this._getOverlayPoint(i,this._overlayRect,t);this._isPushed&&(o=this._pushOverlayOnScreen(o,this._overlayRect,n));let s;if(this._isRtl()?s=t.overlayX==="end"?"left":"right":s=t.overlayX==="end"?"right":"left",s==="right"){let a=this._document.documentElement.clientWidth;r.right=`${a-(o.x+this._overlayRect.width)}px`}else r.left=at(o.x);return r}_getScrollVisibility(){let t=this._getOriginRect(),i=this._pane.getBoundingClientRect(),n=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:Ea(t,n),isOriginOutsideView:xo(t,n),isOverlayClipped:Ea(i,n),isOverlayOutsideView:xo(i,n)}}_subtractOverflows(t,...i){return i.reduce((n,r)=>n-Math.max(r,0),t)}_getNarrowedViewportRect(){let t=this._document.documentElement.clientWidth,i=this._document.documentElement.clientHeight,n=this._viewportRuler.getViewportScrollPosition();return{top:n.top+this._viewportMargin,left:n.left+this._viewportMargin,right:n.left+t-this._viewportMargin,bottom:n.top+i-this._viewportMargin,width:t-2*this._viewportMargin,height:i-2*this._viewportMargin}}_isRtl(){return this._overlayRef.getDirection()==="rtl"}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(t,i){return i==="x"?t.offsetX==null?this._offsetX:t.offsetX:t.offsetY==null?this._offsetY:t.offsetY}_validatePositions(){}_addPanelClasses(t){this._pane&&so(t).forEach(i=>{i!==""&&this._appliedPanelClasses.indexOf(i)===-1&&(this._appliedPanelClasses.push(i),this._pane.classList.add(i))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(t=>{this._pane.classList.remove(t)}),this._appliedPanelClasses=[])}_getOriginRect(){let t=this._origin;if(t instanceof Pt)return t.nativeElement.getBoundingClientRect();if(t instanceof Element)return t.getBoundingClientRect();let i=t.width||0,n=t.height||0;return{top:t.y,bottom:t.y+n,left:t.x,right:t.x+i,height:n,width:i}}};function Re(e,t){for(let i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}function Pa(e){if(typeof e!="number"&&e!=null){let[t,i]=e.split(qu);return!i||i==="px"?parseFloat(t):null}return e||null}function Sa(e){return{top:Math.floor(e.top),right:Math.floor(e.right),bottom:Math.floor(e.bottom),left:Math.floor(e.left),width:Math.floor(e.width),height:Math.floor(e.height)}}function Ku(e,t){return e===t?!0:e.isOriginClipped===t.isOriginClipped&&e.isOriginOutsideView===t.isOriginOutsideView&&e.isOverlayClipped===t.isOverlayClipped&&e.isOverlayOutsideView===t.isOverlayOutsideView}var Oa="cdk-global-overlay-wrapper",Po=class{_overlayRef;_cssPosition="static";_topOffset="";_bottomOffset="";_alignItems="";_xPosition="";_xOffset="";_width="";_height="";_isDisposed=!1;attach(t){let i=t.getConfig();this._overlayRef=t,this._width&&!i.width&&t.updateSize({width:this._width}),this._height&&!i.height&&t.updateSize({height:this._height}),t.hostElement.classList.add(Oa),this._isDisposed=!1}top(t=""){return this._bottomOffset="",this._topOffset=t,this._alignItems="flex-start",this}left(t=""){return this._xOffset=t,this._xPosition="left",this}bottom(t=""){return this._topOffset="",this._bottomOffset=t,this._alignItems="flex-end",this}right(t=""){return this._xOffset=t,this._xPosition="right",this}start(t=""){return this._xOffset=t,this._xPosition="start",this}end(t=""){return this._xOffset=t,this._xPosition="end",this}width(t=""){return this._overlayRef?this._overlayRef.updateSize({width:t}):this._width=t,this}height(t=""){return this._overlayRef?this._overlayRef.updateSize({height:t}):this._height=t,this}centerHorizontally(t=""){return this.left(t),this._xPosition="center",this}centerVertically(t=""){return this.top(t),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;let t=this._overlayRef.overlayElement.style,i=this._overlayRef.hostElement.style,n=this._overlayRef.getConfig(),{width:r,height:o,maxWidth:s,maxHeight:a}=n,u=(r==="100%"||r==="100vw")&&(!s||s==="100%"||s==="100vw"),c=(o==="100%"||o==="100vh")&&(!a||a==="100%"||a==="100vh"),l=this._xPosition,d=this._xOffset,h=this._overlayRef.getConfig().direction==="rtl",f="",p="",_="";u?_="flex-start":l==="center"?(_="center",h?p=d:f=d):h?l==="left"||l==="end"?(_="flex-end",f=d):(l==="right"||l==="start")&&(_="flex-start",p=d):l==="left"||l==="start"?(_="flex-start",f=d):(l==="right"||l==="end")&&(_="flex-end",p=d),t.position=this._cssPosition,t.marginLeft=u?"0":f,t.marginTop=c?"0":this._topOffset,t.marginBottom=this._bottomOffset,t.marginRight=u?"0":p,i.justifyContent=_,i.alignItems=c?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;let t=this._overlayRef.overlayElement.style,i=this._overlayRef.hostElement,n=i.style;i.classList.remove(Oa),n.justifyContent=n.alignItems=t.marginTop=t.marginBottom=t.marginLeft=t.marginRight=t.position="",this._overlayRef=null,this._isDisposed=!0}},Pi=(()=>{class e{_viewportRuler=w(fo);_document=w(Zt);_platform=w(Le);_overlayContainer=w(Ma);constructor(){}global(){return new Po}flexibleConnectedTo(i){return new Ao(i,this._viewportRuler,this._document,this._platform,this._overlayContainer)}static \u0275fac=function(n){return new(n||e)};static \u0275prov=it({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),ei=(()=>{class e{scrollStrategies=w(ju);_overlayContainer=w(Ma);_positionBuilder=w(Pi);_keyboardDispatcher=w(Wu);_injector=w(Ut);_ngZone=w(ne);_document=w(Zt);_directionality=w(ma);_location=w(sa);_outsideClickDispatcher=w(Xu);_animationsModuleType=w(ta,{optional:!0});_idGenerator=w(ba);_renderer=w(je).createRenderer(null,null);_appRef;_styleLoader=w(go);constructor(){}create(i){this._styleLoader.load(ka);let n=this._createHostElement(),r=this._createPaneElement(n),o=this._createPortalOutlet(r),s=new wo(i);return s.direction=s.direction||this._directionality.value,new Co(o,n,r,s,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,this._animationsModuleType==="NoopAnimations",this._injector.get(pn),this._renderer)}position(){return this._positionBuilder}_createPaneElement(i){let n=this._document.createElement("div");return n.id=this._idGenerator.getId("cdk-overlay-"),n.classList.add("cdk-overlay-pane"),i.appendChild(n),n}_createHostElement(){let i=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(i),i}_createPortalOutlet(i){return this._appRef||(this._appRef=this._injector.get(_n)),new Sn(i,null,this._appRef,this._injector,this._document)}static \u0275fac=function(n){return new(n||e)};static \u0275prov=it({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var ii=class{constructor(t,i){this.overlay=t;this.config=i;this.overlayRef=this.overlay.create({hasBackdrop:!0,disposeOnNavigation:!0,positionStrategy:this.overlay.position().global().centerHorizontally().centerVertically(),width:this.config?.width,height:this.config?.height,panelClass:this.config?.panelClass}),this.id=this.overlayRef.overlayElement.id,this.config&&(this.config?.lockBackdrop||this.overlayRef.backdropClick().subscribe(()=>this.close()))}_afterClosedSubject=new Y;overlayRef;id;close(t){this.overlayRef.dispose(),this._afterClosedSubject.next(t),this._afterClosedSubject.complete()}afterClosed(){return this._afterClosedSubject.asObservable()}},So=new Oe("DIALOG_DATA"),kn=class e{_overlay=w(ei);_injector=w(Ut);activeDialog=[];open(t,i,n){n?.lockScroll;let r=new ii(this._overlay,n);this.toggleScrollLock(r.id,!!n?.lockScroll),r.overlayRef.detachments().subscribe(()=>this.toggleScrollLock(r.id,!1));let o=Ut.create({providers:[{provide:ii,useValue:r},{provide:So,useValue:i}],parent:this._injector}),s=new oe(t,null,o);return r.overlayRef.attach(s),r}toggleScrollLock(t,i){i?this.activeDialog.push(t):this.activeDialog=this.activeDialog.filter(n=>n!==t),this.activeDialog.length>0?document.querySelector("body")?.classList.add("overflow-hidden"):document.querySelector("body")?.classList.remove("overflow-hidden")}static \u0275fac=function(i){return new(i||e)};static \u0275prov=it({token:e,factory:e.\u0275fac,providedIn:"root"})};function Ju(e,t){e&1&&(g(0,"span"),k(1,"/"),m())}function Qu(e,t){if(e&1&&(g(0,"span"),k(1),m()),e&2){let i=H().$implicit;v(),lt(i)}}function td(e,t){if(e&1&&(g(0,"span",1),k(1),m()),e&2){let i=H().$implicit;v(),lt(i)}}function ed(e,t){if(e&1&&Z(0,Ju,2,0,"span")(1,Qu,2,1,"span")(2,td,2,1,"span",1),e&2){let i=t.$index,n=t.$count;q(i!==0?0:-1),v(),q(i!==n-1?1:2)}}var Mn=class e{breadcrumbList;static \u0275fac=function(i){return new(i||e)};static \u0275cmp=D({type:e,selectors:[["app-breadcrumb"]],inputs:{breadcrumbList:"breadcrumbList"},decls:3,vars:0,consts:[[1,"flex","h-full","items-center","gap-x-2","text-base","leading-4","text-light"],[1,"text-primary"]],template:function(i,n){i&1&&(g(0,"div",0),rt(1,ed,3,2,null,null,_t),m()),i&2&&(v(),ot(n.breadcrumbList))},styles:["span[_ngcontent-%COMP%]{cursor:default}"]})};var Ln=class e{commonService=w(Tt);toTopBtnVisible$=bi(window,"scroll").pipe(Mt(()=>document.documentElement.scrollTop>50));static \u0275fac=function(i){return new(i||e)};static \u0275cmp=D({type:e,selectors:[["app-to-top-button"]],decls:4,vars:3,consts:[[1,"fixed","bottom-6","right-6","opacity-0"],["type","button",1,"flex","h-11","w-11","items-center","justify-center","rounded-full","border","border-solid","border-primary","bg-white",3,"click"],["src","images/icons/arrow_upward.png","alt","arrow_upward",1,"pointer-events-none","h-5","w-5"]],template:function(i,n){i&1&&(g(0,"div",0),ut(1,"async"),g(2,"button",1),W("click",function(){return n.commonService.scrollToTop()}),T(3,"img",2),m()()),i&2&&V("@opacityVisibleHidden",$t(1,1,n.toTopBtnVisible$)?"visible":"hidden")},dependencies:[bn],encapsulation:2,data:{animation:[wn("opacityVisibleHidden",[Ke("visible",qe({opacity:"1"})),Ke("hidden",qe({opacity:"0"})),Ze("visible => hidden",[Xe("0.2s")]),Ze("hidden => visible",[Xe("0.2s")])])]}})};function Fe(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Oo(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Rn(e){let t,i,n;e.length!==2?(t=Fe,i=(a,u)=>Fe(e(a),u),n=(a,u)=>e(a)-u):(t=e===Fe||e===Oo?e:id,i=e,n=e);function r(a,u,c=0,l=a.length){if(c<l){if(t(u,u)!==0)return l;do{let d=c+l>>>1;i(a[d],u)<0?c=d+1:l=d}while(c<l)}return c}function o(a,u,c=0,l=a.length){if(c<l){if(t(u,u)!==0)return l;do{let d=c+l>>>1;i(a[d],u)<=0?c=d+1:l=d}while(c<l)}return c}function s(a,u,c=0,l=a.length){let d=r(a,u,c,l-1);return d>c&&n(a[d-1],u)>-n(a[d],u)?d-1:d}return{left:r,center:s,right:o}}function id(){return 0}function No(e){return e===null?NaN:+e}var La=Rn(Fe),Ra=La.right,nd=La.left,rd=Rn(No).center,ko=Ra;var Gt=class{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){let i=this._partials,n=0;for(let r=0;r<this._n&&r<32;r++){let o=i[r],s=t+o,a=Math.abs(t)<Math.abs(o)?t-(s-o):o-(s-t);a&&(i[n++]=a),t=s}return i[n]=t,this._n=n+1,this}valueOf(){let t=this._partials,i=this._n,n,r,o,s=0;if(i>0){for(s=t[--i];i>0&&(n=s,r=t[--i],s=n+r,o=r-(s-n),!o););i>0&&(o<0&&t[i-1]<0||o>0&&t[i-1]>0)&&(r=o*2,n=s+r,r==n-s&&(s=n))}return s}};var _e=class extends Map{constructor(t,i=ad){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:i}}),t!=null)for(let[n,r]of t)this.set(n,r)}get(t){return super.get(Fa(this,t))}has(t){return super.has(Fa(this,t))}set(t,i){return super.set(od(this,t),i)}delete(t){return super.delete(sd(this,t))}};function Fa({_intern:e,_key:t},i){let n=t(i);return e.has(n)?e.get(n):i}function od({_intern:e,_key:t},i){let n=t(i);return e.has(n)?e.get(n):(e.set(n,i),i)}function sd({_intern:e,_key:t},i){let n=t(i);return e.has(n)&&(i=e.get(n),e.delete(n)),i}function ad(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Fn(e){return e}function ni(e,...t){return ld(e,Fn,Fn,t)}function ld(e,t,i,n){return function r(o,s){if(s>=n.length)return i(o);let a=new _e,u=n[s++],c=-1;for(let l of o){let d=u(l,++c,o),h=a.get(d);h?h.push(l):a.set(d,[l])}for(let[l,d]of a)a.set(l,r(d,s));return t(a)}(e,0)}var cd=Math.sqrt(50),ud=Math.sqrt(10),dd=Math.sqrt(2);function Tn(e,t,i){let n=(t-e)/Math.max(0,i),r=Math.floor(Math.log10(n)),o=n/Math.pow(10,r),s=o>=cd?10:o>=ud?5:o>=dd?2:1,a,u,c;return r<0?(c=Math.pow(10,-r)/s,a=Math.round(e*c),u=Math.round(t*c),a/c<e&&++a,u/c>t&&--u,c=-c):(c=Math.pow(10,r)*s,a=Math.round(e/c),u=Math.round(t/c),a*c<e&&++a,u*c>t&&--u),u<a&&.5<=i&&i<2?Tn(e,t,i*2):[a,u,c]}function ri(e,t,i){if(t=+t,e=+e,i=+i,!(i>0))return[];if(e===t)return[e];let n=t<e,[r,o,s]=n?Tn(t,e,i):Tn(e,t,i);if(!(o>=r))return[];let a=o-r+1,u=new Array(a);if(n)if(s<0)for(let c=0;c<a;++c)u[c]=(o-c)/-s;else for(let c=0;c<a;++c)u[c]=(o-c)*s;else if(s<0)for(let c=0;c<a;++c)u[c]=(r+c)/-s;else for(let c=0;c<a;++c)u[c]=(r+c)*s;return u}function Si(e,t,i){return t=+t,e=+e,i=+i,Tn(e,t,i)[2]}function Mo(e,t,i){t=+t,e=+e,i=+i;let n=t<e,r=n?Si(t,e,i):Si(e,t,i);return(n?-1:1)*(r<0?1/-r:r)}function In(e,t){let i;if(t===void 0)for(let n of e)n!=null&&(i<n||i===void 0&&n>=n)&&(i=n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(i<r||i===void 0&&r>=r)&&(i=r)}return i}function*hd(e){for(let t of e)yield*Xs(t)}function oi(e){return Array.from(hd(e))}function Vn(e,t,i){e=+e,t=+t,i=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+i;for(var n=-1,r=Math.max(0,Math.ceil((t-e)/i))|0,o=new Array(r);++n<r;)o[n]=e+n*i;return o}function Ta(e){return e}var Lo=1,Ro=2,Ia=3,Oi=4,Va=1e-6;function fd(e){return"translate("+e+",0)"}function pd(e){return"translate(0,"+e+")"}function md(e){return t=>+e(t)}function gd(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()&&(t=Math.round(t)),i=>+e(i)+t}function _d(){return!this.__axis}function vd(e,t){var i=[],n=null,r=null,o=6,s=6,a=3,u=typeof window<"u"&&window.devicePixelRatio>1?0:.5,c=e===Lo||e===Oi?-1:1,l=e===Oi||e===Ro?"x":"y",d=e===Lo||e===Ia?fd:pd;function h(f){var p=n??(t.ticks?t.ticks.apply(t,i):t.domain()),_=r??(t.tickFormat?t.tickFormat.apply(t,i):Ta),x=Math.max(o,0)+a,C=t.range(),P=+C[0]+u,S=+C[C.length-1]+u,A=(t.bandwidth?gd:md)(t.copy(),u),O=f.selection?f.selection():f,M=O.selectAll(".domain").data([null]),L=O.selectAll(".tick").data(p,t).order(),R=L.exit(),F=L.enter().append("g").attr("class","tick"),B=L.select("line"),b=L.select("text");M=M.merge(M.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),L=L.merge(F),B=B.merge(F.append("line").attr("stroke","currentColor").attr(l+"2",c*o)),b=b.merge(F.append("text").attr("fill","currentColor").attr(l,c*x).attr("dy",e===Lo?"0em":e===Ia?"0.71em":"0.32em")),f!==O&&(M=M.transition(f),L=L.transition(f),B=B.transition(f),b=b.transition(f),R=R.transition(f).attr("opacity",Va).attr("transform",function(G){return isFinite(G=A(G))?d(G+u):this.getAttribute("transform")}),F.attr("opacity",Va).attr("transform",function(G){var E=this.parentNode.__axis;return d((E&&isFinite(E=E(G))?E:A(G))+u)})),R.remove(),M.attr("d",e===Oi||e===Ro?s?"M"+c*s+","+P+"H"+u+"V"+S+"H"+c*s:"M"+u+","+P+"V"+S:s?"M"+P+","+c*s+"V"+u+"H"+S+"V"+c*s:"M"+P+","+u+"H"+S),L.attr("opacity",1).attr("transform",function(G){return d(A(G)+u)}),B.attr(l+"2",c*o),b.attr(l,c*x).text(_),O.filter(_d).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===Ro?"start":e===Oi?"end":"middle"),O.each(function(){this.__axis=A})}return h.scale=function(f){return arguments.length?(t=f,h):t},h.ticks=function(){return i=Array.from(arguments),h},h.tickArguments=function(f){return arguments.length?(i=f==null?[]:Array.from(f),h):i.slice()},h.tickValues=function(f){return arguments.length?(n=f==null?null:Array.from(f),h):n&&n.slice()},h.tickFormat=function(f){return arguments.length?(r=f,h):r},h.tickSize=function(f){return arguments.length?(o=s=+f,h):o},h.tickSizeInner=function(f){return arguments.length?(o=+f,h):o},h.tickSizeOuter=function(f){return arguments.length?(s=+f,h):s},h.tickPadding=function(f){return arguments.length?(a=+f,h):a},h.offset=function(f){return arguments.length?(u=+f,h):u},h}function Ni(e){return vd(Oi,e)}var yd={value:()=>{}};function Ga(){for(var e=0,t=arguments.length,i={},n;e<t;++e){if(!(n=arguments[e]+"")||n in i||/[\s.]/.test(n))throw new Error("illegal type: "+n);i[n]=[]}return new Bn(i)}function Bn(e){this._=e}function xd(e,t){return e.trim().split(/^|\s+/).map(function(i){var n="",r=i.indexOf(".");if(r>=0&&(n=i.slice(r+1),i=i.slice(0,r)),i&&!t.hasOwnProperty(i))throw new Error("unknown type: "+i);return{type:i,name:n}})}Bn.prototype=Ga.prototype={constructor:Bn,on:function(e,t){var i=this._,n=xd(e+"",i),r,o=-1,s=n.length;if(arguments.length<2){for(;++o<s;)if((r=(e=n[o]).type)&&(r=bd(i[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++o<s;)if(r=(e=n[o]).type)i[r]=Ba(i[r],e.name,t);else if(t==null)for(r in i)i[r]=Ba(i[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var i in t)e[i]=t[i].slice();return new Bn(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var i=new Array(r),n=0,r,o;n<r;++n)i[n]=arguments[n+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],n=0,r=o.length;n<r;++n)o[n].value.apply(t,i)},apply:function(e,t,i){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],r=0,o=n.length;r<o;++r)n[r].value.apply(t,i)}};function bd(e,t){for(var i=0,n=e.length,r;i<n;++i)if((r=e[i]).name===t)return r.value}function Ba(e,t,i){for(var n=0,r=e.length;n<r;++n)if(e[n].name===t){e[n]=yd,e=e.slice(0,n).concat(e.slice(n+1));break}return i!=null&&e.push({name:t,value:i}),e}var Fo=Ga;var Gn="http://www.w3.org/1999/xhtml",To={svg:"http://www.w3.org/2000/svg",xhtml:Gn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function se(e){var t=e+="",i=t.indexOf(":");return i>=0&&(t=e.slice(0,i))!=="xmlns"&&(e=e.slice(i+1)),To.hasOwnProperty(t)?{space:To[t],local:e}:e}function wd(e){return function(){var t=this.ownerDocument,i=this.namespaceURI;return i===Gn&&t.documentElement.namespaceURI===Gn?t.createElement(e):t.createElementNS(i,e)}}function Ed(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Hn(e){var t=se(e);return(t.local?Ed:wd)(t)}function Cd(){}function Te(e){return e==null?Cd:function(){return this.querySelector(e)}}function Ha(e){typeof e!="function"&&(e=Te(e));for(var t=this._groups,i=t.length,n=new Array(i),r=0;r<i;++r)for(var o=t[r],s=o.length,a=n[r]=new Array(s),u,c,l=0;l<s;++l)(u=o[l])&&(c=e.call(u,u.__data__,l,o))&&("__data__"in u&&(c.__data__=u.__data__),a[l]=c);return new st(n,this._parents)}function Io(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Ad(){return[]}function ki(e){return e==null?Ad:function(){return this.querySelectorAll(e)}}function Pd(e){return function(){return Io(e.apply(this,arguments))}}function za(e){typeof e=="function"?e=Pd(e):e=ki(e);for(var t=this._groups,i=t.length,n=[],r=[],o=0;o<i;++o)for(var s=t[o],a=s.length,u,c=0;c<a;++c)(u=s[c])&&(n.push(e.call(u,u.__data__,c,s)),r.push(u));return new st(n,r)}function Mi(e){return function(){return this.matches(e)}}function zn(e){return function(t){return t.matches(e)}}var Sd=Array.prototype.find;function Od(e){return function(){return Sd.call(this.children,e)}}function Nd(){return this.firstElementChild}function Da(e){return this.select(e==null?Nd:Od(typeof e=="function"?e:zn(e)))}var kd=Array.prototype.filter;function Md(){return Array.from(this.children)}function Ld(e){return function(){return kd.call(this.children,e)}}function $a(e){return this.selectAll(e==null?Md:Ld(typeof e=="function"?e:zn(e)))}function Ya(e){typeof e!="function"&&(e=Mi(e));for(var t=this._groups,i=t.length,n=new Array(i),r=0;r<i;++r)for(var o=t[r],s=o.length,a=n[r]=[],u,c=0;c<s;++c)(u=o[c])&&e.call(u,u.__data__,c,o)&&a.push(u);return new st(n,this._parents)}function Dn(e){return new Array(e.length)}function Ua(){return new st(this._enter||this._groups.map(Dn),this._parents)}function Li(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Li.prototype={constructor:Li,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function ja(e){return function(){return e}}function Rd(e,t,i,n,r,o){for(var s=0,a,u=t.length,c=o.length;s<c;++s)(a=t[s])?(a.__data__=o[s],n[s]=a):i[s]=new Li(e,o[s]);for(;s<u;++s)(a=t[s])&&(r[s]=a)}function Fd(e,t,i,n,r,o,s){var a,u,c=new Map,l=t.length,d=o.length,h=new Array(l),f;for(a=0;a<l;++a)(u=t[a])&&(h[a]=f=s.call(u,u.__data__,a,t)+"",c.has(f)?r[a]=u:c.set(f,u));for(a=0;a<d;++a)f=s.call(e,o[a],a,o)+"",(u=c.get(f))?(n[a]=u,u.__data__=o[a],c.delete(f)):i[a]=new Li(e,o[a]);for(a=0;a<l;++a)(u=t[a])&&c.get(h[a])===u&&(r[a]=u)}function Td(e){return e.__data__}function Wa(e,t){if(!arguments.length)return Array.from(this,Td);var i=t?Fd:Rd,n=this._parents,r=this._groups;typeof e!="function"&&(e=ja(e));for(var o=r.length,s=new Array(o),a=new Array(o),u=new Array(o),c=0;c<o;++c){var l=n[c],d=r[c],h=d.length,f=Id(e.call(l,l&&l.__data__,c,n)),p=f.length,_=a[c]=new Array(p),x=s[c]=new Array(p),C=u[c]=new Array(h);i(l,d,_,x,C,f,t);for(var P=0,S=0,A,O;P<p;++P)if(A=_[P]){for(P>=S&&(S=P+1);!(O=x[S])&&++S<p;);A._next=O||null}}return s=new st(s,n),s._enter=a,s._exit=u,s}function Id(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Xa(){return new st(this._exit||this._groups.map(Dn),this._parents)}function qa(e,t,i){var n=this.enter(),r=this,o=this.exit();return typeof e=="function"?(n=e(n),n&&(n=n.selection())):n=n.append(e+""),t!=null&&(r=t(r),r&&(r=r.selection())),i==null?o.remove():i(o),n&&r?n.merge(r).order():r}function Ka(e){for(var t=e.selection?e.selection():e,i=this._groups,n=t._groups,r=i.length,o=n.length,s=Math.min(r,o),a=new Array(r),u=0;u<s;++u)for(var c=i[u],l=n[u],d=c.length,h=a[u]=new Array(d),f,p=0;p<d;++p)(f=c[p]||l[p])&&(h[p]=f);for(;u<r;++u)a[u]=i[u];return new st(a,this._parents)}function Za(){for(var e=this._groups,t=-1,i=e.length;++t<i;)for(var n=e[t],r=n.length-1,o=n[r],s;--r>=0;)(s=n[r])&&(o&&s.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(s,o),o=s);return this}function Ja(e){e||(e=Vd);function t(d,h){return d&&h?e(d.__data__,h.__data__):!d-!h}for(var i=this._groups,n=i.length,r=new Array(n),o=0;o<n;++o){for(var s=i[o],a=s.length,u=r[o]=new Array(a),c,l=0;l<a;++l)(c=s[l])&&(u[l]=c);u.sort(t)}return new st(r,this._parents).order()}function Vd(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Qa(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function tl(){return Array.from(this)}function el(){for(var e=this._groups,t=0,i=e.length;t<i;++t)for(var n=e[t],r=0,o=n.length;r<o;++r){var s=n[r];if(s)return s}return null}function il(){let e=0;for(let t of this)++e;return e}function nl(){return!this.node()}function rl(e){for(var t=this._groups,i=0,n=t.length;i<n;++i)for(var r=t[i],o=0,s=r.length,a;o<s;++o)(a=r[o])&&e.call(a,a.__data__,o,r);return this}function Bd(e){return function(){this.removeAttribute(e)}}function Gd(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Hd(e,t){return function(){this.setAttribute(e,t)}}function zd(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Dd(e,t){return function(){var i=t.apply(this,arguments);i==null?this.removeAttribute(e):this.setAttribute(e,i)}}function $d(e,t){return function(){var i=t.apply(this,arguments);i==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,i)}}function ol(e,t){var i=se(e);if(arguments.length<2){var n=this.node();return i.local?n.getAttributeNS(i.space,i.local):n.getAttribute(i)}return this.each((t==null?i.local?Gd:Bd:typeof t=="function"?i.local?$d:Dd:i.local?zd:Hd)(i,t))}function $n(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Yd(e){return function(){this.style.removeProperty(e)}}function Ud(e,t,i){return function(){this.style.setProperty(e,t,i)}}function jd(e,t,i){return function(){var n=t.apply(this,arguments);n==null?this.style.removeProperty(e):this.style.setProperty(e,n,i)}}function sl(e,t,i){return arguments.length>1?this.each((t==null?Yd:typeof t=="function"?jd:Ud)(e,t,i??"")):ve(this.node(),e)}function ve(e,t){return e.style.getPropertyValue(t)||$n(e).getComputedStyle(e,null).getPropertyValue(t)}function Wd(e){return function(){delete this[e]}}function Xd(e,t){return function(){this[e]=t}}function qd(e,t){return function(){var i=t.apply(this,arguments);i==null?delete this[e]:this[e]=i}}function al(e,t){return arguments.length>1?this.each((t==null?Wd:typeof t=="function"?qd:Xd)(e,t)):this.node()[e]}function ll(e){return e.trim().split(/^|\s+/)}function Vo(e){return e.classList||new cl(e)}function cl(e){this._node=e,this._names=ll(e.getAttribute("class")||"")}cl.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function ul(e,t){for(var i=Vo(e),n=-1,r=t.length;++n<r;)i.add(t[n])}function dl(e,t){for(var i=Vo(e),n=-1,r=t.length;++n<r;)i.remove(t[n])}function Kd(e){return function(){ul(this,e)}}function Zd(e){return function(){dl(this,e)}}function Jd(e,t){return function(){(t.apply(this,arguments)?ul:dl)(this,e)}}function hl(e,t){var i=ll(e+"");if(arguments.length<2){for(var n=Vo(this.node()),r=-1,o=i.length;++r<o;)if(!n.contains(i[r]))return!1;return!0}return this.each((typeof t=="function"?Jd:t?Kd:Zd)(i,t))}function Qd(){this.textContent=""}function th(e){return function(){this.textContent=e}}function eh(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function fl(e){return arguments.length?this.each(e==null?Qd:(typeof e=="function"?eh:th)(e)):this.node().textContent}function ih(){this.innerHTML=""}function nh(e){return function(){this.innerHTML=e}}function rh(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function pl(e){return arguments.length?this.each(e==null?ih:(typeof e=="function"?rh:nh)(e)):this.node().innerHTML}function oh(){this.nextSibling&&this.parentNode.appendChild(this)}function ml(){return this.each(oh)}function sh(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function gl(){return this.each(sh)}function _l(e){var t=typeof e=="function"?e:Hn(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function ah(){return null}function vl(e,t){var i=typeof e=="function"?e:Hn(e),n=t==null?ah:typeof t=="function"?t:Te(t);return this.select(function(){return this.insertBefore(i.apply(this,arguments),n.apply(this,arguments)||null)})}function lh(){var e=this.parentNode;e&&e.removeChild(this)}function yl(){return this.each(lh)}function ch(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function uh(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function xl(e){return this.select(e?uh:ch)}function bl(e){return arguments.length?this.property("__data__",e):this.node().__data__}function dh(e){return function(t){e.call(this,t,this.__data__)}}function hh(e){return e.trim().split(/^|\s+/).map(function(t){var i="",n=t.indexOf(".");return n>=0&&(i=t.slice(n+1),t=t.slice(0,n)),{type:t,name:i}})}function fh(e){return function(){var t=this.__on;if(t){for(var i=0,n=-1,r=t.length,o;i<r;++i)o=t[i],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++n]=o;++n?t.length=n:delete this.__on}}}function ph(e,t,i){return function(){var n=this.__on,r,o=dh(t);if(n){for(var s=0,a=n.length;s<a;++s)if((r=n[s]).type===e.type&&r.name===e.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=i),r.value=t;return}}this.addEventListener(e.type,o,i),r={type:e.type,name:e.name,value:t,listener:o,options:i},n?n.push(r):this.__on=[r]}}function wl(e,t,i){var n=hh(e+""),r,o=n.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var u=0,c=a.length,l;u<c;++u)for(r=0,l=a[u];r<o;++r)if((s=n[r]).type===l.type&&s.name===l.name)return l.value}return}for(a=t?ph:fh,r=0;r<o;++r)this.each(a(n[r],t,i));return this}function El(e,t,i){var n=$n(e),r=n.CustomEvent;typeof r=="function"?r=new r(t,i):(r=n.document.createEvent("Event"),i?(r.initEvent(t,i.bubbles,i.cancelable),r.detail=i.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function mh(e,t){return function(){return El(this,e,t)}}function gh(e,t){return function(){return El(this,e,t.apply(this,arguments))}}function Cl(e,t){return this.each((typeof t=="function"?gh:mh)(e,t))}function*Al(){for(var e=this._groups,t=0,i=e.length;t<i;++t)for(var n=e[t],r=0,o=n.length,s;r<o;++r)(s=n[r])&&(yield s)}var Bo=[null];function st(e,t){this._groups=e,this._parents=t}function Pl(){return new st([[document.documentElement]],Bo)}function _h(){return this}st.prototype=Pl.prototype={constructor:st,select:Ha,selectAll:za,selectChild:Da,selectChildren:$a,filter:Ya,data:Wa,enter:Ua,exit:Xa,join:qa,merge:Ka,selection:_h,order:Za,sort:Ja,call:Qa,nodes:tl,node:el,size:il,empty:nl,each:rl,attr:ol,style:sl,property:al,classed:hl,text:fl,html:pl,raise:ml,lower:gl,append:_l,insert:vl,remove:yl,clone:xl,datum:bl,on:wl,dispatch:Cl,[Symbol.iterator]:Al};var ae=Pl;function le(e){return typeof e=="string"?new st([[document.querySelector(e)]],[document.documentElement]):new st([[e]],Bo)}function Yn(e,t,i){e.prototype=t.prototype=i,i.constructor=e}function Go(e,t){var i=Object.create(e.prototype);for(var n in t)i[n]=t[n];return i}function Ti(){}var Ri=.7,Wn=1/Ri,si="\\s*([+-]?\\d+)\\s*",Fi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Jt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",vh=/^#([0-9a-f]{3,8})$/,yh=new RegExp(`^rgb\\(${si},${si},${si}\\)$`),xh=new RegExp(`^rgb\\(${Jt},${Jt},${Jt}\\)$`),bh=new RegExp(`^rgba\\(${si},${si},${si},${Fi}\\)$`),wh=new RegExp(`^rgba\\(${Jt},${Jt},${Jt},${Fi}\\)$`),Eh=new RegExp(`^hsl\\(${Fi},${Jt},${Jt}\\)$`),Ch=new RegExp(`^hsla\\(${Fi},${Jt},${Jt},${Fi}\\)$`),Sl={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Yn(Ti,Wt,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Ol,formatHex:Ol,formatHex8:Ah,formatHsl:Ph,formatRgb:Nl,toString:Nl});function Ol(){return this.rgb().formatHex()}function Ah(){return this.rgb().formatHex8()}function Ph(){return Tl(this).formatHsl()}function Nl(){return this.rgb().formatRgb()}function Wt(e){var t,i;return e=(e+"").trim().toLowerCase(),(t=vh.exec(e))?(i=t[1].length,t=parseInt(t[1],16),i===6?kl(t):i===3?new Vt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):i===8?Un(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):i===4?Un(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=yh.exec(e))?new Vt(t[1],t[2],t[3],1):(t=xh.exec(e))?new Vt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=bh.exec(e))?Un(t[1],t[2],t[3],t[4]):(t=wh.exec(e))?Un(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Eh.exec(e))?Rl(t[1],t[2]/100,t[3]/100,1):(t=Ch.exec(e))?Rl(t[1],t[2]/100,t[3]/100,t[4]):Sl.hasOwnProperty(e)?kl(Sl[e]):e==="transparent"?new Vt(NaN,NaN,NaN,0):null}function kl(e){return new Vt(e>>16&255,e>>8&255,e&255,1)}function Un(e,t,i,n){return n<=0&&(e=t=i=NaN),new Vt(e,t,i,n)}function Sh(e){return e instanceof Ti||(e=Wt(e)),e?(e=e.rgb(),new Vt(e.r,e.g,e.b,e.opacity)):new Vt}function ai(e,t,i,n){return arguments.length===1?Sh(e):new Vt(e,t,i,n??1)}function Vt(e,t,i,n){this.r=+e,this.g=+t,this.b=+i,this.opacity=+n}Yn(Vt,ai,Go(Ti,{brighter(e){return e=e==null?Wn:Math.pow(Wn,e),new Vt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Ri:Math.pow(Ri,e),new Vt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Vt(Ve(this.r),Ve(this.g),Ve(this.b),Xn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ml,formatHex:Ml,formatHex8:Oh,formatRgb:Ll,toString:Ll}));function Ml(){return`#${Ie(this.r)}${Ie(this.g)}${Ie(this.b)}`}function Oh(){return`#${Ie(this.r)}${Ie(this.g)}${Ie(this.b)}${Ie((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ll(){let e=Xn(this.opacity);return`${e===1?"rgb(":"rgba("}${Ve(this.r)}, ${Ve(this.g)}, ${Ve(this.b)}${e===1?")":`, ${e})`}`}function Xn(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ve(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ie(e){return e=Ve(e),(e<16?"0":"")+e.toString(16)}function Rl(e,t,i,n){return n<=0?e=t=i=NaN:i<=0||i>=1?e=t=NaN:t<=0&&(e=NaN),new jt(e,t,i,n)}function Tl(e){if(e instanceof jt)return new jt(e.h,e.s,e.l,e.opacity);if(e instanceof Ti||(e=Wt(e)),!e)return new jt;if(e instanceof jt)return e;e=e.rgb();var t=e.r/255,i=e.g/255,n=e.b/255,r=Math.min(t,i,n),o=Math.max(t,i,n),s=NaN,a=o-r,u=(o+r)/2;return a?(t===o?s=(i-n)/a+(i<n)*6:i===o?s=(n-t)/a+2:s=(t-i)/a+4,a/=u<.5?o+r:2-o-r,s*=60):a=u>0&&u<1?0:s,new jt(s,a,u,e.opacity)}function Il(e,t,i,n){return arguments.length===1?Tl(e):new jt(e,t,i,n??1)}function jt(e,t,i,n){this.h=+e,this.s=+t,this.l=+i,this.opacity=+n}Yn(jt,Il,Go(Ti,{brighter(e){return e=e==null?Wn:Math.pow(Wn,e),new jt(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ri:Math.pow(Ri,e),new jt(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,i=this.l,n=i+(i<.5?i:1-i)*t,r=2*i-n;return new Vt(Ho(e>=240?e-240:e+120,r,n),Ho(e,r,n),Ho(e<120?e+240:e-120,r,n),this.opacity)},clamp(){return new jt(Fl(this.h),jn(this.s),jn(this.l),Xn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=Xn(this.opacity);return`${e===1?"hsl(":"hsla("}${Fl(this.h)}, ${jn(this.s)*100}%, ${jn(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Fl(e){return e=(e||0)%360,e<0?e+360:e}function jn(e){return Math.max(0,Math.min(1,e||0))}function Ho(e,t,i){return(e<60?t+(i-t)*e/60:e<180?i:e<240?t+(i-t)*(240-e)/60:t)*255}function zo(e,t,i,n,r){var o=e*e,s=o*e;return((1-3*e+3*o-s)*t+(4-6*o+3*s)*i+(1+3*e+3*o-3*s)*n+s*r)/6}function Vl(e){var t=e.length-1;return function(i){var n=i<=0?i=0:i>=1?(i=1,t-1):Math.floor(i*t),r=e[n],o=e[n+1],s=n>0?e[n-1]:2*r-o,a=n<t-1?e[n+2]:2*o-r;return zo((i-n/t)*t,s,r,o,a)}}function Bl(e){var t=e.length;return function(i){var n=Math.floor(((i%=1)<0?++i:i)*t),r=e[(n+t-1)%t],o=e[n%t],s=e[(n+1)%t],a=e[(n+2)%t];return zo((i-n/t)*t,r,o,s,a)}}var Ii=e=>()=>e;function Nh(e,t){return function(i){return e+i*t}}function kh(e,t,i){return e=Math.pow(e,i),t=Math.pow(t,i)-e,i=1/i,function(n){return Math.pow(e+n*t,i)}}function Gl(e){return(e=+e)==1?qn:function(t,i){return i-t?kh(t,i,e):Ii(isNaN(t)?i:t)}}function qn(e,t){var i=t-e;return i?Nh(e,i):Ii(isNaN(e)?t:e)}var Be=function e(t){var i=Gl(t);function n(r,o){var s=i((r=ai(r)).r,(o=ai(o)).r),a=i(r.g,o.g),u=i(r.b,o.b),c=qn(r.opacity,o.opacity);return function(l){return r.r=s(l),r.g=a(l),r.b=u(l),r.opacity=c(l),r+""}}return n.gamma=e,n}(1);function Hl(e){return function(t){var i=t.length,n=new Array(i),r=new Array(i),o=new Array(i),s,a;for(s=0;s<i;++s)a=ai(t[s]),n[s]=a.r||0,r[s]=a.g||0,o[s]=a.b||0;return n=e(n),r=e(r),o=e(o),a.opacity=1,function(u){return a.r=n(u),a.g=r(u),a.b=o(u),a+""}}}var Mh=Hl(Vl),Lh=Hl(Bl);function zl(e,t){t||(t=[]);var i=e?Math.min(t.length,e.length):0,n=t.slice(),r;return function(o){for(r=0;r<i;++r)n[r]=e[r]*(1-o)+t[r]*o;return n}}function Dl(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function $l(e,t){var i=t?t.length:0,n=e?Math.min(i,e.length):0,r=new Array(n),o=new Array(i),s;for(s=0;s<n;++s)r[s]=ce(e[s],t[s]);for(;s<i;++s)o[s]=t[s];return function(a){for(s=0;s<n;++s)o[s]=r[s](a);return o}}function Yl(e,t){var i=new Date;return e=+e,t=+t,function(n){return i.setTime(e*(1-n)+t*n),i}}function wt(e,t){return e=+e,t=+t,function(i){return e*(1-i)+t*i}}function Ul(e,t){var i={},n={},r;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in e?i[r]=ce(e[r],t[r]):n[r]=t[r];return function(o){for(r in i)n[r]=i[r](o);return n}}var $o=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Do=new RegExp($o.source,"g");function Rh(e){return function(){return e}}function Fh(e){return function(t){return e(t)+""}}function Vi(e,t){var i=$o.lastIndex=Do.lastIndex=0,n,r,o,s=-1,a=[],u=[];for(e=e+"",t=t+"";(n=$o.exec(e))&&(r=Do.exec(t));)(o=r.index)>i&&(o=t.slice(i,o),a[s]?a[s]+=o:a[++s]=o),(n=n[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,u.push({i:s,x:wt(n,r)})),i=Do.lastIndex;return i<t.length&&(o=t.slice(i),a[s]?a[s]+=o:a[++s]=o),a.length<2?u[0]?Fh(u[0].x):Rh(t):(t=u.length,function(c){for(var l=0,d;l<t;++l)a[(d=u[l]).i]=d.x(c);return a.join("")})}function ce(e,t){var i=typeof t,n;return t==null||i==="boolean"?Ii(t):(i==="number"?wt:i==="string"?(n=Wt(t))?(t=n,Be):Vi:t instanceof Wt?Be:t instanceof Date?Yl:Dl(t)?zl:Array.isArray(t)?$l:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Ul:wt)(e,t)}function Yo(e,t){return e=+e,t=+t,function(i){return Math.round(e*(1-i)+t*i)}}var jl=180/Math.PI,Kn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Uo(e,t,i,n,r,o){var s,a,u;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(u=e*i+t*n)&&(i-=e*u,n-=t*u),(a=Math.sqrt(i*i+n*n))&&(i/=a,n/=a,u/=a),e*n<t*i&&(e=-e,t=-t,u=-u,s=-s),{translateX:r,translateY:o,rotate:Math.atan2(t,e)*jl,skewX:Math.atan(u)*jl,scaleX:s,scaleY:a}}var Zn;function Wl(e){let t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Kn:Uo(t.a,t.b,t.c,t.d,t.e,t.f)}function Xl(e){return e==null?Kn:(Zn||(Zn=document.createElementNS("http://www.w3.org/2000/svg","g")),Zn.setAttribute("transform",e),(e=Zn.transform.baseVal.consolidate())?(e=e.matrix,Uo(e.a,e.b,e.c,e.d,e.e,e.f)):Kn)}function ql(e,t,i,n){function r(c){return c.length?c.pop()+" ":""}function o(c,l,d,h,f,p){if(c!==d||l!==h){var _=f.push("translate(",null,t,null,i);p.push({i:_-4,x:wt(c,d)},{i:_-2,x:wt(l,h)})}else(d||h)&&f.push("translate("+d+t+h+i)}function s(c,l,d,h){c!==l?(c-l>180?l+=360:l-c>180&&(c+=360),h.push({i:d.push(r(d)+"rotate(",null,n)-2,x:wt(c,l)})):l&&d.push(r(d)+"rotate("+l+n)}function a(c,l,d,h){c!==l?h.push({i:d.push(r(d)+"skewX(",null,n)-2,x:wt(c,l)}):l&&d.push(r(d)+"skewX("+l+n)}function u(c,l,d,h,f,p){if(c!==d||l!==h){var _=f.push(r(f)+"scale(",null,",",null,")");p.push({i:_-4,x:wt(c,d)},{i:_-2,x:wt(l,h)})}else(d!==1||h!==1)&&f.push(r(f)+"scale("+d+","+h+")")}return function(c,l){var d=[],h=[];return c=e(c),l=e(l),o(c.translateX,c.translateY,l.translateX,l.translateY,d,h),s(c.rotate,l.rotate,d,h),a(c.skewX,l.skewX,d,h),u(c.scaleX,c.scaleY,l.scaleX,l.scaleY,d,h),c=l=null,function(f){for(var p=-1,_=h.length,x;++p<_;)d[(x=h[p]).i]=x.x(f);return d.join("")}}}var jo=ql(Wl,"px, ","px)","deg)"),Wo=ql(Xl,", ",")",")");var li=0,Gi=0,Bi=0,Zl=1e3,Jn,Hi,Qn=0,Ge=0,tr=0,zi=typeof performance=="object"&&performance.now?performance:Date,Jl=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function $i(){return Ge||(Jl(Th),Ge=zi.now()+tr)}function Th(){Ge=0}function Di(){this._call=this._time=this._next=null}Di.prototype=er.prototype={constructor:Di,restart:function(e,t,i){if(typeof e!="function")throw new TypeError("callback is not a function");i=(i==null?$i():+i)+(t==null?0:+t),!this._next&&Hi!==this&&(Hi?Hi._next=this:Jn=this,Hi=this),this._call=e,this._time=i,Xo()},stop:function(){this._call&&(this._call=null,this._time=1/0,Xo())}};function er(e,t,i){var n=new Di;return n.restart(e,t,i),n}function Ql(){$i(),++li;for(var e=Jn,t;e;)(t=Ge-e._time)>=0&&e._call.call(void 0,t),e=e._next;--li}function Kl(){Ge=(Qn=zi.now())+tr,li=Gi=0;try{Ql()}finally{li=0,Vh(),Ge=0}}function Ih(){var e=zi.now(),t=e-Qn;t>Zl&&(tr-=t,Qn=e)}function Vh(){for(var e,t=Jn,i,n=1/0;t;)t._call?(n>t._time&&(n=t._time),e=t,t=t._next):(i=t._next,t._next=null,t=e?e._next=i:Jn=i);Hi=e,Xo(n)}function Xo(e){if(!li){Gi&&(Gi=clearTimeout(Gi));var t=e-Ge;t>24?(e<1/0&&(Gi=setTimeout(Kl,e-zi.now()-tr)),Bi&&(Bi=clearInterval(Bi))):(Bi||(Qn=zi.now(),Bi=setInterval(Ih,Zl)),li=1,Jl(Kl))}}function ir(e,t,i){var n=new Di;return t=t==null?0:+t,n.restart(r=>{n.stop(),e(r+t)},t,i),n}var Bh=Fo("start","end","cancel","interrupt"),Gh=[],ic=0,tc=1,rr=2,nr=3,ec=4,or=5,Yi=6;function ye(e,t,i,n,r,o){var s=e.__transition;if(!s)e.__transition={};else if(i in s)return;Hh(e,i,{name:t,index:n,group:r,on:Bh,tween:Gh,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:ic})}function Ui(e,t){var i=dt(e,t);if(i.state>ic)throw new Error("too late; already scheduled");return i}function Et(e,t){var i=dt(e,t);if(i.state>nr)throw new Error("too late; already running");return i}function dt(e,t){var i=e.__transition;if(!i||!(i=i[t]))throw new Error("transition not found");return i}function Hh(e,t,i){var n=e.__transition,r;n[t]=i,i.timer=er(o,0,i.time);function o(c){i.state=tc,i.timer.restart(s,i.delay,i.time),i.delay<=c&&s(c-i.delay)}function s(c){var l,d,h,f;if(i.state!==tc)return u();for(l in n)if(f=n[l],f.name===i.name){if(f.state===nr)return ir(s);f.state===ec?(f.state=Yi,f.timer.stop(),f.on.call("interrupt",e,e.__data__,f.index,f.group),delete n[l]):+l<t&&(f.state=Yi,f.timer.stop(),f.on.call("cancel",e,e.__data__,f.index,f.group),delete n[l])}if(ir(function(){i.state===nr&&(i.state=ec,i.timer.restart(a,i.delay,i.time),a(c))}),i.state=rr,i.on.call("start",e,e.__data__,i.index,i.group),i.state===rr){for(i.state=nr,r=new Array(h=i.tween.length),l=0,d=-1;l<h;++l)(f=i.tween[l].value.call(e,e.__data__,i.index,i.group))&&(r[++d]=f);r.length=d+1}}function a(c){for(var l=c<i.duration?i.ease.call(null,c/i.duration):(i.timer.restart(u),i.state=or,1),d=-1,h=r.length;++d<h;)r[d].call(e,l);i.state===or&&(i.on.call("end",e,e.__data__,i.index,i.group),u())}function u(){i.state=Yi,i.timer.stop(),delete n[t];for(var c in n)return;delete e.__transition}}function sr(e,t){var i=e.__transition,n,r,o=!0,s;if(i){t=t==null?null:t+"";for(s in i){if((n=i[s]).name!==t){o=!1;continue}r=n.state>rr&&n.state<or,n.state=Yi,n.timer.stop(),n.on.call(r?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete i[s]}o&&delete e.__transition}}function nc(e){return this.each(function(){sr(this,e)})}function zh(e,t){var i,n;return function(){var r=Et(this,e),o=r.tween;if(o!==i){n=i=o;for(var s=0,a=n.length;s<a;++s)if(n[s].name===t){n=n.slice(),n.splice(s,1);break}}r.tween=n}}function Dh(e,t,i){var n,r;if(typeof i!="function")throw new Error;return function(){var o=Et(this,e),s=o.tween;if(s!==n){r=(n=s).slice();for(var a={name:t,value:i},u=0,c=r.length;u<c;++u)if(r[u].name===t){r[u]=a;break}u===c&&r.push(a)}o.tween=r}}function rc(e,t){var i=this._id;if(e+="",arguments.length<2){for(var n=dt(this.node(),i).tween,r=0,o=n.length,s;r<o;++r)if((s=n[r]).name===e)return s.value;return null}return this.each((t==null?zh:Dh)(i,e,t))}function ci(e,t,i){var n=e._id;return e.each(function(){var r=Et(this,n);(r.value||(r.value={}))[t]=i.apply(this,arguments)}),function(r){return dt(r,n).value[t]}}function ar(e,t){var i;return(typeof t=="number"?wt:t instanceof Wt?Be:(i=Wt(t))?(t=i,Be):Vi)(e,t)}function $h(e){return function(){this.removeAttribute(e)}}function Yh(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Uh(e,t,i){var n,r=i+"",o;return function(){var s=this.getAttribute(e);return s===r?null:s===n?o:o=t(n=s,i)}}function jh(e,t,i){var n,r=i+"",o;return function(){var s=this.getAttributeNS(e.space,e.local);return s===r?null:s===n?o:o=t(n=s,i)}}function Wh(e,t,i){var n,r,o;return function(){var s,a=i(this),u;return a==null?void this.removeAttribute(e):(s=this.getAttribute(e),u=a+"",s===u?null:s===n&&u===r?o:(r=u,o=t(n=s,a)))}}function Xh(e,t,i){var n,r,o;return function(){var s,a=i(this),u;return a==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),u=a+"",s===u?null:s===n&&u===r?o:(r=u,o=t(n=s,a)))}}function oc(e,t){var i=se(e),n=i==="transform"?Wo:ar;return this.attrTween(e,typeof t=="function"?(i.local?Xh:Wh)(i,n,ci(this,"attr."+e,t)):t==null?(i.local?Yh:$h)(i):(i.local?jh:Uh)(i,n,t))}function qh(e,t){return function(i){this.setAttribute(e,t.call(this,i))}}function Kh(e,t){return function(i){this.setAttributeNS(e.space,e.local,t.call(this,i))}}function Zh(e,t){var i,n;function r(){var o=t.apply(this,arguments);return o!==n&&(i=(n=o)&&Kh(e,o)),i}return r._value=t,r}function Jh(e,t){var i,n;function r(){var o=t.apply(this,arguments);return o!==n&&(i=(n=o)&&qh(e,o)),i}return r._value=t,r}function sc(e,t){var i="attr."+e;if(arguments.length<2)return(i=this.tween(i))&&i._value;if(t==null)return this.tween(i,null);if(typeof t!="function")throw new Error;var n=se(e);return this.tween(i,(n.local?Zh:Jh)(n,t))}function Qh(e,t){return function(){Ui(this,e).delay=+t.apply(this,arguments)}}function tf(e,t){return t=+t,function(){Ui(this,e).delay=t}}function ac(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Qh:tf)(t,e)):dt(this.node(),t).delay}function ef(e,t){return function(){Et(this,e).duration=+t.apply(this,arguments)}}function nf(e,t){return t=+t,function(){Et(this,e).duration=t}}function lc(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?ef:nf)(t,e)):dt(this.node(),t).duration}function rf(e,t){if(typeof t!="function")throw new Error;return function(){Et(this,e).ease=t}}function cc(e){var t=this._id;return arguments.length?this.each(rf(t,e)):dt(this.node(),t).ease}function of(e,t){return function(){var i=t.apply(this,arguments);if(typeof i!="function")throw new Error;Et(this,e).ease=i}}function uc(e){if(typeof e!="function")throw new Error;return this.each(of(this._id,e))}function dc(e){typeof e!="function"&&(e=Mi(e));for(var t=this._groups,i=t.length,n=new Array(i),r=0;r<i;++r)for(var o=t[r],s=o.length,a=n[r]=[],u,c=0;c<s;++c)(u=o[c])&&e.call(u,u.__data__,c,o)&&a.push(u);return new Lt(n,this._parents,this._name,this._id)}function hc(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,i=e._groups,n=t.length,r=i.length,o=Math.min(n,r),s=new Array(n),a=0;a<o;++a)for(var u=t[a],c=i[a],l=u.length,d=s[a]=new Array(l),h,f=0;f<l;++f)(h=u[f]||c[f])&&(d[f]=h);for(;a<n;++a)s[a]=t[a];return new Lt(s,this._parents,this._name,this._id)}function sf(e){return(e+"").trim().split(/^|\s+/).every(function(t){var i=t.indexOf(".");return i>=0&&(t=t.slice(0,i)),!t||t==="start"})}function af(e,t,i){var n,r,o=sf(t)?Ui:Et;return function(){var s=o(this,e),a=s.on;a!==n&&(r=(n=a).copy()).on(t,i),s.on=r}}function fc(e,t){var i=this._id;return arguments.length<2?dt(this.node(),i).on.on(e):this.each(af(i,e,t))}function lf(e){return function(){var t=this.parentNode;for(var i in this.__transition)if(+i!==e)return;t&&t.removeChild(this)}}function pc(){return this.on("end.remove",lf(this._id))}function mc(e){var t=this._name,i=this._id;typeof e!="function"&&(e=Te(e));for(var n=this._groups,r=n.length,o=new Array(r),s=0;s<r;++s)for(var a=n[s],u=a.length,c=o[s]=new Array(u),l,d,h=0;h<u;++h)(l=a[h])&&(d=e.call(l,l.__data__,h,a))&&("__data__"in l&&(d.__data__=l.__data__),c[h]=d,ye(c[h],t,i,h,c,dt(l,i)));return new Lt(o,this._parents,t,i)}function gc(e){var t=this._name,i=this._id;typeof e!="function"&&(e=ki(e));for(var n=this._groups,r=n.length,o=[],s=[],a=0;a<r;++a)for(var u=n[a],c=u.length,l,d=0;d<c;++d)if(l=u[d]){for(var h=e.call(l,l.__data__,d,u),f,p=dt(l,i),_=0,x=h.length;_<x;++_)(f=h[_])&&ye(f,t,i,_,h,p);o.push(h),s.push(l)}return new Lt(o,s,t,i)}var cf=ae.prototype.constructor;function _c(){return new cf(this._groups,this._parents)}function uf(e,t){var i,n,r;return function(){var o=ve(this,e),s=(this.style.removeProperty(e),ve(this,e));return o===s?null:o===i&&s===n?r:r=t(i=o,n=s)}}function vc(e){return function(){this.style.removeProperty(e)}}function df(e,t,i){var n,r=i+"",o;return function(){var s=ve(this,e);return s===r?null:s===n?o:o=t(n=s,i)}}function hf(e,t,i){var n,r,o;return function(){var s=ve(this,e),a=i(this),u=a+"";return a==null&&(u=a=(this.style.removeProperty(e),ve(this,e))),s===u?null:s===n&&u===r?o:(r=u,o=t(n=s,a))}}function ff(e,t){var i,n,r,o="style."+t,s="end."+o,a;return function(){var u=Et(this,e),c=u.on,l=u.value[o]==null?a||(a=vc(t)):void 0;(c!==i||r!==l)&&(n=(i=c).copy()).on(s,r=l),u.on=n}}function yc(e,t,i){var n=(e+="")=="transform"?jo:ar;return t==null?this.styleTween(e,uf(e,n)).on("end.style."+e,vc(e)):typeof t=="function"?this.styleTween(e,hf(e,n,ci(this,"style."+e,t))).each(ff(this._id,e)):this.styleTween(e,df(e,n,t),i).on("end.style."+e,null)}function pf(e,t,i){return function(n){this.style.setProperty(e,t.call(this,n),i)}}function mf(e,t,i){var n,r;function o(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&pf(e,s,i)),n}return o._value=t,o}function xc(e,t,i){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,mf(e,t,i??""))}function gf(e){return function(){this.textContent=e}}function _f(e){return function(){var t=e(this);this.textContent=t??""}}function bc(e){return this.tween("text",typeof e=="function"?_f(ci(this,"text",e)):gf(e==null?"":e+""))}function vf(e){return function(t){this.textContent=e.call(this,t)}}function yf(e){var t,i;function n(){var r=e.apply(this,arguments);return r!==i&&(t=(i=r)&&vf(r)),t}return n._value=e,n}function wc(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,yf(e))}function Ec(){for(var e=this._name,t=this._id,i=lr(),n=this._groups,r=n.length,o=0;o<r;++o)for(var s=n[o],a=s.length,u,c=0;c<a;++c)if(u=s[c]){var l=dt(u,t);ye(u,e,i,c,s,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new Lt(n,this._parents,e,i)}function Cc(){var e,t,i=this,n=i._id,r=i.size();return new Promise(function(o,s){var a={value:s},u={value:function(){--r===0&&o()}};i.each(function(){var c=Et(this,n),l=c.on;l!==e&&(t=(e=l).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(u)),c.on=t}),r===0&&o()})}var xf=0;function Lt(e,t,i,n){this._groups=e,this._parents=t,this._name=i,this._id=n}function Ac(e){return ae().transition(e)}function lr(){return++xf}var ue=ae.prototype;Lt.prototype=Ac.prototype={constructor:Lt,select:mc,selectAll:gc,selectChild:ue.selectChild,selectChildren:ue.selectChildren,filter:dc,merge:hc,selection:_c,transition:Ec,call:ue.call,nodes:ue.nodes,node:ue.node,size:ue.size,empty:ue.empty,each:ue.each,on:fc,attr:oc,attrTween:sc,style:yc,styleTween:xc,text:bc,textTween:wc,remove:pc,tween:rc,delay:ac,duration:lc,ease:cc,easeVarying:uc,end:Cc,[Symbol.iterator]:ue[Symbol.iterator]};function cr(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var bf={time:null,delay:0,duration:250,ease:cr};function wf(e,t){for(var i;!(i=e.__transition)||!(i=i[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return i}function Pc(e){var t,i;e instanceof Lt?(t=e._id,e=e._name):(t=lr(),(i=bf).time=$i(),e=e==null?null:e+"");for(var n=this._groups,r=n.length,o=0;o<r;++o)for(var s=n[o],a=s.length,u,c=0;c<a;++c)(u=s[c])&&ye(u,e,t,c,s,i||wf(u,t));return new Lt(n,this._parents,e,t)}ae.prototype.interrupt=nc;ae.prototype.transition=Pc;var{abs:Tb,max:Ib,min:Vb}=Math;function Sc(e){return[+e[0],+e[1]]}function Ef(e){return[Sc(e[0]),Sc(e[1])]}var Bb={name:"x",handles:["w","e"].map(qo),input:function(e,t){return e==null?null:[[+e[0],t[0][1]],[+e[1],t[1][1]]]},output:function(e){return e&&[e[0][0],e[1][0]]}},Gb={name:"y",handles:["n","s"].map(qo),input:function(e,t){return e==null?null:[[t[0][0],+e[0]],[t[1][0],+e[1]]]},output:function(e){return e&&[e[0][1],e[1][1]]}},Hb={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(qo),input:function(e){return e==null?null:Ef(e)},output:function(e){return e}};function qo(e){return{type:e}}var Ko=Math.PI,Zo=2*Ko,He=1e-6,Cf=Zo-He;function Oc(e){this._+=e[0];for(let t=1,i=e.length;t<i;++t)this._+=arguments[t]+e[t]}function Af(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Oc;let i=10**t;return function(n){this._+=n[0];for(let r=1,o=n.length;r<o;++r)this._+=Math.round(arguments[r]*i)/i+n[r]}}var ze=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Oc:Af(t)}moveTo(t,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+i}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,i){this._append`L${this._x1=+t},${this._y1=+i}`}quadraticCurveTo(t,i,n,r){this._append`Q${+t},${+i},${this._x1=+n},${this._y1=+r}`}bezierCurveTo(t,i,n,r,o,s){this._append`C${+t},${+i},${+n},${+r},${this._x1=+o},${this._y1=+s}`}arcTo(t,i,n,r,o){if(t=+t,i=+i,n=+n,r=+r,o=+o,o<0)throw new Error(`negative radius: ${o}`);let s=this._x1,a=this._y1,u=n-t,c=r-i,l=s-t,d=a-i,h=l*l+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=i}`;else if(h>He)if(!(Math.abs(d*u-c*l)>He)||!o)this._append`L${this._x1=t},${this._y1=i}`;else{let f=n-s,p=r-a,_=u*u+c*c,x=f*f+p*p,C=Math.sqrt(_),P=Math.sqrt(h),S=o*Math.tan((Ko-Math.acos((_+h-x)/(2*C*P)))/2),A=S/P,O=S/C;Math.abs(A-1)>He&&this._append`L${t+A*l},${i+A*d}`,this._append`A${o},${o},0,0,${+(d*f>l*p)},${this._x1=t+O*u},${this._y1=i+O*c}`}}arc(t,i,n,r,o,s){if(t=+t,i=+i,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let a=n*Math.cos(r),u=n*Math.sin(r),c=t+a,l=i+u,d=1^s,h=s?r-o:o-r;this._x1===null?this._append`M${c},${l}`:(Math.abs(this._x1-c)>He||Math.abs(this._y1-l)>He)&&this._append`L${c},${l}`,n&&(h<0&&(h=h%Zo+Zo),h>Cf?this._append`A${n},${n},0,1,${d},${t-a},${i-u}A${n},${n},0,1,${d},${this._x1=c},${this._y1=l}`:h>He&&this._append`A${n},${n},0,${+(h>=Ko)},${d},${this._x1=t+n*Math.cos(o)},${this._y1=i+n*Math.sin(o)}`)}rect(t,i,n,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+i}h${n=+n}v${+r}h${-n}Z`}toString(){return this._}};function Nc(){return new ze}Nc.prototype=ze.prototype;function kc(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function De(e,t){if((i=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var i,n=e.slice(0,i);return[n.length>1?n[0]+n.slice(2):n,+e.slice(i+1)]}function Qt(e){return e=De(Math.abs(e)),e?e[1]:NaN}function Mc(e,t){return function(i,n){for(var r=i.length,o=[],s=0,a=e[0],u=0;r>0&&a>0&&(u+a+1>n&&(a=Math.max(1,n-u)),o.push(i.substring(r-=a,r+a)),!((u+=a+1)>n));)a=e[s=(s+1)%e.length];return o.reverse().join(t)}}function Lc(e){return function(t){return t.replace(/[0-9]/g,function(i){return e[+i]})}}var Pf=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function xe(e){if(!(t=Pf.exec(e)))throw new Error("invalid format: "+e);var t;return new ur({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}xe.prototype=ur.prototype;function ur(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}ur.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Rc(e){t:for(var t=e.length,i=1,n=-1,r;i<t;++i)switch(e[i]){case".":n=r=i;break;case"0":n===0&&(n=i),r=i;break;default:if(!+e[i])break t;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(r+1):e}var Jo;function Fc(e,t){var i=De(e,t);if(!i)return e+"";var n=i[0],r=i[1],o=r-(Jo=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,s=n.length;return o===s?n:o>s?n+new Array(o-s+1).join("0"):o>0?n.slice(0,o)+"."+n.slice(o):"0."+new Array(1-o).join("0")+De(e,Math.max(0,t+o-1))[0]}function Qo(e,t){var i=De(e,t);if(!i)return e+"";var n=i[0],r=i[1];return r<0?"0."+new Array(-r).join("0")+n:n.length>r+1?n.slice(0,r+1)+"."+n.slice(r+1):n+new Array(r-n.length+2).join("0")}var ts={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:kc,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Qo(e*100,t),r:Qo,s:Fc,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function es(e){return e}var Tc=Array.prototype.map,Ic=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function Vc(e){var t=e.grouping===void 0||e.thousands===void 0?es:Mc(Tc.call(e.grouping,Number),e.thousands+""),i=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",r=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?es:Lc(Tc.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"\u2212":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function c(d){d=xe(d);var h=d.fill,f=d.align,p=d.sign,_=d.symbol,x=d.zero,C=d.width,P=d.comma,S=d.precision,A=d.trim,O=d.type;O==="n"?(P=!0,O="g"):ts[O]||(S===void 0&&(S=12),A=!0,O="g"),(x||h==="0"&&f==="=")&&(x=!0,h="0",f="=");var M=_==="$"?i:_==="#"&&/[boxX]/.test(O)?"0"+O.toLowerCase():"",L=_==="$"?n:/[%p]/.test(O)?s:"",R=ts[O],F=/[defgprs%]/.test(O);S=S===void 0?6:/[gprs]/.test(O)?Math.max(1,Math.min(21,S)):Math.max(0,Math.min(20,S));function B(b){var G=M,E=L,N,y,I;if(O==="c")E=R(b)+E,b="";else{b=+b;var j=b<0||1/b<0;if(b=isNaN(b)?u:R(Math.abs(b),S),A&&(b=Rc(b)),j&&+b==0&&p!=="+"&&(j=!1),G=(j?p==="("?p:a:p==="-"||p==="("?"":p)+G,E=(O==="s"?Ic[8+Jo/3]:"")+E+(j&&p==="("?")":""),F){for(N=-1,y=b.length;++N<y;)if(I=b.charCodeAt(N),48>I||I>57){E=(I===46?r+b.slice(N+1):b.slice(N))+E,b=b.slice(0,N);break}}}P&&!x&&(b=t(b,1/0));var Q=G.length+b.length+E.length,K=Q<C?new Array(C-Q+1).join(h):"";switch(P&&x&&(b=t(K+b,K.length?C-E.length:1/0),K=""),f){case"<":b=G+b+E+K;break;case"=":b=G+K+b+E;break;case"^":b=K.slice(0,Q=K.length>>1)+G+b+E+K.slice(Q);break;default:b=K+G+b+E;break}return o(b)}return B.toString=function(){return d+""},B}function l(d,h){var f=c((d=xe(d),d.type="f",d)),p=Math.max(-8,Math.min(8,Math.floor(Qt(h)/3)))*3,_=Math.pow(10,-p),x=Ic[8+p/3];return function(C){return f(_*C)+x}}return{format:c,formatPrefix:l}}var dr,hr,fr;is({thousands:",",grouping:[3],currency:["$",""]});function is(e){return dr=Vc(e),hr=dr.format,fr=dr.formatPrefix,dr}function ns(e){return Math.max(0,-Qt(Math.abs(e)))}function rs(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Qt(t)/3)))*3-Qt(Math.abs(e)))}function os(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Qt(t)-Qt(e))+1}var $=1e-6,Bc=1e-12,z=Math.PI,vt=z/2,ss=z/4,yt=z*2,Nt=180/z,tt=z/180,U=Math.abs,pr=Math.atan,de=Math.atan2,X=Math.cos;var Gc=Math.exp;var Hc=Math.log;var J=Math.sin,zc=Math.sign||function(e){return e>0?1:e<0?-1:0},Ht=Math.sqrt,Dc=Math.tan;function $c(e){return e>1?0:e<-1?z:Math.acos(e)}function he(e){return e>1?vt:e<-1?-vt:Math.asin(e)}function xt(){}function mr(e,t){e&&Uc.hasOwnProperty(e.type)&&Uc[e.type](e,t)}var Yc={Feature:function(e,t){mr(e.geometry,t)},FeatureCollection:function(e,t){for(var i=e.features,n=-1,r=i.length;++n<r;)mr(i[n].geometry,t)}},Uc={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var i=e.coordinates,n=-1,r=i.length;++n<r;)e=i[n],t.point(e[0],e[1],e[2])},LineString:function(e,t){as(e.coordinates,t,0)},MultiLineString:function(e,t){for(var i=e.coordinates,n=-1,r=i.length;++n<r;)as(i[n],t,0)},Polygon:function(e,t){jc(e.coordinates,t)},MultiPolygon:function(e,t){for(var i=e.coordinates,n=-1,r=i.length;++n<r;)jc(i[n],t)},GeometryCollection:function(e,t){for(var i=e.geometries,n=-1,r=i.length;++n<r;)mr(i[n],t)}};function as(e,t,i){var n=-1,r=e.length-i,o;for(t.lineStart();++n<r;)o=e[n],t.point(o[0],o[1],o[2]);t.lineEnd()}function jc(e,t){var i=-1,n=e.length;for(t.polygonStart();++i<n;)as(e[i],t,1);t.polygonEnd()}function be(e,t){e&&Yc.hasOwnProperty(e.type)?Yc[e.type](e,t):mr(e,t)}function ji(e){return[de(e[1],e[0]),he(e[2])]}function te(e){var t=e[0],i=e[1],n=X(i);return[n*X(t),n*J(t),J(i)]}function Wi(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function ui(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function gr(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Xi(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function qi(e){var t=Ht(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function Ki(e,t){function i(n,r){return n=e(n,r),t(n[0],n[1])}return e.invert&&t.invert&&(i.invert=function(n,r){return n=t.invert(n,r),n&&e.invert(n[0],n[1])}),i}function ls(e,t){return U(e)>z&&(e-=Math.round(e/yt)*yt),[e,t]}ls.invert=ls;function cs(e,t,i){return(e%=yt)?t||i?Ki(Xc(e),qc(t,i)):Xc(e):t||i?qc(t,i):ls}function Wc(e){return function(t,i){return t+=e,U(t)>z&&(t-=Math.round(t/yt)*yt),[t,i]}}function Xc(e){var t=Wc(e);return t.invert=Wc(-e),t}function qc(e,t){var i=X(e),n=J(e),r=X(t),o=J(t);function s(a,u){var c=X(u),l=X(a)*c,d=J(a)*c,h=J(u),f=h*i+l*n;return[de(d*r-f*o,l*i-h*n),he(f*r+d*o)]}return s.invert=function(a,u){var c=X(u),l=X(a)*c,d=J(a)*c,h=J(u),f=h*r-d*o;return[de(d*r+h*o,l*i+f*n),he(f*i-l*n)]},s}function Kc(e){e=cs(e[0]*tt,e[1]*tt,e.length>2?e[2]*tt:0);function t(i){return i=e(i[0]*tt,i[1]*tt),i[0]*=Nt,i[1]*=Nt,i}return t.invert=function(i){return i=e.invert(i[0]*tt,i[1]*tt),i[0]*=Nt,i[1]*=Nt,i},t}function Jc(e,t,i,n,r,o){if(i){var s=X(t),a=J(t),u=n*i;r==null?(r=t+n*yt,o=t-u/2):(r=Zc(s,r),o=Zc(s,o),(n>0?r<o:r>o)&&(r+=n*yt));for(var c,l=r;n>0?l>o:l<o;l-=u)c=ji([s,-a*X(l),-a*J(l)]),e.point(c[0],c[1])}}function Zc(e,t){t=te(t),t[0]-=e,qi(t);var i=$c(-t[1]);return((-t[2]<0?-i:i)+yt-$)%yt}function _r(){var e=[],t;return{point:function(i,n,r){t.push([i,n,r])},lineStart:function(){e.push(t=[])},lineEnd:xt,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var i=e;return e=[],t=null,i}}}function di(e,t){return U(e[0]-t[0])<$&&U(e[1]-t[1])<$}function vr(e,t,i,n){this.x=e,this.z=t,this.o=i,this.e=n,this.v=!1,this.n=this.p=null}function yr(e,t,i,n,r){var o=[],s=[],a,u;if(e.forEach(function(p){if(!((_=p.length-1)<=0)){var _,x=p[0],C=p[_],P;if(di(x,C)){if(!x[2]&&!C[2]){for(r.lineStart(),a=0;a<_;++a)r.point((x=p[a])[0],x[1]);r.lineEnd();return}C[0]+=2*$}o.push(P=new vr(x,p,null,!0)),s.push(P.o=new vr(x,null,P,!1)),o.push(P=new vr(C,p,null,!1)),s.push(P.o=new vr(C,null,P,!0))}}),!!o.length){for(s.sort(t),Qc(o),Qc(s),a=0,u=s.length;a<u;++a)s[a].e=i=!i;for(var c=o[0],l,d;;){for(var h=c,f=!0;h.v;)if((h=h.n)===c)return;l=h.z,r.lineStart();do{if(h.v=h.o.v=!0,h.e){if(f)for(a=0,u=l.length;a<u;++a)r.point((d=l[a])[0],d[1]);else n(h.x,h.n.x,1,r);h=h.n}else{if(f)for(l=h.p.z,a=l.length-1;a>=0;--a)r.point((d=l[a])[0],d[1]);else n(h.x,h.p.x,-1,r);h=h.p}h=h.o,l=h.z,f=!f}while(!h.v);r.lineEnd()}}}function Qc(e){if(t=e.length){for(var t,i=0,n=e[0],r;++i<t;)n.n=r=e[i],r.p=n,n=r;n.n=r=e[0],r.p=n}}function us(e){return U(e[0])<=z?e[0]:zc(e[0])*((U(e[0])+z)%yt-z)}function tu(e,t){var i=us(t),n=t[1],r=J(n),o=[J(i),-X(i),0],s=0,a=0,u=new Gt;r===1?n=vt+$:r===-1&&(n=-vt-$);for(var c=0,l=e.length;c<l;++c)if(h=(d=e[c]).length)for(var d,h,f=d[h-1],p=us(f),_=f[1]/2+ss,x=J(_),C=X(_),P=0;P<h;++P,p=A,x=M,C=L,f=S){var S=d[P],A=us(S),O=S[1]/2+ss,M=J(O),L=X(O),R=A-p,F=R>=0?1:-1,B=F*R,b=B>z,G=x*M;if(u.add(de(G*F*J(B),C*L+G*X(B))),s+=b?R+F*yt:R,b^p>=i^A>=i){var E=ui(te(f),te(S));qi(E);var N=ui(o,E);qi(N);var y=(b^R>=0?-1:1)*he(N[2]);(n>y||n===y&&(E[0]||E[1]))&&(a+=b^R>=0?1:-1)}}return(s<-$||s<$&&u<-Bc)^a&1}function xr(e,t,i,n){return function(r){var o=t(r),s=_r(),a=t(s),u=!1,c,l,d,h={point:f,lineStart:_,lineEnd:x,polygonStart:function(){h.point=C,h.lineStart=P,h.lineEnd=S,l=[],c=[]},polygonEnd:function(){h.point=f,h.lineStart=_,h.lineEnd=x,l=oi(l);var A=tu(c,n);l.length?(u||(r.polygonStart(),u=!0),yr(l,Of,A,i,r)):A&&(u||(r.polygonStart(),u=!0),r.lineStart(),i(null,null,1,r),r.lineEnd()),u&&(r.polygonEnd(),u=!1),l=c=null},sphere:function(){r.polygonStart(),r.lineStart(),i(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function f(A,O){e(A,O)&&r.point(A,O)}function p(A,O){o.point(A,O)}function _(){h.point=p,o.lineStart()}function x(){h.point=f,o.lineEnd()}function C(A,O){d.push([A,O]),a.point(A,O)}function P(){a.lineStart(),d=[]}function S(){C(d[0][0],d[0][1]),a.lineEnd();var A=a.clean(),O=s.result(),M,L=O.length,R,F,B;if(d.pop(),c.push(d),d=null,!!L){if(A&1){if(F=O[0],(R=F.length-1)>0){for(u||(r.polygonStart(),u=!0),r.lineStart(),M=0;M<R;++M)r.point((B=F[M])[0],B[1]);r.lineEnd()}return}L>1&&A&2&&O.push(O.pop().concat(O.shift())),l.push(O.filter(Sf))}}return h}}function Sf(e){return e.length>1}function Of(e,t){return((e=e.x)[0]<0?e[1]-vt-$:vt-e[1])-((t=t.x)[0]<0?t[1]-vt-$:vt-t[1])}var ds=xr(function(){return!0},Nf,Mf,[-z,-vt]);function Nf(e){var t=NaN,i=NaN,n=NaN,r;return{lineStart:function(){e.lineStart(),r=1},point:function(o,s){var a=o>0?z:-z,u=U(o-t);U(u-z)<$?(e.point(t,i=(i+s)/2>0?vt:-vt),e.point(n,i),e.lineEnd(),e.lineStart(),e.point(a,i),e.point(o,i),r=0):n!==a&&u>=z&&(U(t-n)<$&&(t-=n*$),U(o-a)<$&&(o-=a*$),i=kf(t,i,o,s),e.point(n,i),e.lineEnd(),e.lineStart(),e.point(a,i),r=0),e.point(t=o,i=s),n=a},lineEnd:function(){e.lineEnd(),t=i=NaN},clean:function(){return 2-r}}}function kf(e,t,i,n){var r,o,s=J(e-i);return U(s)>$?pr((J(t)*(o=X(n))*J(i)-J(n)*(r=X(t))*J(e))/(r*o*s)):(t+n)/2}function Mf(e,t,i,n){var r;if(e==null)r=i*vt,n.point(-z,r),n.point(0,r),n.point(z,r),n.point(z,0),n.point(z,-r),n.point(0,-r),n.point(-z,-r),n.point(-z,0),n.point(-z,r);else if(U(e[0]-t[0])>$){var o=e[0]<t[0]?z:-z;r=i*o/2,n.point(-o,r),n.point(0,r),n.point(o,r)}else n.point(t[0],t[1])}function eu(e){var t=X(e),i=2*tt,n=t>0,r=U(t)>$;function o(l,d,h,f){Jc(f,e,i,h,l,d)}function s(l,d){return X(l)*X(d)>t}function a(l){var d,h,f,p,_;return{lineStart:function(){p=f=!1,_=1},point:function(x,C){var P=[x,C],S,A=s(x,C),O=n?A?0:c(x,C):A?c(x+(x<0?z:-z),C):0;if(!d&&(p=f=A)&&l.lineStart(),A!==f&&(S=u(d,P),(!S||di(d,S)||di(P,S))&&(P[2]=1)),A!==f)_=0,A?(l.lineStart(),S=u(P,d),l.point(S[0],S[1])):(S=u(d,P),l.point(S[0],S[1],2),l.lineEnd()),d=S;else if(r&&d&&n^A){var M;!(O&h)&&(M=u(P,d,!0))&&(_=0,n?(l.lineStart(),l.point(M[0][0],M[0][1]),l.point(M[1][0],M[1][1]),l.lineEnd()):(l.point(M[1][0],M[1][1]),l.lineEnd(),l.lineStart(),l.point(M[0][0],M[0][1],3)))}A&&(!d||!di(d,P))&&l.point(P[0],P[1]),d=P,f=A,h=O},lineEnd:function(){f&&l.lineEnd(),d=null},clean:function(){return _|(p&&f)<<1}}}function u(l,d,h){var f=te(l),p=te(d),_=[1,0,0],x=ui(f,p),C=Wi(x,x),P=x[0],S=C-P*P;if(!S)return!h&&l;var A=t*C/S,O=-t*P/S,M=ui(_,x),L=Xi(_,A),R=Xi(x,O);gr(L,R);var F=M,B=Wi(L,F),b=Wi(F,F),G=B*B-b*(Wi(L,L)-1);if(!(G<0)){var E=Ht(G),N=Xi(F,(-B-E)/b);if(gr(N,L),N=ji(N),!h)return N;var y=l[0],I=d[0],j=l[1],Q=d[1],K;I<y&&(K=y,y=I,I=K);var Kt=I-y,Ft=U(Kt-z)<$,zt=Ft||Kt<$;if(!Ft&&Q<j&&(K=j,j=Q,Q=K),zt?Ft?j+Q>0^N[1]<(U(N[0]-y)<$?j:Q):j<=N[1]&&N[1]<=Q:Kt>z^(y<=N[0]&&N[0]<=I)){var Bt=Xi(F,(-B+E)/b);return gr(Bt,L),[N,ji(Bt)]}}}function c(l,d){var h=n?e:z-e,f=0;return l<-h?f|=1:l>h&&(f|=2),d<-h?f|=4:d>h&&(f|=8),f}return xr(s,a,o,n?[0,-e]:[-z,e-z])}function iu(e,t,i,n,r,o){var s=e[0],a=e[1],u=t[0],c=t[1],l=0,d=1,h=u-s,f=c-a,p;if(p=i-s,!(!h&&p>0)){if(p/=h,h<0){if(p<l)return;p<d&&(d=p)}else if(h>0){if(p>d)return;p>l&&(l=p)}if(p=r-s,!(!h&&p<0)){if(p/=h,h<0){if(p>d)return;p>l&&(l=p)}else if(h>0){if(p<l)return;p<d&&(d=p)}if(p=n-a,!(!f&&p>0)){if(p/=f,f<0){if(p<l)return;p<d&&(d=p)}else if(f>0){if(p>d)return;p>l&&(l=p)}if(p=o-a,!(!f&&p<0)){if(p/=f,f<0){if(p>d)return;p>l&&(l=p)}else if(f>0){if(p<l)return;p<d&&(d=p)}return l>0&&(e[0]=s+l*h,e[1]=a+l*f),d<1&&(t[0]=s+d*h,t[1]=a+d*f),!0}}}}}var Zi=1e9,br=-Zi;function hs(e,t,i,n){function r(c,l){return e<=c&&c<=i&&t<=l&&l<=n}function o(c,l,d,h){var f=0,p=0;if(c==null||(f=s(c,d))!==(p=s(l,d))||u(c,l)<0^d>0)do h.point(f===0||f===3?e:i,f>1?n:t);while((f=(f+d+4)%4)!==p);else h.point(l[0],l[1])}function s(c,l){return U(c[0]-e)<$?l>0?0:3:U(c[0]-i)<$?l>0?2:1:U(c[1]-t)<$?l>0?1:0:l>0?3:2}function a(c,l){return u(c.x,l.x)}function u(c,l){var d=s(c,1),h=s(l,1);return d!==h?d-h:d===0?l[1]-c[1]:d===1?c[0]-l[0]:d===2?c[1]-l[1]:l[0]-c[0]}return function(c){var l=c,d=_r(),h,f,p,_,x,C,P,S,A,O,M,L={point:R,lineStart:G,lineEnd:E,polygonStart:B,polygonEnd:b};function R(y,I){r(y,I)&&l.point(y,I)}function F(){for(var y=0,I=0,j=f.length;I<j;++I)for(var Q=f[I],K=1,Kt=Q.length,Ft=Q[0],zt,Bt,fe=Ft[0],At=Ft[1];K<Kt;++K)zt=fe,Bt=At,Ft=Q[K],fe=Ft[0],At=Ft[1],Bt<=n?At>n&&(fe-zt)*(n-Bt)>(At-Bt)*(e-zt)&&++y:At<=n&&(fe-zt)*(n-Bt)<(At-Bt)*(e-zt)&&--y;return y}function B(){l=d,h=[],f=[],M=!0}function b(){var y=F(),I=M&&y,j=(h=oi(h)).length;(I||j)&&(c.polygonStart(),I&&(c.lineStart(),o(null,null,1,c),c.lineEnd()),j&&yr(h,a,y,o,c),c.polygonEnd()),l=c,h=f=p=null}function G(){L.point=N,f&&f.push(p=[]),O=!0,A=!1,P=S=NaN}function E(){h&&(N(_,x),C&&A&&d.rejoin(),h.push(d.result())),L.point=R,A&&l.lineEnd()}function N(y,I){var j=r(y,I);if(f&&p.push([y,I]),O)_=y,x=I,C=j,O=!1,j&&(l.lineStart(),l.point(y,I));else if(j&&A)l.point(y,I);else{var Q=[P=Math.max(br,Math.min(Zi,P)),S=Math.max(br,Math.min(Zi,S))],K=[y=Math.max(br,Math.min(Zi,y)),I=Math.max(br,Math.min(Zi,I))];iu(Q,K,e,t,i,n)?(A||(l.lineStart(),l.point(Q[0],Q[1])),l.point(K[0],K[1]),j||l.lineEnd(),M=!1):j&&(l.lineStart(),l.point(y,I),M=!1)}P=y,S=I,A=j}return L}}var Ji=e=>e;var fs=new Gt,ps=new Gt,nu,ru,ms,gs,we={point:xt,lineStart:xt,lineEnd:xt,polygonStart:function(){we.lineStart=Lf,we.lineEnd=Ff},polygonEnd:function(){we.lineStart=we.lineEnd=we.point=xt,fs.add(U(ps)),ps=new Gt},result:function(){var e=fs/2;return fs=new Gt,e}};function Lf(){we.point=Rf}function Rf(e,t){we.point=ou,nu=ms=e,ru=gs=t}function ou(e,t){ps.add(gs*e-ms*t),ms=e,gs=t}function Ff(){ou(nu,ru)}var _s=we;var hi=1/0,wr=hi,Qi=-hi,Er=Qi,Tf={point:If,lineStart:xt,lineEnd:xt,polygonStart:xt,polygonEnd:xt,result:function(){var e=[[hi,wr],[Qi,Er]];return Qi=Er=-(wr=hi=1/0),e}};function If(e,t){e<hi&&(hi=e),e>Qi&&(Qi=e),t<wr&&(wr=t),t>Er&&(Er=t)}var fi=Tf;var vs=0,ys=0,tn=0,Cr=0,Ar=0,pi=0,xs=0,bs=0,en=0,lu,cu,ee,ie,Xt={point:$e,lineStart:su,lineEnd:au,polygonStart:function(){Xt.lineStart=Gf,Xt.lineEnd=Hf},polygonEnd:function(){Xt.point=$e,Xt.lineStart=su,Xt.lineEnd=au},result:function(){var e=en?[xs/en,bs/en]:pi?[Cr/pi,Ar/pi]:tn?[vs/tn,ys/tn]:[NaN,NaN];return vs=ys=tn=Cr=Ar=pi=xs=bs=en=0,e}};function $e(e,t){vs+=e,ys+=t,++tn}function su(){Xt.point=Vf}function Vf(e,t){Xt.point=Bf,$e(ee=e,ie=t)}function Bf(e,t){var i=e-ee,n=t-ie,r=Ht(i*i+n*n);Cr+=r*(ee+e)/2,Ar+=r*(ie+t)/2,pi+=r,$e(ee=e,ie=t)}function au(){Xt.point=$e}function Gf(){Xt.point=zf}function Hf(){uu(lu,cu)}function zf(e,t){Xt.point=uu,$e(lu=ee=e,cu=ie=t)}function uu(e,t){var i=e-ee,n=t-ie,r=Ht(i*i+n*n);Cr+=r*(ee+e)/2,Ar+=r*(ie+t)/2,pi+=r,r=ie*e-ee*t,xs+=r*(ee+e),bs+=r*(ie+t),en+=r*3,$e(ee=e,ie=t)}var ws=Xt;function Pr(e){this._context=e}Pr.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,yt);break}}},result:xt};var Cs=new Gt,Es,du,hu,nn,rn,Sr={point:xt,lineStart:function(){Sr.point=Df},lineEnd:function(){Es&&fu(du,hu),Sr.point=xt},polygonStart:function(){Es=!0},polygonEnd:function(){Es=null},result:function(){var e=+Cs;return Cs=new Gt,e}};function Df(e,t){Sr.point=fu,du=nn=e,hu=rn=t}function fu(e,t){nn-=e,rn-=t,Cs.add(Ht(nn*nn+rn*rn)),nn=e,rn=t}var As=Sr;var pu,Or,mu,gu,on=class{constructor(t){this._append=t==null?_u:$f(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,i){switch(this._point){case 0:{this._append`M${t},${i}`,this._point=1;break}case 1:{this._append`L${t},${i}`;break}default:{if(this._append`M${t},${i}`,this._radius!==mu||this._append!==Or){let n=this._radius,r=this._;this._="",this._append`m0,${n}a${n},${n} 0 1,1 0,${-2*n}a${n},${n} 0 1,1 0,${2*n}z`,mu=n,Or=this._append,gu=this._,this._=r}this._+=gu;break}}}result(){let t=this._;return this._="",t.length?t:null}};function _u(e){let t=1;this._+=e[0];for(let i=e.length;t<i;++t)this._+=arguments[t]+e[t]}function $f(e){let t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return _u;if(t!==pu){let i=10**t;pu=t,Or=function(r){let o=1;this._+=r[0];for(let s=r.length;o<s;++o)this._+=Math.round(arguments[o]*i)/i+r[o]}}return Or}function Nr(e,t){let i=3,n=4.5,r,o;function s(a){return a&&(typeof n=="function"&&o.pointRadius(+n.apply(this,arguments)),be(a,r(o))),o.result()}return s.area=function(a){return be(a,r(_s)),_s.result()},s.measure=function(a){return be(a,r(As)),As.result()},s.bounds=function(a){return be(a,r(fi)),fi.result()},s.centroid=function(a){return be(a,r(ws)),ws.result()},s.projection=function(a){return arguments.length?(r=a==null?(e=null,Ji):(e=a).stream,s):e},s.context=function(a){return arguments.length?(o=a==null?(t=null,new on(i)):new Pr(t=a),typeof n!="function"&&o.pointRadius(n),s):t},s.pointRadius=function(a){return arguments.length?(n=typeof a=="function"?a:(o.pointRadius(+a),+a),s):n},s.digits=function(a){if(!arguments.length)return i;if(a==null)i=null;else{let u=Math.floor(a);if(!(u>=0))throw new RangeError(`invalid digits: ${a}`);i=u}return t===null&&(o=new on(i)),s},s.projection(e).digits(i).context(t)}function sn(e){return function(t){var i=new Ps;for(var n in e)i[n]=e[n];return i.stream=t,i}}function Ps(){}Ps.prototype={constructor:Ps,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Ss(e,t,i){var n=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),n!=null&&e.clipExtent(null),be(i,e.stream(fi)),t(fi.result()),n!=null&&e.clipExtent(n),e}function Os(e,t,i){return Ss(e,function(n){var r=t[1][0]-t[0][0],o=t[1][1]-t[0][1],s=Math.min(r/(n[1][0]-n[0][0]),o/(n[1][1]-n[0][1])),a=+t[0][0]+(r-s*(n[1][0]+n[0][0]))/2,u=+t[0][1]+(o-s*(n[1][1]+n[0][1]))/2;e.scale(150*s).translate([a,u])},i)}function vu(e,t,i){return Os(e,[[0,0],t],i)}function yu(e,t,i){return Ss(e,function(n){var r=+t,o=r/(n[1][0]-n[0][0]),s=(r-o*(n[1][0]+n[0][0]))/2,a=-o*n[0][1];e.scale(150*o).translate([s,a])},i)}function xu(e,t,i){return Ss(e,function(n){var r=+t,o=r/(n[1][1]-n[0][1]),s=-o*n[0][0],a=(r-o*(n[1][1]+n[0][1]))/2;e.scale(150*o).translate([s,a])},i)}var bu=16,Yf=X(30*tt);function Ns(e,t){return+t?jf(e,t):Uf(e)}function Uf(e){return sn({point:function(t,i){t=e(t,i),this.stream.point(t[0],t[1])}})}function jf(e,t){function i(n,r,o,s,a,u,c,l,d,h,f,p,_,x){var C=c-n,P=l-r,S=C*C+P*P;if(S>4*t&&_--){var A=s+h,O=a+f,M=u+p,L=Ht(A*A+O*O+M*M),R=he(M/=L),F=U(U(M)-1)<$||U(o-d)<$?(o+d)/2:de(O,A),B=e(F,R),b=B[0],G=B[1],E=b-n,N=G-r,y=P*E-C*N;(y*y/S>t||U((C*E+P*N)/S-.5)>.3||s*h+a*f+u*p<Yf)&&(i(n,r,o,s,a,u,b,G,F,A/=L,O/=L,M,_,x),x.point(b,G),i(b,G,F,A,O,M,c,l,d,h,f,p,_,x))}}return function(n){var r,o,s,a,u,c,l,d,h,f,p,_,x={point:C,lineStart:P,lineEnd:A,polygonStart:function(){n.polygonStart(),x.lineStart=O},polygonEnd:function(){n.polygonEnd(),x.lineStart=P}};function C(R,F){R=e(R,F),n.point(R[0],R[1])}function P(){d=NaN,x.point=S,n.lineStart()}function S(R,F){var B=te([R,F]),b=e(R,F);i(d,h,l,f,p,_,d=b[0],h=b[1],l=R,f=B[0],p=B[1],_=B[2],bu,n),n.point(d,h)}function A(){x.point=C,n.lineEnd()}function O(){P(),x.point=M,x.lineEnd=L}function M(R,F){S(r=R,F),o=d,s=h,a=f,u=p,c=_,x.point=S}function L(){i(d,h,l,f,p,_,o,s,r,a,u,c,bu,n),x.lineEnd=A,A()}return x}}var Wf=sn({point:function(e,t){this.stream.point(e*tt,t*tt)}});function Xf(e){return sn({point:function(t,i){var n=e(t,i);return this.stream.point(n[0],n[1])}})}function qf(e,t,i,n,r){function o(s,a){return s*=n,a*=r,[t+e*s,i-e*a]}return o.invert=function(s,a){return[(s-t)/e*n,(i-a)/e*r]},o}function wu(e,t,i,n,r,o){if(!o)return qf(e,t,i,n,r);var s=X(o),a=J(o),u=s*e,c=a*e,l=s/e,d=a/e,h=(a*i-s*t)/e,f=(a*t+s*i)/e;function p(_,x){return _*=n,x*=r,[u*_-c*x+t,i-c*_-u*x]}return p.invert=function(_,x){return[n*(l*_-d*x+h),r*(f-d*_-l*x)]},p}function ks(e){return Kf(function(){return e})()}function Kf(e){var t,i=150,n=480,r=250,o=0,s=0,a=0,u=0,c=0,l,d=0,h=1,f=1,p=null,_=ds,x=null,C,P,S,A=Ji,O=.5,M,L,R,F,B;function b(y){return R(y[0]*tt,y[1]*tt)}function G(y){return y=R.invert(y[0],y[1]),y&&[y[0]*Nt,y[1]*Nt]}b.stream=function(y){return F&&B===y?F:F=Wf(Xf(l)(_(M(A(B=y)))))},b.preclip=function(y){return arguments.length?(_=y,p=void 0,N()):_},b.postclip=function(y){return arguments.length?(A=y,x=C=P=S=null,N()):A},b.clipAngle=function(y){return arguments.length?(_=+y?eu(p=y*tt):(p=null,ds),N()):p*Nt},b.clipExtent=function(y){return arguments.length?(A=y==null?(x=C=P=S=null,Ji):hs(x=+y[0][0],C=+y[0][1],P=+y[1][0],S=+y[1][1]),N()):x==null?null:[[x,C],[P,S]]},b.scale=function(y){return arguments.length?(i=+y,E()):i},b.translate=function(y){return arguments.length?(n=+y[0],r=+y[1],E()):[n,r]},b.center=function(y){return arguments.length?(o=y[0]%360*tt,s=y[1]%360*tt,E()):[o*Nt,s*Nt]},b.rotate=function(y){return arguments.length?(a=y[0]%360*tt,u=y[1]%360*tt,c=y.length>2?y[2]%360*tt:0,E()):[a*Nt,u*Nt,c*Nt]},b.angle=function(y){return arguments.length?(d=y%360*tt,E()):d*Nt},b.reflectX=function(y){return arguments.length?(h=y?-1:1,E()):h<0},b.reflectY=function(y){return arguments.length?(f=y?-1:1,E()):f<0},b.precision=function(y){return arguments.length?(M=Ns(L,O=y*y),N()):Ht(O)},b.fitExtent=function(y,I){return Os(b,y,I)},b.fitSize=function(y,I){return vu(b,y,I)},b.fitWidth=function(y,I){return yu(b,y,I)},b.fitHeight=function(y,I){return xu(b,y,I)};function E(){var y=wu(i,0,0,h,f,d).apply(null,t(o,s)),I=wu(i,n-y[0],r-y[1],h,f,d);return l=cs(a,u,c),L=Ki(t,I),R=Ki(l,L),M=Ns(L,O),N()}function N(){return F=B=null,b}return function(){return t=e.apply(this,arguments),b.invert=t.invert&&G,E()}}function kr(e,t){return[e,Hc(Dc((vt+t)/2))]}kr.invert=function(e,t){return[e,2*pr(Gc(t))-vt]};function Mr(){return Zf(kr).scale(961/yt)}function Zf(e){var t=ks(e),i=t.center,n=t.scale,r=t.translate,o=t.clipExtent,s=null,a,u,c;t.scale=function(d){return arguments.length?(n(d),l()):n()},t.translate=function(d){return arguments.length?(r(d),l()):r()},t.center=function(d){return arguments.length?(i(d),l()):i()},t.clipExtent=function(d){return arguments.length?(d==null?s=a=u=c=null:(s=+d[0][0],a=+d[0][1],u=+d[1][0],c=+d[1][1]),l()):s==null?null:[[s,a],[u,c]]};function l(){var d=z*n(),h=t(Kc(t.rotate()).invert([0,0]));return o(s==null?[[h[0]-d,h[1]-d],[h[0]+d,h[1]+d]]:e===kr?[[Math.max(h[0]-d,s),a],[Math.min(h[0]+d,u),c]]:[[s,Math.max(h[1]-d,a)],[u,Math.min(h[1]+d,c)]])}return l()}function mi(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}var Eu=Symbol("implicit");function Lr(){var e=new _e,t=[],i=[],n=Eu;function r(o){let s=e.get(o);if(s===void 0){if(n!==Eu)return n;e.set(o,s=t.push(o)-1)}return i[s%i.length]}return r.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new _e;for(let s of o)e.has(s)||e.set(s,t.push(s)-1);return r},r.range=function(o){return arguments.length?(i=Array.from(o),r):i.slice()},r.unknown=function(o){return arguments.length?(n=o,r):n},r.copy=function(){return Lr(t,i).unknown(n)},mi.apply(r,arguments),r}function Rr(){var e=Lr().unknown(void 0),t=e.domain,i=e.range,n=0,r=1,o,s,a=!1,u=0,c=0,l=.5;delete e.unknown;function d(){var h=t().length,f=r<n,p=f?r:n,_=f?n:r;o=(_-p)/Math.max(1,h-u+c*2),a&&(o=Math.floor(o)),p+=(_-p-o*(h-u))*l,s=o*(1-u),a&&(p=Math.round(p),s=Math.round(s));var x=Vn(h).map(function(C){return p+o*C});return i(f?x.reverse():x)}return e.domain=function(h){return arguments.length?(t(h),d()):t()},e.range=function(h){return arguments.length?([n,r]=h,n=+n,r=+r,d()):[n,r]},e.rangeRound=function(h){return[n,r]=h,n=+n,r=+r,a=!0,d()},e.bandwidth=function(){return s},e.step=function(){return o},e.round=function(h){return arguments.length?(a=!!h,d()):a},e.padding=function(h){return arguments.length?(u=Math.min(1,c=+h),d()):u},e.paddingInner=function(h){return arguments.length?(u=Math.min(1,h),d()):u},e.paddingOuter=function(h){return arguments.length?(c=+h,d()):c},e.align=function(h){return arguments.length?(l=Math.max(0,Math.min(1,h)),d()):l},e.copy=function(){return Rr(t(),[n,r]).round(a).paddingInner(u).paddingOuter(c).align(l)},mi.apply(d(),arguments)}function Cu(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return Cu(t())},e}function Ms(){return Cu(Rr.apply(null,arguments).paddingInner(1))}function Ls(e){return function(){return e}}function Rs(e){return+e}var Au=[0,1];function gi(e){return e}function Fs(e,t){return(t-=e=+e)?function(i){return(i-e)/t}:Ls(isNaN(t)?NaN:.5)}function Jf(e,t){var i;return e>t&&(i=e,e=t,t=i),function(n){return Math.max(e,Math.min(t,n))}}function Qf(e,t,i){var n=e[0],r=e[1],o=t[0],s=t[1];return r<n?(n=Fs(r,n),o=i(s,o)):(n=Fs(n,r),o=i(o,s)),function(a){return o(n(a))}}function tp(e,t,i){var n=Math.min(e.length,t.length)-1,r=new Array(n),o=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)r[s]=Fs(e[s],e[s+1]),o[s]=i(t[s],t[s+1]);return function(a){var u=ko(e,a,1,n)-1;return o[u](r[u](a))}}function Pu(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function ep(){var e=Au,t=Au,i=ce,n,r,o,s=gi,a,u,c;function l(){var h=Math.min(e.length,t.length);return s!==gi&&(s=Jf(e[0],e[h-1])),a=h>2?tp:Qf,u=c=null,d}function d(h){return h==null||isNaN(h=+h)?o:(u||(u=a(e.map(n),t,i)))(n(s(h)))}return d.invert=function(h){return s(r((c||(c=a(t,e.map(n),wt)))(h)))},d.domain=function(h){return arguments.length?(e=Array.from(h,Rs),l()):e.slice()},d.range=function(h){return arguments.length?(t=Array.from(h),l()):t.slice()},d.rangeRound=function(h){return t=Array.from(h),i=Yo,l()},d.clamp=function(h){return arguments.length?(s=h?!0:gi,l()):s!==gi},d.interpolate=function(h){return arguments.length?(i=h,l()):i},d.unknown=function(h){return arguments.length?(o=h,d):o},function(h,f){return n=h,r=f,l()}}function Ts(){return ep()(gi,gi)}function Is(e,t,i,n){var r=Mo(e,t,i),o;switch(n=xe(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(o=rs(r,s))&&(n.precision=o),fr(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(o=os(r,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=o-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(o=ns(r))&&(n.precision=o-(n.type==="%")*2);break}}return hr(n)}function ip(e){var t=e.domain;return e.ticks=function(i){var n=t();return ri(n[0],n[n.length-1],i??10)},e.tickFormat=function(i,n){var r=t();return Is(r[0],r[r.length-1],i??10,n)},e.nice=function(i){i==null&&(i=10);var n=t(),r=0,o=n.length-1,s=n[r],a=n[o],u,c,l=10;for(a<s&&(c=s,s=a,a=c,c=r,r=o,o=c);l-- >0;){if(c=Si(s,a,i),c===u)return n[r]=s,n[o]=a,t(n);if(c>0)s=Math.floor(s/c)*c,a=Math.ceil(a/c)*c;else if(c<0)s=Math.ceil(s*c)/c,a=Math.floor(a*c)/c;else break;u=c}return e},e}function Ee(){var e=Ts();return e.copy=function(){return Pu(e,Ee())},mi.apply(e,arguments),ip(e)}function kt(e){return function(){return e}}var Vs=Math.abs,Ct=Math.atan2,Ce=Math.cos,Su=Math.max,Fr=Math.min,qt=Math.sin,Ye=Math.sqrt,Rt=1e-12,_i=Math.PI,an=_i/2,Ou=2*_i;function Nu(e){return e>1?0:e<-1?_i:Math.acos(e)}function Bs(e){return e>=1?an:e<=-1?-an:Math.asin(e)}function Tr(e){let t=3;return e.digits=function(i){if(!arguments.length)return t;if(i==null)t=null;else{let n=Math.floor(i);if(!(n>=0))throw new RangeError(`invalid digits: ${i}`);t=n}return e},()=>new ze(t)}function np(e){return e.innerRadius}function rp(e){return e.outerRadius}function op(e){return e.startAngle}function sp(e){return e.endAngle}function ap(e){return e&&e.padAngle}function lp(e,t,i,n,r,o,s,a){var u=i-e,c=n-t,l=s-r,d=a-o,h=d*u-l*c;if(!(h*h<Rt))return h=(l*(t-o)-d*(e-r))/h,[e+h*u,t+h*c]}function Ir(e,t,i,n,r,o,s){var a=e-i,u=t-n,c=(s?o:-o)/Ye(a*a+u*u),l=c*u,d=-c*a,h=e+l,f=t+d,p=i+l,_=n+d,x=(h+p)/2,C=(f+_)/2,P=p-h,S=_-f,A=P*P+S*S,O=r-o,M=h*_-p*f,L=(S<0?-1:1)*Ye(Su(0,O*O*A-M*M)),R=(M*S-P*L)/A,F=(-M*P-S*L)/A,B=(M*S+P*L)/A,b=(-M*P+S*L)/A,G=R-x,E=F-C,N=B-x,y=b-C;return G*G+E*E>N*N+y*y&&(R=B,F=b),{cx:R,cy:F,x01:-l,y01:-d,x11:R*(r/O-1),y11:F*(r/O-1)}}function Gs(){var e=np,t=rp,i=kt(0),n=null,r=op,o=sp,s=ap,a=null,u=Tr(c);function c(){var l,d,h=+e.apply(this,arguments),f=+t.apply(this,arguments),p=r.apply(this,arguments)-an,_=o.apply(this,arguments)-an,x=Vs(_-p),C=_>p;if(a||(a=l=u()),f<h&&(d=f,f=h,h=d),!(f>Rt))a.moveTo(0,0);else if(x>Ou-Rt)a.moveTo(f*Ce(p),f*qt(p)),a.arc(0,0,f,p,_,!C),h>Rt&&(a.moveTo(h*Ce(_),h*qt(_)),a.arc(0,0,h,_,p,C));else{var P=p,S=_,A=p,O=_,M=x,L=x,R=s.apply(this,arguments)/2,F=R>Rt&&(n?+n.apply(this,arguments):Ye(h*h+f*f)),B=Fr(Vs(f-h)/2,+i.apply(this,arguments)),b=B,G=B,E,N;if(F>Rt){var y=Bs(F/h*qt(R)),I=Bs(F/f*qt(R));(M-=y*2)>Rt?(y*=C?1:-1,A+=y,O-=y):(M=0,A=O=(p+_)/2),(L-=I*2)>Rt?(I*=C?1:-1,P+=I,S-=I):(L=0,P=S=(p+_)/2)}var j=f*Ce(P),Q=f*qt(P),K=h*Ce(O),Kt=h*qt(O);if(B>Rt){var Ft=f*Ce(S),zt=f*qt(S),Bt=h*Ce(A),fe=h*qt(A),At;if(x<_i)if(At=lp(j,Q,Bt,fe,Ft,zt,K,Kt)){var qr=j-At[0],Kr=Q-At[1],Zr=Ft-At[0],Jr=zt-At[1],Us=1/qt(Nu((qr*Zr+Kr*Jr)/(Ye(qr*qr+Kr*Kr)*Ye(Zr*Zr+Jr*Jr)))/2),js=Ye(At[0]*At[0]+At[1]*At[1]);b=Fr(B,(h-js)/(Us-1)),G=Fr(B,(f-js)/(Us+1))}else b=G=0}L>Rt?G>Rt?(E=Ir(Bt,fe,j,Q,f,G,C),N=Ir(Ft,zt,K,Kt,f,G,C),a.moveTo(E.cx+E.x01,E.cy+E.y01),G<B?a.arc(E.cx,E.cy,G,Ct(E.y01,E.x01),Ct(N.y01,N.x01),!C):(a.arc(E.cx,E.cy,G,Ct(E.y01,E.x01),Ct(E.y11,E.x11),!C),a.arc(0,0,f,Ct(E.cy+E.y11,E.cx+E.x11),Ct(N.cy+N.y11,N.cx+N.x11),!C),a.arc(N.cx,N.cy,G,Ct(N.y11,N.x11),Ct(N.y01,N.x01),!C))):(a.moveTo(j,Q),a.arc(0,0,f,P,S,!C)):a.moveTo(j,Q),!(h>Rt)||!(M>Rt)?a.lineTo(K,Kt):b>Rt?(E=Ir(K,Kt,Ft,zt,h,-b,C),N=Ir(j,Q,Bt,fe,h,-b,C),a.lineTo(E.cx+E.x01,E.cy+E.y01),b<B?a.arc(E.cx,E.cy,b,Ct(E.y01,E.x01),Ct(N.y01,N.x01),!C):(a.arc(E.cx,E.cy,b,Ct(E.y01,E.x01),Ct(E.y11,E.x11),!C),a.arc(0,0,h,Ct(E.cy+E.y11,E.cx+E.x11),Ct(N.cy+N.y11,N.cx+N.x11),C),a.arc(N.cx,N.cy,b,Ct(N.y11,N.x11),Ct(N.y01,N.x01),!C))):a.arc(0,0,h,O,A,C)}if(a.closePath(),l)return a=null,l+""||null}return c.centroid=function(){var l=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,d=(+r.apply(this,arguments)+ +o.apply(this,arguments))/2-_i/2;return[Ce(d)*l,qt(d)*l]},c.innerRadius=function(l){return arguments.length?(e=typeof l=="function"?l:kt(+l),c):e},c.outerRadius=function(l){return arguments.length?(t=typeof l=="function"?l:kt(+l),c):t},c.cornerRadius=function(l){return arguments.length?(i=typeof l=="function"?l:kt(+l),c):i},c.padRadius=function(l){return arguments.length?(n=l==null?null:typeof l=="function"?l:kt(+l),c):n},c.startAngle=function(l){return arguments.length?(r=typeof l=="function"?l:kt(+l),c):r},c.endAngle=function(l){return arguments.length?(o=typeof l=="function"?l:kt(+l),c):o},c.padAngle=function(l){return arguments.length?(s=typeof l=="function"?l:kt(+l),c):s},c.context=function(l){return arguments.length?(a=l??null,c):a},c}var sA=Array.prototype.slice;function ku(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Mu(e){this._context=e}Mu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Lu(e){return new Mu(e)}function Ru(e){return e[0]}function Fu(e){return e[1]}function Hs(e,t){var i=kt(!0),n=null,r=Lu,o=null,s=Tr(a);e=typeof e=="function"?e:e===void 0?Ru:kt(e),t=typeof t=="function"?t:t===void 0?Fu:kt(t);function a(u){var c,l=(u=ku(u)).length,d,h=!1,f;for(n==null&&(o=r(f=s())),c=0;c<=l;++c)!(c<l&&i(d=u[c],c,u))===h&&((h=!h)?o.lineStart():o.lineEnd()),h&&o.point(+e(d,c,u),+t(d,c,u));if(f)return o=null,f+""||null}return a.x=function(u){return arguments.length?(e=typeof u=="function"?u:kt(+u),a):e},a.y=function(u){return arguments.length?(t=typeof u=="function"?u:kt(+u),a):t},a.defined=function(u){return arguments.length?(i=typeof u=="function"?u:kt(!!u),a):i},a.curve=function(u){return arguments.length?(r=u,n!=null&&(o=r(n)),a):r},a.context=function(u){return arguments.length?(u==null?n=o=null:o=r(n=u),a):n},a}function Ae(e,t,i){this.k=e,this.x=t,this.y=i}Ae.prototype={constructor:Ae,scale:function(e){return e===1?this:new Ae(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Ae(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var zs=new Ae(1,0,0);Ds.prototype=Ae.prototype;function Ds(e){for(;!e.__zoom;)if(!(e=e.parentNode))return zs;return e.__zoom}var vi=class e{countyFeatures=[];townshipFeatures=[];mapColorConfig={};regionCode;regionCodeChange=new mt;districtCode;districtCodeChange=new mt;_elementRef=w(Pt);_commonService=w(Tt);_width=800;_height=600;_svg;_container;_projection;_path;_currentZoom=1;_countiesCode=["09007","09020","10016"];_outerIslandCountySettings=[];_destroy=new Y;ngOnChanges(t){return Pe(this,null,function*(){let{regionCode:i,mapColorConfig:n}=t;if(i&&(yield this._handleRegionCodeChange(i.currentValue)),n&&n.currentValue){let r="#ddd";this._container.selectAll(".d3-county-path").attr("fill",o=>this.mapColorConfig[this._getRegionCode(o)]||r),this._container.select(`.${"d3-region-"+this.regionCode}`).selectAll(".d3-township-path").attr("fill",o=>this.mapColorConfig[this._getTownshipCode(o)]||r)}})}ngAfterViewInit(){this._commonService.createResizeObservable(this._elementRef.nativeElement).pipe(ct(this._destroy),me(50),pe(0)).subscribe(()=>this._rerenderMap()),this._initializeMap(),this._renderCountyLayer(this.countyFeatures)}ngOnDestroy(){this._destroy.next(null),this._destroy.complete()}_handleRegionCodeChange(t){return Pe(this,null,function*(){if(!(!this._svg||!this._projection||!this._path)){if(this._container.selectAll(".d3-county-name").style("opacity","0"),this._renderTownshipLayer(""),t==="")this._toggleOuterIslandRectFocusRender(!1),yield this.zoomToAllCounty().end(),this._container.selectAll(".d3-county-name").style("opacity","1").raise();else{let i=!!this._outerIslandCountySettings.find(n=>n.code===t);this._toggleOuterIslandRectFocusRender(i),yield this._zoomToCounty(t)?.end()}this._renderTownshipLayer(t)}})}_updateSvgDimensions(){this._width=this._elementRef.nativeElement.clientWidth,this._height=this._elementRef.nativeElement.clientHeight}_updateMapLayout(){this._updateSvgDimensions(),this._projection.translate([this._width/2,this._height/2]),this._path=Nr().projection(this._projection)}_rerenderMap(){!this._svg||!this._projection||!this._path||(this._updateMapLayout(),this._container.selectAll(".d3-county-path").attr("d",t=>this._getTargetPath(this._getRegionCode(t))(t)),this._container.selectAll(".d3-township-path").attr("d",t=>this._getTargetPath(this._getRegionCode(t))(t)),this._container.selectAll(".d3-info-text").attr("x",t=>`${this._getPathCentroid(t)[0]}`).attr("y",t=>`${this._getPathCentroid(t)[1]}`).attr("transform",t=>this._getTextTransform(t)),this._zoomToCounty(this.regionCode))}_initializeMap(){this._svg=le(this._elementRef.nativeElement).append("svg").style("width","100%").style("height","100%").on("click",t=>{t.target.tagName==="path"||t.target.tagName==="rect"||this.regionCodeChange.emit("")}),this._container=this._svg.append("g"),this._projection=Mr().center([120.95,23.6]).scale(12500),this._updateMapLayout()}_renderHighlight(t,i){this._container.selectAll(".d3-highlight-path").data(t?[t]:[]).join(n=>(n.append("path").attr("d",r=>i(r)).attr("class","d3-highlight-path").style("fill","white").style("opacity","0.2").style("pointer-events","none"),this._svg.selectAll("text").raise(),n),n=>(this._svg.selectAll("text").raise(),n),n=>n.remove())}_renderCountyLayer(t){let i={spacing:8,marginTop:16,marginLeft:16};this._countiesCode.forEach((n,r)=>{let o=t.find(f=>f.properties.COUNTYCODE===n);if(!o)return;let s=72,a=n==="10016"?138:73,u=i.marginLeft,c=this._outerIslandCountySettings.slice(0,r).map(f=>f.boxHeight).reduce((f,p)=>f+p,i.marginTop+i.spacing*r),l=Mr().fitExtent([[u+s*.1,c+s*.1],[u+s*.8,c+a*.8]],o),d=Nr().projection(l),h=`translate(${u+s*.1}, ${c+a*.1})`;this._outerIslandCountySettings.push({code:n,x:u,y:c,boxWidth:s,boxHeight:a,projection:l,path:d,transform:h})}),this._container.selectAll(".d3-region-item").data(t).join("g").attr("class",n=>`d3-region-item ${"d3-region-"+this._getRegionCode(n)}`).call(n=>(this._drawMainIslandCountry(n.filter(r=>!this._countiesCode.includes(this._getRegionCode(r)))),this._drawOuterIslandCountry(n.filter(r=>this._countiesCode.includes(this._getRegionCode(r)))),n)),this._renderPlaceNameLayer(t,"d3-county-name")}_drawMainIslandCountry(t){t.selectAll(".d3-county-path").data(i=>[i]).join("path").attr("class",i=>`d3-county-path ${"d3-path-"+this._getRegionCode(i)}`).attr("d",this._path).on("mouseenter",(i,n)=>this._renderHighlight(n,this._path)).on("mouseleave",i=>this._renderHighlight(null,this._path)).on("click",(i,n)=>this.regionCodeChange.emit(this._getRegionCode(n)))}_drawOuterIslandCountry(t){let i=n=>{let r=this._outerIslandCountySettings.findIndex(o=>o.code===this._getRegionCode(n));return this._outerIslandCountySettings[r]};t.selectAll("rect").data(n=>[n]).join("rect").attr("x",n=>i(n).x).attr("y",n=>i(n).y).attr("rx",8).attr("ry",8).attr("width",n=>i(n).boxWidth).attr("height",n=>i(n).boxHeight).attr("fill","white").on("mouseenter",(n,r)=>this._renderHighlight(r,i(r).path)).on("mouseleave",(n,r)=>this._renderHighlight(null,i(r).path)).on("click",(n,r)=>this.regionCodeChange.emit(this._getRegionCode(r))),t.selectAll(".d3-county-path").data(n=>[n]).join("path").attr("class",n=>`d3-county-path ${"d3-path-"+this._getRegionCode(n)}`).attr("d",n=>i(n).path(n)).attr("pointer-events","none")}_renderTownshipLayer(t){if(this._container.selectAll(".d3-township-name").remove(),this._container.selectAll(".d3-township-path").remove(),t===""||!t)return;let i=this.townshipFeatures.filter(n=>n.properties.COUNTYCODE===t);this._container.select(`.${"d3-region-"+t}`).selectAll(".d3-township-path").data(i).join("path").attr("class",n=>`d3-township-path ${"d3-path-"+this._getTownshipCode(n)}`).attr("d",n=>this._getTargetPath(this._getRegionCode(n))(n)).on("mouseenter",(n,r)=>this._renderHighlight(r,this._getTargetPath(t))).on("mouseleave",n=>this._renderHighlight(null,this._getTargetPath(t))).on("click",(n,r)=>this.districtCodeChange.emit(this._getTownshipCode(r))),this._renderPlaceNameLayer(i,"d3-township-name")}_toggleOuterIslandRectFocusRender(t){this._container.selectAll("rect").style("opacity",t?"0":"1").style("pointer-events",t?"none":"auto")}_getRegionCode(t){return t.properties.COUNTYCODE}_getTownshipCode(t){return t.properties.TOWNCODE}_getTargetPath(t){let i=this._outerIslandCountySettings.find(n=>n.code===t);return i?i.path:this._path}_getPathCentroid(t){let i=this._outerIslandCountySettings.findIndex(r=>r.code===this._getRegionCode(t)),n=t.properties.COUNTYCODE&&!t.properties.TOWNCODE;return i!==-1&&n?[this._outerIslandCountySettings[i].x+this._outerIslandCountySettings[i].boxWidth/2,this._outerIslandCountySettings[i].y+this._outerIslandCountySettings[i].boxHeight-12]:this._getTargetPath(this._getRegionCode(t)).centroid(t).map((r,o)=>r+o*this._getTextFontSize()/2)}_getTextFontSize(){return 16/this._currentZoom}_getTextTransform(t){let i=!t.properties.TOWNCODE,n=(s,a)=>{if(!a)return{x:0,y:0};switch(s){case"10017":return{x:30,y:-15};case"63000":return{x:5,y:10};case"65000":return{x:-5,y:20};case"68000":return{x:-15,y:-25};case"10018":return{x:35,y:-10};case"10004":return{x:5,y:5};case"10005":return{x:-5,y:0};case"66000":return{x:-20,y:5};case"10009":return{x:0,y:-10};case"10020":return{x:0,y:10};case"10010":return{x:40,y:0};case"64000":return{x:10,y:0};case"10013":return{x:-15,y:-30};case"10015":return{x:5,y:0};default:return{x:0,y:0}}},{x:r,y:o}=n(this._getRegionCode(t),i);return`translate(${r}, ${o})`}_getTextContent(t){return t.properties.TOWNCODE?t.properties.TOWNNAME:this._countiesCode.includes(this._getRegionCode(t))?(n=>n==="\u9023\u6C5F"?"\u99AC\u7956":n)(t.properties.COUNTYNAME.replace("\u7E23","")):t.properties.COUNTYNAME}_renderPlaceNameLayer(t,i){let n=this._container;if(i==="d3-township-name"){let r=this._getRegionCode(t[0]);this._outerIslandCountySettings.findIndex(s=>s.code===r)!==-1&&(n=n.select(`.${"d3-region-"+r}`))}n.selectAll(`.${i}`).data(t).join("text").attr("class",`d3-info-text ${i}`).attr("font-size",`${this._getTextFontSize()}px`).attr("x",r=>`${this._getPathCentroid(r)[0]}`).attr("y",r=>`${this._getPathCentroid(r)[1]}`).attr("transform",r=>this._getTextTransform(r)).text(r=>this._getTextContent(r)).raise()}_zoomToCounty(t){let i=this.countyFeatures.find(d=>d.properties.COUNTYCODE===t);if(i===void 0)return;let r=this._getTargetPath(t).bounds(i),o=r[1][0]-r[0][0],s=r[1][1]-r[0][1],a=(r[0][0]+r[1][0])/2,u=(r[0][1]+r[1][1])/2,c=Math.max(1,Math.min(25,.9/Math.max(o/this._width,s/this._height))),l=[this._width/2-c*a,this._height/2-c*u];return this._currentZoom=c,this._container.interrupt().transition().duration(500).attr("transform",`translate(${l[0]},${l[1]}) scale(${c})`)}zoomToAllCounty(){return this._currentZoom=1,this._container.interrupt().transition().duration(500).attr("transform","translate(0, 0) scale(1)")}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=D({type:e,selectors:[["app-zh-tw-map"]],inputs:{countyFeatures:"countyFeatures",townshipFeatures:"townshipFeatures",mapColorConfig:"mapColorConfig",regionCode:"regionCode",districtCode:"districtCode"},outputs:{regionCodeChange:"regionCodeChange",districtCodeChange:"districtCodeChange"},features:[nt],decls:0,vars:0,template:function(i,n){},encapsulation:2})};var Br=class e{constructor(t,i){this.dialogRef=t;this.data=i;this.mapColorConfig=ht({},i.mapColorConfig)}_apiService=w(ti);regionCode="";districtCode="";mapColorConfig;_updateMapColorConfig(t){let i=t.ADMIN_COLLECTION.map(n=>{let r=n.CANDIDATES_VOTES.reduce((a,u)=>{let c=a.VOTE_COUNT??-1/0;return(u.VOTE_COUNT??-1/0)>c?u:a},n.CANDIDATES_VOTES[0]),o=t.CANDIDATES.findIndex(a=>a.NO==r.NO),s=It[t.CANDIDATES[o].PARTY]?.REPRESENTATIVE_COLOR||"";return{[n.ADMIN_CODE]:s}}).reduce((n,r)=>ht(ht({},n),r),{});this.mapColorConfig=ht(ht({},this.mapColorConfig),i)}changeRegionCode(t){return Pe(this,null,function*(){let i=t===""?this._apiService.fetchCentralVotesJson(this.data.gregorianYear):this._apiService.fetchCountyVotesJson(this.data.gregorianYear,t),n=yield cn(i.pipe(wi(()=>Se(void 0))));this._updateMapColorConfig(n||new Yt),this.regionCode=t})}search(){let{regionCode:t,districtCode:i}=this;this.dialogRef.close({regionCode:t,districtCode:i})}cancel(){this.dialogRef.close()}static \u0275fac=function(i){return new(i||e)(oo(ii),oo(So))};static \u0275cmp=D({type:e,selectors:[["app-mobile-map-selector"]],decls:14,vars:5,consts:[[1,"flex","h-[calc(100dvh_-_48px)]","w-[calc(100dvw_-_24px)]","flex-col","rounded-2xl","bg-white","shadow"],[1,"flex","items-center","justify-between","px-4","py-3"],[1,"text-base","font-bold","text-dark"],["type","button",1,"flex","size-5","items-center","justify-center","rounded-full",3,"click"],["width","18","height","18","viewBox","0 0 18 18","fill","none","xmlns","http://www.w3.org/2000/svg"],["d","M13.1797 12.0078L10.1719 9L13.1797 5.99219L12.0078 4.82031L9 7.82812L5.99219 4.82031L4.82031 5.99219L7.82812 9L4.82031 12.0078L5.99219 13.1797L9 10.1719L12.0078 13.1797L13.1797 12.0078ZM3.10156 3.14062C4.74219 1.5 6.70833 0.679688 9 0.679688C11.2917 0.679688 13.2448 1.5 14.8594 3.14062C16.5 4.75521 17.3203 6.70833 17.3203 9C17.3203 11.2917 16.5 13.2578 14.8594 14.8984C13.2448 16.513 11.2917 17.3203 9 17.3203C6.70833 17.3203 4.74219 16.513 3.10156 14.8984C1.48698 13.2578 0.679688 11.2917 0.679688 9C0.679688 6.70833 1.48698 4.75521 3.10156 3.14062Z","fill","#334155"],[1,"grow","bg-[#E4FAFF]"],[1,"block","size-full",3,"regionCodeChange","mapColorConfig","countyFeatures","townshipFeatures","regionCode","districtCode"],[1,"flex","items-center","justify-between","gap-x-5","px-4","py-3"],["type","button",1,"w-full","rounded-md","bg-gray-200","px-4","py-2","text-sm","text-dark",3,"click"],["type","button",1,"w-full","rounded-md","bg-primary","px-4","py-2","text-sm","text-white",3,"click"]],template:function(i,n){i&1&&(g(0,"div",0)(1,"div",1)(2,"h3",2),k(3,"\u53F0\u7063\u5730\u5716"),m(),g(4,"button",3),W("click",function(){return n.cancel()}),mn(),g(5,"svg",4),T(6,"path",5),m()()(),Zs(),g(7,"div",6)(8,"app-zh-tw-map",7),W("regionCodeChange",function(o){return n.changeRegionCode(o)}),m()(),g(9,"div",8)(10,"button",9),W("click",function(){return n.cancel()}),k(11," \u8FD4\u56DE "),m(),g(12,"button",10),W("click",function(){return n.search()}),k(13," \u641C\u5C0B "),m()()()),i&2&&(v(8),V("mapColorConfig",n.mapColorConfig)("countyFeatures",n.data.regionFeatures)("townshipFeatures",n.data.districtFeatures)("regionCode",n.regionCode)("districtCode",n.districtCode))},dependencies:[vi],encapsulation:2})};function cp(e,t){if(e&1&&(g(0,"div",2)(1,"div",3),T(2,"div",4),g(3,"div"),k(4),m()(),g(5,"div"),k(6),ut(7,"number"),m()()),e&2){let i=t.$implicit,n=H();v(2),gt("background",i.color),v(2),lt(n.POLITICAL_PARTIES[i.subgroupId].CN_FULL_NAME),v(2),na("",re(7,5,i.value,"1.2-2"),"",n.unit,"")}}var yi=class e{title="";dataList=[];unit="";POLITICAL_PARTIES=It;static \u0275fac=function(i){return new(i||e)};static \u0275cmp=D({type:e,selectors:[["app-chart-tooltip"]],inputs:{title:"title",dataList:"dataList",unit:"unit"},decls:5,vars:1,consts:[[1,"grid","gap-y-2","rounded-lg","border","border-solid","border-gray-300","bg-white","p-4","shadow"],[1,"text-base","font-bold","text-dark"],[1,"flex","items-center","justify-between","gap-x-9","text-xs","leading-5","text-dark"],[1,"flex","items-center","gap-x-2"],[1,"h-2","w-2","rounded-full"]],template:function(i,n){i&1&&(g(0,"div",0)(1,"h6",1),k(2),m(),rt(3,cp,8,8,"div",2,_t),m()),i&2&&(v(2),lt(n.title),v(),ot(n.dataList))},dependencies:[ge],encapsulation:2})};var Gr=class e{data=[];marginTop=24;marginRight=0;marginBottom=28;marginLeft=56;groupGap=.2;barGap=.2;tickInnerGap=16;tickCount=4;onPointer=new mt;_elementRef=w(Pt);_commonService=w(Tt);width=124;height=124;svg;chartG;yAxisG;yScale;groups=[];subgroups=[];_destroy=new Y;ngAfterViewInit(){this._initializeChart(),this._commonService.createResizeObservable(this._elementRef.nativeElement).pipe(ct(this._destroy),me(50),pe(0)).subscribe(()=>this._updateChartLayout(this.data))}ngOnChanges(t){if(this.svg){if(t.width||t.height||t.marginTop||t.marginRight||t.marginBottom||t.marginLeft||t.groupGap||t.barGap){let i=t.data?t.data.currentValue:this.data;this._updateChartLayout(i)}t.data&&this._updateChartRender(t.data.currentValue)}}ngOnDestroy(){this._destroy.next(null),this._destroy.complete()}_initializeChart(){this.svg=le(this._elementRef.nativeElement).append("svg"),this.yAxisG=this.svg.append("g"),this.chartG=this.svg.append("g"),this._updateChartLayout(this.data)}_updateChartLayout(t){this.width=this._elementRef.nativeElement.clientWidth,this.height=this._elementRef.nativeElement.clientHeight,this.svg.attr("width",this.width).attr("height",this.height).attr("viewBox",[0,0,this.width,this.height]),this._updateChartRender(t)}_updateChartRender(t){this.groups=Array.from(new Set(t.map(r=>r.groupId))),this.subgroups=Array.from(new Set(t.map(r=>r.subgroupId)));let i=this.width-this.marginLeft-this.tickInnerGap-this.marginRight,n=this.groups.length===0?0:i/this.groups.length;this._updateYAxis(i,t),this._updateGroupBars(n,t),this._updateLabels(n)}_calculateTickValues(t,i){let n=ri(0,t,i);n[n.length-1]<t&&(n[n.length]=n[n.length-1]+n[1]);let r=n[n.length-1]/i,o=String(r).length;if(o>=4){let u=Number(String(r).slice(0,1)),c=Number(String(r).slice(1,2));c<5&&c!==0?c=5:c>5&&(u+=1,c=0),r=Number(`${u}${c}`.padEnd(o,"0"))}let s=[0,1e3,2e3,3e3,4e3],a=Array(i+1).fill(r).map((u,c)=>u*c);return a.every(u=>u===0)?s:a}_updateYAxis(t,i){let n=In(i,u=>u.value)??0,r=this._calculateTickValues(n,this.tickCount);this.yScale=Ee().domain([0,r[r.length-1]]).range([this.height-this.marginBottom,this.marginTop]);let o=1e4,s=r[1]>=o,a=Ni(this.yScale).tickValues(r).tickFormat(u=>{let c=Number(u),l=s?c/o:c,d=s&&l?"\u842C":"";return Math.trunc(l).toLocaleString()+d}).tickPadding(this.marginLeft-this.tickInnerGap).tickSizeInner(0).tickSizeOuter(0);this.yAxisG.attr("transform",`translate(${this.marginLeft+this.tickInnerGap},0)`).call(a).call(u=>u.select(".domain").remove()).call(u=>{u.selectAll(".tick line").attr("x2",t).attr("stroke","#DEE2E6"),u.selectAll(".tick text").attr("class","d3-chart-label")})}_updateGroupBars(t,i){let n=t*(1-this.groupGap)/this.subgroups.length,r=ni(i,c=>c.groupId),o=this.chartG.selectAll("g.d3-chart-data-group").data(Array.from(r.entries()));o.exit().remove();let u=o.enter().append("g").attr("class","d3-chart-data-group").merge(o).attr("transform",(c,l)=>`translate(${this.marginLeft+this.tickInnerGap+l*t},0)`).on("pointerover",(c,l)=>this.onPointer.emit({event:c,data:l[1]})).on("pointerleave",(c,l)=>this.onPointer.emit({event:c,data:l[1]})).selectAll("rect").data(([c,l])=>l);u.exit().remove(),u.enter().append("rect").merge(u).transition().duration(500).attr("x",c=>this.subgroups.indexOf(c.subgroupId)*n+this.groupGap*t/2).attr("y",c=>this.yScale(c.value)).attr("width",n*(1-this.barGap)).attr("height",c=>this.yScale(0)-this.yScale(c.value)).attr("fill",c=>c.color)}_updateLabels(t){let i=this.svg.selectAll("text.d3-chart-x-label").data(this.groups);i.exit().remove(),i.enter().append("text").attr("class","d3-chart-label d3-chart-x-label").merge(i).attr("x",(n,r)=>this.marginLeft+this.tickInnerGap+r*t+t/2).attr("y",this.height).text(n=>n)}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=D({type:e,selectors:[["app-grouped-bar-chart"]],hostAttrs:[1,"block"],inputs:{data:"data",marginTop:"marginTop",marginRight:"marginRight",marginBottom:"marginBottom",marginLeft:"marginLeft",groupGap:"groupGap",barGap:"barGap",tickInnerGap:"tickInnerGap",tickCount:"tickCount"},outputs:{onPointer:"onPointer"},features:[nt],decls:0,vars:0,template:function(i,n){},encapsulation:2})};var up=()=>[];function dp(e,t){if(e&1){let i=St();g(0,"button",7),W("click",function(){let r=ft(i).$index,o=H();return pt(o.onFilter(r))}),T(1,"div",8),g(2,"div",9),k(3),m()()}if(e&2){let i=t.$implicit,n=t.$index,r=H();v(),gt("background",i.REPRESENTATIVE_COLOR),v(),Ne("line-through",r.filterStateList[n]),v(),bt(" ",i.CN_FULL_NAME," ")}}function hp(e,t){e&1&&T(0,"div",10)}function fp(e,t){e&1&&(g(0,"div",6),rt(1,hp,1,0,"div",10,_t),m()),e&2&&(v(),ot(We(0,up).constructor(4)))}function pp(e,t){e&1&&(g(0,"div",12),k(1,"\u66AB\u7121\u8CC7\u6599"),m())}function mp(e,t){if(e&1){let i=St();g(0,"app-grouped-bar-chart",11),W("onPointer",function(r){ft(i);let o=H();return pt(o.toggleTooltip$.next(r))}),m(),Z(1,pp,2,0,"div",12)}if(e&2){let i=H();V("data",i.filteredCounts),v(),q(i.historicalVoteCounts.length===0?1:-1)}}var Hr=class e{isLoaded;activePartyOrder=[];historicalVoteCounts=[];_overlay=w(ei);_overlayPositionBuilder=w(Pi);_destroy=new Y;_overlayRef=null;_tooltipRef=null;toggleTooltip$=new Y;filterStateList=[];originalCounts=[];filteredCounts=[];ngOnChanges(t){let{activePartyOrder:i,historicalVoteCounts:n}=t;if(i){let r=i.currentValue;this.filterStateList=r.map(()=>!1)}n&&(this.originalCounts=n.currentValue,this.filteredCounts=n.currentValue)}ngOnInit(){this.toggleTooltip$.pipe(ct(this._destroy)).subscribe(t=>{t.event.type==="pointerover"?this._showTooltip(t):this._hiddenTooltip(t)})}ngOnDestroy(){this._overlayRef?.dispose(),this._destroy.next(),this._destroy.complete()}_showTooltip(t){let i=t.event.target;if(!document.body.contains(i))return;let n=this._overlayPositionBuilder.flexibleConnectedTo(i).withPush(!1).withPositions([{originX:"center",originY:"top",overlayX:"center",overlayY:"bottom"}]);if(this._overlayRef===null&&(this._overlayRef=this._overlay.create({positionStrategy:n,scrollStrategy:this._overlay.scrollStrategies.reposition(),panelClass:"!pointer-event-none"})),this._tooltipRef===null){let r=new oe(yi);this._tooltipRef=this._overlayRef.attach(r)}this._tooltipRef.instance.title=t.data[0].groupId+"\u5E74\u5F97\u7968\u6578",this._tooltipRef.instance.unit="\u7968",this._tooltipRef.instance.dataList=t.data,this._overlayRef.updatePositionStrategy(n),this._overlayRef.updatePosition()}_hiddenTooltip(t){this._overlayRef&&this._overlayRef.hasAttached()&&(this._overlayRef.detach(),this._tooltipRef=null)}onFilter(t){this.filterStateList[t]=!this.filterStateList[t];let i=this.activePartyOrder.map(n=>n.EN_SHORT_NAME).filter((n,r)=>!this.filterStateList[r]);this.filteredCounts=this.originalCounts.filter(n=>i.includes(n.subgroupId))}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=D({type:e,selectors:[["app-historical-party-vote-counts"]],inputs:{isLoaded:"isLoaded",activePartyOrder:"activePartyOrder",historicalVoteCounts:"historicalVoteCounts"},features:[nt],decls:10,vars:1,consts:[[1,"rounded-xl","border","border-solid","border-gray-300","bg-white"],[1,"flex","items-center","justify-between","px-4","pb-3","pt-6"],[1,"text-xl","font-bold","text-dark"],[1,"flex","items-center","gap-x-1"],["type","button",1,"flex","items-center","gap-x-1"],[1,"relative","h-64","px-4","pb-6","pt-3"],[1,"flex","h-full","flex-col","justify-evenly"],["type","button",1,"flex","items-center","gap-x-1",3,"click"],[1,"h-2","w-2","rounded-full"],[1,"text-xs","leading-5","text-dark"],[1,"cmp-loading","h-8"],[1,"block","h-full",3,"onPointer","data"],[1,"-translate-1/2","absolute","left-1/2","top-1/2","text-base","text-dark"]],template:function(i,n){i&1&&(g(0,"div",0)(1,"div",1)(2,"h5",2),k(3,"\u6B77\u5C46\u653F\u9EE8\u5F97\u7968\u6578"),m(),g(4,"div",3),rt(5,dp,4,5,"button",4,_t),m()(),g(7,"div",5),Z(8,fp,3,1,"div",6)(9,mp,2,2),m()()),i&2&&(v(5),ot(n.activePartyOrder),v(3),q(n.isLoaded?9:8))},dependencies:[Gr],encapsulation:2})};var zr=class e{data=[];marginTop=24;marginRight=0;marginBottom=28;marginLeft=56;groupGap=.2;barGap=.2;tickInnerGap=16;tickCount=4;onPointer=new mt;_elementRef=w(Pt);_commonService=w(Tt);width=124;height=124;svg;chartG;yAxisG;yScale;groups=[];subgroups=[];_destroy=new Y;ngAfterViewInit(){this._initializeChart(),this._commonService.createResizeObservable(this._elementRef.nativeElement).pipe(ct(this._destroy),me(50),pe(0)).subscribe(()=>this._updateChartLayout(this.data))}ngOnChanges(t){if(this.svg){if(t.width||t.height||t.marginTop||t.marginRight||t.marginBottom||t.marginLeft||t.groupGap||t.barGap){let i=t.data?t.data.currentValue:this.data;this._updateChartLayout(i)}t.data&&this._updateChartRender(t.data.currentValue)}}ngOnDestroy(){this._destroy.next(null),this._destroy.complete()}_initializeChart(){this.svg=le(this._elementRef.nativeElement).append("svg"),this.yAxisG=this.svg.append("g"),this.chartG=this.svg.append("g"),this._updateChartLayout(this.data)}_updateChartLayout(t){this.width=this._elementRef.nativeElement.clientWidth,this.height=this._elementRef.nativeElement.clientHeight,this.svg.attr("width",this.width).attr("height",this.height).attr("viewBox",[0,0,this.width,this.height]),this._updateChartRender(t)}_updateChartRender(t){this.groups=Array.from(new Set(t.map(r=>r.groupId))),this.subgroups=Array.from(new Set(t.map(r=>r.subgroupId)));let i=this.width-this.marginLeft-this.tickInnerGap-this.marginRight,n=this.groups.length===0?0:i/this.groups.length;this._updateYAxis(i),this._updateGroupLines(n,t),this._updateLabels(n)}_updateYAxis(t){this.yScale=Ee().domain([0,1]).range([this.height-this.marginBottom,this.marginTop]);let i=Ni(this.yScale).tickValues([0,.2,.4,.6,.8,1]).tickFormat(n=>Number(n)*100+"%").tickPadding(this.marginLeft-this.tickInnerGap).tickSizeInner(0).tickSizeOuter(0);this.yAxisG.attr("transform",`translate(${this.marginLeft+this.tickInnerGap},0)`).call(i).call(n=>n.select(".domain").remove()).call(n=>{n.selectAll(".tick line").attr("x2",t).attr("stroke","#DEE2E6"),n.selectAll(".tick text").attr("class","d3-chart-label")})}_updateGroupLines(t,i){let n=ni(i,p=>p.subgroupId),r=Array.from(new Set(i.map(p=>p.groupId))),o=Ms().domain(r).range([this.marginLeft+this.tickInnerGap+t/2,this.width-this.marginRight-t/2]),s=Ee().domain([0,1]).range([this.height-this.marginBottom,this.marginTop]),a=Hs().x(p=>o(p.groupId)??0).y(p=>s(p.value)),u=this.chartG.selectAll("g.d3-chart-data-group").data(n);u.exit().remove();let l=u.enter().append("g").attr("class","d3-chart-data-group").merge(u),d=l.selectAll("path").data(p=>[p[1]]);d.exit().remove(),d.enter().append("path").merge(d).transition().duration(500).attr("fill","none").attr("stroke",p=>p[0].color).attr("stroke-width",1.5).attr("d",p=>a(p));let h=l.selectAll("circle").data(p=>p[1]);h.exit().remove();let f=h.enter().append("circle");f.merge(h).transition().duration(500).attr("cx",p=>o(p.groupId)??0).attr("cy",p=>s(p.value)).attr("r",3).attr("fill",p=>p.color),h.merge(f).on("pointerover",(p,_)=>{let x=i.filter(C=>C.groupId===_.groupId);this.onPointer.emit({event:p,data:x})}).on("pointerleave",(p,_)=>{let x=i.filter(C=>C.groupId===_.groupId);this.onPointer.emit({event:p,data:x})}),this._updateLabels(t)}_updateLabels(t){let i=this.svg.selectAll("text.d3-chart-x-label").data(this.groups);i.exit().remove(),i.enter().append("text").attr("class","d3-chart-label d3-chart-x-label").merge(i).attr("x",(n,r)=>this.marginLeft+this.tickInnerGap+r*t+t/2).attr("y",this.height).text(n=>n)}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=D({type:e,selectors:[["app-grouped-line-chart"]],hostAttrs:[1,"block"],inputs:{data:"data",marginTop:"marginTop",marginRight:"marginRight",marginBottom:"marginBottom",marginLeft:"marginLeft",groupGap:"groupGap",barGap:"barGap",tickInnerGap:"tickInnerGap",tickCount:"tickCount"},outputs:{onPointer:"onPointer"},features:[nt],decls:0,vars:0,template:function(i,n){},encapsulation:2})};var gp=()=>[];function _p(e,t){if(e&1){let i=St();g(0,"button",7),W("click",function(){let r=ft(i).$index,o=H();return pt(o.onFilter(r))}),T(1,"div",8),g(2,"div",9),k(3),m()()}if(e&2){let i=t.$implicit,n=t.$index,r=H();v(),gt("background",i.REPRESENTATIVE_COLOR),v(),Ne("line-through",r.filterStateList[n]),v(),bt(" ",i.CN_FULL_NAME," ")}}function vp(e,t){e&1&&T(0,"div",10)}function yp(e,t){e&1&&(g(0,"div",6),rt(1,vp,1,0,"div",10,_t),m()),e&2&&(v(),ot(We(0,gp).constructor(4)))}function xp(e,t){e&1&&(g(0,"div",12),k(1,"\u66AB\u7121\u8CC7\u6599"),m())}function bp(e,t){if(e&1){let i=St();g(0,"app-grouped-line-chart",11),W("onPointer",function(r){ft(i);let o=H();return pt(o.toggleTooltip$.next(r))}),m(),Z(1,xp,2,0,"div",12)}if(e&2){let i=H();V("data",i.filteredRates),v(),q(i.historicalVoteRates.length===0?1:-1)}}var Dr=class e{isLoaded;activePartyOrder=[];historicalVoteRates=[];_overlay=w(ei);_overlayPositionBuilder=w(Pi);_destroy=new Y;_overlayRef=null;_tooltipRef=null;toggleTooltip$=new Y;filterStateList=[];originalRates=[];filteredRates=[];ngOnChanges(t){let{activePartyOrder:i,historicalVoteRates:n}=t;if(i){let r=i.currentValue;this.filterStateList=r.map(()=>!1)}n&&(this.originalRates=n.currentValue,this.filteredRates=n.currentValue)}ngOnInit(){this.toggleTooltip$.pipe(ct(this._destroy)).subscribe(t=>{t.event.type==="pointerover"?this._showTooltip(t):this._hiddenTooltip(t)})}ngOnDestroy(){this._overlayRef?.dispose(),this._destroy.next(),this._destroy.complete()}_showTooltip(t){let i=t.event.target;if(!document.body.contains(i))return;let n=this._overlayPositionBuilder.flexibleConnectedTo(i).withPush(!1).withPositions([{originX:"center",originY:"top",overlayX:"center",overlayY:"bottom"}]);if(this._overlayRef===null&&(this._overlayRef=this._overlay.create({positionStrategy:n,scrollStrategy:this._overlay.scrollStrategies.reposition(),panelClass:"!pointer-event-none"})),this._tooltipRef===null){let r=new oe(yi);this._tooltipRef=this._overlayRef.attach(r)}this._tooltipRef.instance.title=t.data[0].groupId+"\u5E74\u5F97\u7968\u7387",this._tooltipRef.instance.unit="%",this._tooltipRef.instance.dataList=t.data,this._overlayRef.updatePositionStrategy(n),this._overlayRef.updatePosition()}_hiddenTooltip(t){this._overlayRef&&this._overlayRef.hasAttached()&&(this._overlayRef.detach(),this._tooltipRef=null)}onFilter(t){this.filterStateList[t]=!this.filterStateList[t];let i=this.activePartyOrder.map(n=>n.EN_SHORT_NAME).filter((n,r)=>!this.filterStateList[r]);this.filteredRates=this.originalRates.filter(n=>i.includes(n.subgroupId))}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=D({type:e,selectors:[["app-historical-party-vote-rates"]],inputs:{isLoaded:"isLoaded",activePartyOrder:"activePartyOrder",historicalVoteRates:"historicalVoteRates"},features:[nt],decls:10,vars:1,consts:[[1,"rounded-xl","border","border-solid","border-gray-300","bg-white"],[1,"flex","items-center","justify-between","px-4","pb-3","pt-6"],[1,"text-xl","font-bold","text-dark"],[1,"flex","items-center","gap-x-1"],["type","button",1,"flex","items-center","gap-x-1"],[1,"relative","h-64","px-4","pb-6","pt-3"],[1,"flex","h-full","flex-col","justify-evenly"],["type","button",1,"flex","items-center","gap-x-1",3,"click"],[1,"h-2","w-2","rounded-full"],[1,"text-xs","leading-5","text-dark"],[1,"cmp-loading","h-8"],[1,"block","h-full",3,"onPointer","data"],[1,"-translate-1/2","absolute","left-1/2","top-1/2","text-base","text-dark"]],template:function(i,n){i&1&&(g(0,"div",0)(1,"div",1)(2,"h5",2),k(3,"\u6B77\u5C46\u653F\u9EE8\u5F97\u7968\u7387"),m(),g(4,"div",3),rt(5,_p,4,5,"button",4,_t),m()(),g(7,"div",5),Z(8,yp,3,1,"div",6)(9,bp,2,2),m()()),i&2&&(v(5),ot(n.activePartyOrder),v(3),q(n.isLoaded?9:8))},dependencies:[zr],encapsulation:2})};var $r=class e{turnoutRate=null;_elementRef=w(Pt);_commonService=w(Tt);_width=124;_height=124;_svg;_g;_background;_foreground;_arc;_tau=2*Math.PI;_destroy=new Y;ngOnChanges(t){let{turnoutRate:i}=t;i&&this._updatePipRender(i.currentValue)}ngAfterViewInit(){this._commonService.createResizeObservable(this._elementRef.nativeElement).pipe(ct(this._destroy),me(50),pe(0)).subscribe(()=>this._updatePipLayout()),this._initializeChart()}ngOnDestroy(){this._destroy.next(null),this._destroy.complete()}_initializeChart(){let i=Math.min(this._height,this._width)/2,n=i-12;this._svg=le(this._elementRef.nativeElement).append("svg"),this._g=this._svg.append("g"),this._arc=Gs().innerRadius(n).outerRadius(i).startAngle(0),this._background=this._g.append("path").datum({endAngle:this._tau}).style("fill","#E2E8F0").attr("d",this._arc),this._foreground=this._g.append("path").datum({endAngle:0*this._tau}).style("fill","#D4009B").attr("d",this._arc),this._updatePipLayout(),this._updatePipRender(this.turnoutRate)}_updatePipLayout(){this._width=this._elementRef.nativeElement.clientWidth,this._height=this._elementRef.nativeElement.clientHeight,this._svg.attr("viewBox",[0,0,this._width,this._height]),this._g.attr("transform","translate("+this._width/2+","+this._height/2+")"),this._background.attr("d",this._arc),this._foreground.attr("d",this._arc)}_updatePipRender(t){this._foreground&&this._foreground.transition().duration(750).attrTween("d",this._arcTween((t||0)/100*this._tau))}_arcTween(t){return i=>{let n=ce(i.endAngle,t);return r=>(i.endAngle=n(r),this._arc(i)||"")}}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=D({type:e,selectors:[["app-pip-chart"]],inputs:{turnoutRate:"turnoutRate"},features:[nt],decls:0,vars:0,template:function(i,n){},encapsulation:2})};var wp=(e,t)=>({"h-2":e,"h-[18px]":t}),Ep=e=>({"bg-gray-200":e});function Cp(e,t){if(e&1&&(k(0),ut(1,"number")),e&2){let i=H().$implicit,n=H();bt(" ",re(1,1,i.voteCount/n.totalVote*100,"1.2-2"),"% ")}}function Ap(e,t){if(e&1&&(g(0,"div",2),Z(1,Cp,2,4),m()),e&2){let i=t.$implicit,n=H();gt("flex-basis",i.voteCount/n.totalVote*100+1,"%")("background",n.POLITICAL_PARTIES[i.party]?n.POLITICAL_PARTIES[i.party].REPRESENTATIVE_COLOR:""),V("ngClass",Dt(6,Ep,!n.POLITICAL_PARTIES[i.party])),v(),q(n.visibleDesc?1:-1)}}var xi=class e{visibleDesc;votePercentage;POLITICAL_PARTIES=It;totalVote=0;ngOnChanges(t){let{votePercentage:i}=t;i&&(this.totalVote=i.currentValue.reduce((n,r)=>n+(r.voteCount||0),0))}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=D({type:e,selectors:[["app-vote-percentage-bar"]],hostAttrs:[1,"block"],inputs:{visibleDesc:"visibleDesc",votePercentage:"votePercentage"},features:[nt],decls:3,vars:4,consts:[[1,"flex","w-full","overflow-hidden","rounded-[500px]",3,"ngClass"],[1,"flex","min-h-full","items-center","justify-center","overflow-hidden","text-sm","leading-[18px]","text-white",3,"ngClass","flex-basis","background"],[1,"flex","min-h-full","items-center","justify-center","overflow-hidden","text-sm","leading-[18px]","text-white",3,"ngClass"]],template:function(i,n){i&1&&(g(0,"div",0),rt(1,Ap,2,8,"div",1,_t),m()),i&2&&(V("ngClass",vn(1,wp,!n.visibleDesc,n.visibleDesc)),v(),ot(n.votePercentage))},dependencies:[xn,ge],encapsulation:2})};var Vu=e=>({"cmp-loading":e}),Ue=e=>({"cmp-loading after:max-w-[90%]":e}),Pp=(e,t,i)=>({"md:justify-start":e,"md:justify-center":t,"md:justify-end":i}),Sp=(e,t)=>({"cmp-loading":e,"bg-gray-200":t});function Op(e,t){if(e&1&&(g(0,"div",27),T(1,"img",28),m()),e&2){let i=t;gt("background",i.REPRESENTATIVE_COLOR),v(),V("src",i.PRESIDENT_3D_IMG,Ei)("alt",i.EN_SHORT_NAME)}}function Np(e,t){e&1&&(mn(),g(0,"svg",25),T(1,"path",29),m())}function kp(e,t){if(e&1&&(g(0,"div",5)(1,"div",18)(2,"div",19),Z(3,Op,2,4,"div",20),m(),g(4,"div",21)(5,"div",22),k(6),m(),g(7,"div",23)(8,"div",24),k(9),m(),Z(10,Np,2,0,":svg:svg",25),m(),g(11,"div",26),k(12),ut(13,"number"),m()()()()),e&2){let i,n=t.$implicit,r=t.$index,o=t.$index,s=H();V("ngClass",ra(12,Pp,r===0,r===1,r===2)),v(2),V("ngClass",vn(16,Sp,!s.isLoaded,s.isLoaded&&!s.electionInfo)),v(),q((i=s.POLITICAL_PARTIES[n.PARTY])?3:-1,i),v(2),V("ngClass",Dt(19,Ue,!s.isLoaded)),v(),bt(" ",s.POLITICAL_PARTIES[n.PARTY]?s.POLITICAL_PARTIES[n.PARTY].CN_FULL_NAME:"\u66AB\u7121\u8CC7\u6599"," "),v(),V("ngClass",Dt(21,Ue,!s.isLoaded)),v(2),lt(n.PRESIDENT||"\u66AB\u7121\u8CC7\u6599"),v(),q(s.electionInfo&&o===0&&s.candidatesVotes[r].VOTE_COUNT?10:-1),v(),V("ngClass",Dt(23,Ue,!s.isLoaded)),v(),bt(" ",$t(13,10,s.candidatesVotes[r].VOTE_COUNT||0),"\u7968 ")}}var Yr=class e{isLoaded;electionInfo;candidateNoOrder=[];POLITICAL_PARTIES=It;candidates;candidatesVotes;totalStatistics;votePercentage=[];ngOnChanges(t){let{electionInfo:i,candidateNoOrder:n}=t;if(i){let r=i.currentValue;this.candidates=r?[...r.CANDIDATES]:Array(3).fill(new Qe),this.candidatesVotes=r?[...r.TOTAL_STATISTICS.CANDIDATES_VOTES]:Array(3).fill(new Je),this.totalStatistics=r?ht({},r.TOTAL_STATISTICS):new ke}if(n){let r=n.currentValue;r.length>0&&(this.candidates=r.map(o=>o-1).reduce((o,s,a)=>(o[a]=this.candidates[s],o),[]),this.candidatesVotes=r.map(o=>o-1).reduce((o,s,a)=>(o[a]=this.candidatesVotes[s],o),[]))}if(i){let r=i.currentValue;this.votePercentage=r?this.candidates.map((o,s)=>({party:o.PARTY||"",voteCount:this.candidatesVotes[s].VOTE_COUNT||0})):[{party:"",voteCount:1}]}}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=D({type:e,selectors:[["app-presidential-votes"]],inputs:{isLoaded:"isLoaded",electionInfo:"electionInfo",candidateNoOrder:"candidateNoOrder"},features:[nt],decls:46,vars:38,consts:[[1,"rounded-xl","bg-gray-200","px-4","pb-4","pt-6"],[1,"mb-4","text-xl","font-bold","text-dark"],[1,"grid","gap-4","xl:grid-flow-col","xl:grid-cols-2","2xl:grid-cols-[3fr_2fr]","3xl:grid-cols-2"],[1,"grid","gap-y-3","rounded-xl","bg-white","px-6","py-4","md:py-8"],[1,"grid","gap-y-2","md:grid-flow-col","md:grid-cols-3"],[1,"flex",3,"ngClass"],[3,"ngClass","votePercentage","visibleDesc"],[1,"rounded-xl","bg-white","px-6","py-4","md:py-8"],[1,"flex","h-full","items-center"],[1,"basis-40","sm:grow","md:basis-32"],[1,"relative","h-[124px]","w-[124px]","overflow-hidden","rounded-full",3,"ngClass"],[1,"absolute","left-0","top-0","flex","h-full","w-full","flex-col","items-center","justify-center","gap-y-1"],[1,"text-sm","text-light"],[1,"ps-1","text-xl","font-bold","text-primary"],[1,"block","h-full","w-full",3,"turnoutRate"],[1,"grid-col-1","grid","grow-[5]","auto-rows-fr","gap-x-2","gap-y-4","sm:grid-cols-2"],[1,"statistic-item",3,"ngClass"],[1,"font-bold","text-dark"],[1,"grid","w-full","basis-[200px]","grid-flow-col","grid-cols-[auto_1fr]","gap-x-3"],[1,"h-12","w-12","overflow-hidden","rounded-2xl",3,"ngClass"],[1,"flex","h-full","w-full","items-center","justify-center",3,"background"],[1,"grid","grid-flow-row","gap-y-[2px]"],[1,"text-sm","text-light",3,"ngClass"],[1,"flex","items-center","justify-start","gap-x-1",3,"ngClass"],[1,"text-dark"],["width","18","height","18","viewBox","0 0 18 18","fill","none","xmlns","http://www.w3.org/2000/svg"],[1,"font-bold","text-dark",3,"ngClass"],[1,"flex","h-full","w-full","items-center","justify-center"],[1,"pointer-events-none","translate-y-[23%]","scale-[135%]",3,"src","alt"],["d","M7.32031 13.1797L14.8203 5.67969L13.6484 4.46875L7.32031 10.7969L4.35156 7.82812L3.17969 9L7.32031 13.1797ZM3.10156 3.14062C4.74219 1.5 6.70833 0.679688 9 0.679688C11.2917 0.679688 13.2448 1.5 14.8594 3.14062C16.5 4.75521 17.3203 6.70833 17.3203 9C17.3203 11.2917 16.5 13.2578 14.8594 14.8984C13.2448 16.513 11.2917 17.3203 9 17.3203C6.70833 17.3203 4.74219 16.513 3.10156 14.8984C1.48698 13.2578 0.679688 11.2917 0.679688 9C0.679688 6.70833 1.48698 4.75521 3.10156 3.14062Z","fill","#D4009B"]],template:function(i,n){i&1&&(g(0,"div",0)(1,"h5",1),k(2,"\u7E3D\u7D71\u5F97\u7968\u6578"),m(),g(3,"div",2)(4,"div",3)(5,"div",4),rt(6,kp,14,25,"div",5,_t),m(),g(8,"div"),T(9,"app-vote-percentage-bar",6),m()(),g(10,"div",7)(11,"div",8)(12,"div",9)(13,"div",10)(14,"div",11)(15,"div",12),k(16,"\u6295\u7968\u7387"),m(),g(17,"div",13),k(18),ut(19,"number"),m()(),T(20,"app-pip-chart",14),m()(),g(21,"div",15)(22,"div",16)(23,"div",12),k(24,"\u6295\u7968\u6578"),m(),g(25,"div",17),k(26),ut(27,"number"),m()(),g(28,"div",16)(29,"div",12),k(30,"\u6295\u7968\u7387"),m(),g(31,"div",17),k(32),ut(33,"number"),m()(),g(34,"div",16)(35,"div",12),k(36,"\u6709\u6548\u7968\u6578"),m(),g(37,"div",17),k(38),ut(39,"number"),m()(),g(40,"div",16)(41,"div",12),k(42,"\u7121\u6548\u7968\u6578"),m(),g(43,"div",17),k(44),ut(45,"number"),m()()()()()()()),i&2&&(v(6),ot(n.candidates),v(3),V("ngClass",Dt(26,Vu,!n.isLoaded))("votePercentage",n.votePercentage)("visibleDesc",!0),v(4),V("ngClass",Dt(28,Vu,!n.isLoaded)),v(5),bt(" ",n.electionInfo?re(19,14,n.totalStatistics.TURNOUT_RATE||0,"1.2-2")+"%":"\u66AB\u7121\u8CC7\u6599"," "),v(2),V("turnoutRate",n.totalStatistics.TURNOUT_RATE),v(2),V("ngClass",Dt(30,Ue,!n.isLoaded)),v(4),lt($t(27,17,n.totalStatistics.TOTAL_VOTES||0)),v(2),V("ngClass",Dt(32,Ue,!n.isLoaded)),v(4),bt("",re(33,19,n.totalStatistics.TURNOUT_RATE||0,"1.2-2"),"%"),v(2),V("ngClass",Dt(34,Ue,!n.isLoaded)),v(4),lt($t(39,22,n.totalStatistics.VALID_VOTES||0)),v(2),V("ngClass",Dt(36,Ue,!n.isLoaded)),v(4),lt($t(45,24,n.totalStatistics.INVALID_VOTES||0)))},dependencies:[xn,ge,xi,$r],styles:[".statistic-item[_ngcontent-%COMP%]{display:grid;grid-template-rows:auto 1fr;row-gap:.25rem}"]})};function Mp(e,t){e&1&&(g(0,"div",10)(1,"div",11),T(2,"img",12),m()())}function Lp(e,t){if(e&1){let i=St();g(0,"tr",2),W("click",function(){let r=ft(i).$implicit,o=H();return pt(o.onItemClick(r.ADMIN_CODE))}),g(1,"td"),k(2),m(),g(3,"td")(4,"div",3)(5,"div",4)(6,"span",5),k(7,"\u7576\u9078\u4EBA"),m(),g(8,"div",6),T(9,"img",7),m(),k(10),m(),T(11,"app-vote-percentage-bar",8),m()(),g(12,"td")(13,"div",9)(14,"div",6),T(15,"img",7),m(),k(16),m()(),g(17,"td"),k(18),ut(19,"number"),m(),g(20,"td"),k(21),ut(22,"number"),m(),g(23,"td"),Z(24,Mp,3,0,"div",10),m()()}if(e&2){let i=t.$implicit;Ne("cursor-pointer",i.ADMIN_CODE),v(2),lt(i.ADMIN_NAME),v(6),gt("background",i.WINNER_COLOR),v(),V("src",i.WINNER_IMG,Ei),v(),bt(" ",i.WINNER_NAME," "),v(),V("votePercentage",i.VOTE_PERCENTAGE)("visibleDesc",!1),v(3),gt("background",i.WINNER_COLOR),v(),V("src",i.WINNER_IMG,Ei),v(),bt(" ",i.WINNER_NAME," "),v(2),lt($t(19,16,i.TOTAL_VOTES)),v(3),bt("",re(22,18,i.TURNOUT_RATE,"1.2-2"),"%"),v(3),q(i.ADMIN_CODE?24:-1)}}var Ur=class e{electionInfo;candidateNoOrder=[];adminChange$=new mt;data=[];ngOnChanges(t){let{electionInfo:i}=t;i&&setTimeout(()=>this._handleTableData(),0)}_handleTableData(){if(!this.electionInfo){this.data=[];return}this.data=this.electionInfo.ADMIN_COLLECTION.map(t=>{let i=this.candidateNoOrder.map(o=>o-1).map(o=>({party:this.electionInfo?.CANDIDATES[o]?.PARTY||"",voteCount:t.CANDIDATES_VOTES[o].VOTE_COUNT||0})),n=t.CANDIDATES_VOTES.reduce((o,s)=>(s.VOTE_COUNT||0)>(o.VOTE_COUNT||0)?s:o).NO,r=this.electionInfo?.CANDIDATES.find(o=>o.NO==n);return{ADMIN_NAME:t.ADMIN_NAME,ADMIN_CODE:t.ADMIN_CODE,VOTE_PERCENTAGE:i,WINNER_NAME:r?.PRESIDENT||"Unknown Winner",WINNER_IMG:r?It[r.PARTY].PRESIDENT_3D_IMG:"",WINNER_COLOR:r?It[r.PARTY].REPRESENTATIVE_COLOR:"",TOTAL_VOTES:t.TOTAL_VOTES,TURNOUT_RATE:t.TURNOUT_RATE}})}onItemClick(t){t&&this.adminChange$.emit(t)}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=D({type:e,selectors:[["app-voting-overview"]],inputs:{electionInfo:"electionInfo",candidateNoOrder:"candidateNoOrder"},outputs:{adminChange$:"adminChange$"},features:[nt],decls:19,vars:0,consts:[[1,"mb-2","mt-4","text-xl","font-bold","text-dark"],[3,"cursor-pointer"],[3,"click"],[1,"grid","gap-y-1"],[1,"flex","items-center","gap-x-2","md:hidden"],[1,"text-light"],[1,"h-8","w-8","overflow-hidden","rounded-full"],["alt","winner_img",1,"pointer-events-none","translate-y-1.5","scale-125",3,"src"],[1,"py-1",3,"votePercentage","visibleDesc"],[1,"flex","items-center","gap-x-1"],[1,"flex","items-center","justify-end"],[1,"flex","h-9","w-9","items-center","justify-center"],["src","images/icons/expand_more.png","alt","expand_more",1,"-rotate-90"]],template:function(i,n){i&1&&(g(0,"h5",0),k(1,"\u5404\u5340\u57DF\u6295\u7968\u7E3D\u89BD"),m(),g(2,"table")(3,"thead")(4,"tr")(5,"th"),k(6,"\u5730\u5340"),m(),g(7,"th"),k(8,"\u5F97\u7968\u7387"),m(),g(9,"th"),k(10,"\u7576\u9078\u4EBA"),m(),g(11,"th"),k(12,"\u6295\u7968\u6578"),m(),g(13,"th"),k(14,"\u6295\u7968\u7387"),m(),T(15,"th"),m()(),g(16,"tbody"),rt(17,Lp,25,21,"tr",1,_t),m()()),i&2&&(v(17),ot(n.data))},dependencies:[ge,xi],styles:["table[_ngcontent-%COMP%]{width:100%;text-wrap:nowrap;text-align:left;font-size:.875rem;line-height:1.25rem;--tw-text-opacity: 1;color:rgb(51 65 85 / var(--tw-text-opacity, 1))}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(233 236 239 / var(--tw-bg-opacity, 1))}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:400}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child{border-top-left-radius:.25rem}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{border-top-right-radius:.25rem}@media (min-width: 768px){thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(1){width:16%}}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(2){width:100%}@media (min-width: 768px){thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(2){width:24%}}@media (min-width: 768px){thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(3){width:8%}}@media (min-width: 768px){thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(4){width:16%}}@media (min-width: 768px){thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(5){width:16%}}@media (min-width: 768px){thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(6){width:20%}}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom-width:1px;border-style:solid;--tw-border-opacity: 1;border-color:rgb(222 226 230 / var(--tw-border-opacity, 1))}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{vertical-align:baseline}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{font-weight:700}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{line-height:2rem}@media (min-width: 768px){tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{vertical-align:middle}}@media (min-width: 768px){tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{line-height:1.25rem}}tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-top:.75rem;padding-bottom:.75rem}@media (min-width: 768px){tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-top:.25rem;padding-bottom:.25rem;padding-inline-end:1.5rem}}[_ngcontent-%COMP%]:is(tr th,tr td):first-child{padding-inline-end:2rem}[_ngcontent-%COMP%]:is(tr th,tr td):first-child{padding-inline-start:.5rem}@media (min-width: 768px){[_ngcontent-%COMP%]:is(tr th,tr td):first-child{padding-inline-end:1.5rem}}:is(tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]):is([_ngcontent-%COMP%]:nth-child(4), [_ngcontent-%COMP%]:nth-child(5)){text-align:right}:is(tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]):is([_ngcontent-%COMP%]:nth-child(3), [_ngcontent-%COMP%]:nth-child(4), [_ngcontent-%COMP%]:nth-child(5)){display:none}@media (min-width: 768px){:is(tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]):is([_ngcontent-%COMP%]:nth-child(3), [_ngcontent-%COMP%]:nth-child(4), [_ngcontent-%COMP%]:nth-child(5)){display:table-cell}}"]})};var jr=class e{static \u0275fac=function(i){return new(i||e)};static \u0275cmp=D({type:e,selectors:[["app-footer"]],decls:1,vars:0,template:function(i,n){i&1&&k(0,"\u7248\u6B0A\u6240\u6709\xA92023 \u53F0\u7063\u6B77\u5E74\u7E3D\u7D71 \u90FD\u5E7E?")},styles:["[_nghost-%COMP%]{display:flex;align-items:center;justify-content:center;--tw-bg-opacity: 1;background-color:rgb(233 236 239 / var(--tw-bg-opacity, 1));padding-top:1rem;padding-bottom:1rem;font-size:.875rem;line-height:1.25rem;--tw-text-opacity: 1;color:rgb(51 65 85 / var(--tw-text-opacity, 1))}"]})};function Rp(e,t){if(e&1&&(g(0,"div",1),T(1,"div",2),ut(2,"async"),m()),e&2){let i=H();v(),gt("width",$t(2,2,i.totalProgress$),"%")}}var Wr=class e{loadingService=w(fa);isLoading$=this.loadingService.isLoading$;totalProgress$=this.loadingService.totalProgress$;static \u0275fac=function(i){return new(i||e)};static \u0275cmp=D({type:e,selectors:[["app-progress-bar"]],decls:3,vars:3,consts:[[1,"relative"],[1,"absolute","z-10","h-2","w-full","bg-gray-300"],[1,"h-full","bg-primary","transition-all"]],template:function(i,n){i&1&&(g(0,"div",0),Z(1,Rp,3,4,"div",1),ut(2,"async"),m()),i&2&&(v(),q($t(2,1,n.isLoading$)?1:-1))},dependencies:[bn],encapsulation:2})};var Ys=(e,t)=>t.value,Fp=()=>["/portal"];function Tp(e,t){if(e&1){let i=St();g(0,"li",26),W("click",function(){let r=ft(i).$implicit,o=H(2);return pt(o.onYearChange(r.value))}),k(1),m()}if(e&2){let i=t.$implicit;v(),bt(" ",i.label," ")}}function Ip(e,t){if(e&1&&(g(0,"ul"),rt(1,Tp,2,1,"li",null,Ys),m()),e&2){let i=H();v(),ot(i.gregorianYearOptions)}}function Vp(e,t){if(e&1){let i=St();g(0,"li",26),W("click",function(){let r=ft(i).$implicit,o=H(2);return pt(o.onRegionChange(r.value))}),k(1),m()}if(e&2){let i=t.$implicit;v(),lt(i.label)}}function Bp(e,t){if(e&1&&(g(0,"ul"),rt(1,Vp,2,1,"li",null,Ys),m()),e&2){let i=H();v(),ot(i.regionOptions)}}function Gp(e,t){if(e&1){let i=St();g(0,"li",26),W("click",function(){let r=ft(i).$implicit,o=H(2);return pt(o.onDistrictChange(r.value))}),k(1),m()}if(e&2){let i=t.$implicit;v(),lt(i.label)}}function Hp(e,t){if(e&1&&(g(0,"ul"),rt(1,Gp,2,1,"li",null,Ys),m()),e&2){let i=H();v(),ot(i.districtOptions)}}var Xr=class e{_destroy=new Y;gregorianYearOptions;gregorianYear;gregorianYearChange=new mt;gregorianYearLabel="";isAdYearSelectOpen=!1;regionOptions;regionCode;regionCodeChange=new mt;regionLabel="";isRegionSelectOpen=!1;districtOptions;districtCode;districtCodeChange=new mt;districtLabel="";isDistrictSelectOpen=!1;ngOnChanges(t){let{regionOptions:i,districtOptions:n}=t;if(i&&Array.isArray(i.currentValue)){let a={label:"\u5168\u90E8\u7E23\u5E02",value:""};!!i.currentValue.find(c=>c.value===a.value)||i.currentValue.unshift(a)}if(n&&Array.isArray(n.currentValue)){let a={label:"\u5168\u90E8\u9109\u93AE\u5E02\u5340",value:""};!!n.currentValue.find(c=>c.value===a.value)||n.currentValue.unshift(a)}let{gregorianYear:r,regionCode:o,districtCode:s}=t;if(r){let a=this.gregorianYearOptions.find(u=>u.value===r.currentValue);a&&(this.gregorianYearLabel=a.label)}if(o){let a=this.regionOptions.find(u=>u.value===o.currentValue);a&&(this.regionLabel=a.label)}if(s){let a=this.districtOptions.find(u=>u.value===s.currentValue);a&&(this.districtLabel=a.label)}}ngOnInit(){un(bi(document,"click"),bi(document,"scroll")).pipe(ct(this._destroy),hn(0)).subscribe(()=>this.closeAllSelects())}ngOnDestroy(){this._destroy.next(),this._destroy.complete()}closeAllSelects(){this.isAdYearSelectOpen=!1,this.isRegionSelectOpen=!1,this.isDistrictSelectOpen=!1}onYearChange(t){this.isAdYearSelectOpen=!this.isAdYearSelectOpen,this.gregorianYearChange.emit(t)}onRegionChange(t){this.isRegionSelectOpen=!this.isRegionSelectOpen,this.regionCodeChange.emit(t)}onDistrictChange(t){this.isDistrictSelectOpen=!this.isDistrictSelectOpen,this.districtCodeChange.emit(t)}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=D({type:e,selectors:[["app-header"]],inputs:{gregorianYearOptions:"gregorianYearOptions",gregorianYear:"gregorianYear",regionOptions:"regionOptions",regionCode:"regionCode",districtOptions:"districtOptions",districtCode:"districtCode"},outputs:{gregorianYearChange:"gregorianYearChange",regionCodeChange:"regionCodeChange",districtCodeChange:"districtCodeChange"},features:[nt],decls:39,vars:11,consts:[[1,"sticky","top-[-48px]","z-50","shadow","xl:top-0"],[1,"border-b-[1px]","border-solid","border-gray-300","bg-white","xl:px-6","xl:py-3"],[1,"flex","flex-col","justify-center","xl:flex-row","xl:items-center","xl:justify-between","xl:gap-x-4"],[1,"flex","items-center","justify-between","px-4","py-2","xl:justify-start","xl:gap-x-6","xl:p-0"],[3,"routerLink"],["src","images/logo.png","alt","logo",1,"h-[28px]","xl:h-[40px]"],[1,"flex","items-center","gap-x-3"],[1,"hidden","text-base","font-bold","text-dark","xl:block"],[1,"cmp-dropdown","w-[118px]"],["type","text","readonly","","placeholder","\u8ACB\u9078\u64C7",3,"click","value"],["src","images/icons/expand_more.png","alt","expand_more"],[1,"px-4","py-2","xl:static","xl:flex","xl:grow","xl:items-center","xl:justify-between","xl:p-0"],[1,"flex","items-center","rounded-full","bg-gray-200"],["src","images/icons/search.png","alt","search",1,"ml-3","hidden","xl:block"],[1,"cmp-dropdown","w-1/2","xl:w-[194px]"],["type","text","readonly","","placeholder","\u9078\u64C7\u7E23\u5E02",3,"click","value"],[1,"h-4","border-s","border-solid","border-gray-400"],["type","text","readonly","","placeholder","\u9078\u64C7\u5340\u57DF",3,"click","value"],[1,"hidden","grow","items-center","justify-end","gap-x-4","xl:flex"],[1,"text-base","font-normal","text-dark"],["href","http://www.facebook.com"],["src","images/icons/facebook-icon.png","alt","facebook-icon",1,"h-6"],["href","http://www.instagram.com"],["src","images/icons/instagram-icon.png","alt","instagram-icon",1,"h-6"],["href","http://www.youtube.com"],["src","images/icons/youtube-icon.png","alt","youtube-icon",1,"h-6"],[3,"click"]],template:function(i,n){i&1&&(g(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"a",4)(5,"h1"),T(6,"img",5),m()(),g(7,"div",6)(8,"div",7),k(9,"\u9078\u64C7\u5E74\u4EFD"),m(),g(10,"div",8)(11,"input",9),W("click",function(o){return o.stopPropagation(),n.closeAllSelects(),n.isAdYearSelectOpen=!0}),m(),g(12,"div"),T(13,"img",10),m(),Z(14,Ip,3,0,"ul"),m()()(),g(15,"div",11)(16,"div",12),T(17,"img",13),g(18,"div",14)(19,"input",15),W("click",function(o){return o.stopPropagation(),n.closeAllSelects(),n.isRegionSelectOpen=!0}),m(),g(20,"div"),T(21,"img",10),m(),Z(22,Bp,3,0,"ul"),m(),T(23,"div",16),g(24,"div",14)(25,"input",17),W("click",function(o){return o.stopPropagation(),n.closeAllSelects(),n.isDistrictSelectOpen=!0}),m(),g(26,"div"),T(27,"img",10),m(),Z(28,Hp,3,0,"ul"),m()(),g(29,"div",18)(30,"div",19),k(31,"\u5206\u4EAB"),m(),g(32,"a",20),T(33,"img",21),m(),g(34,"a",22),T(35,"img",23),m(),g(36,"a",24),T(37,"img",25),m()()()()(),T(38,"app-progress-bar"),m()),i&2&&(v(4),V("routerLink",We(10,Fp)),v(7),V("value",n.gregorianYearLabel),v(2),V("@iconOpenClose",n.isAdYearSelectOpen?"open":"closed"),v(),q(n.isAdYearSelectOpen?14:-1),v(5),V("value",n.regionLabel),v(2),V("@iconOpenClose",n.isRegionSelectOpen?"open":"closed"),v(),q(n.isRegionSelectOpen?22:-1),v(3),V("value",n.districtLabel),v(2),V("@iconOpenClose",n.isDistrictSelectOpen?"open":"closed"),v(),q(n.isDistrictSelectOpen?28:-1))},dependencies:[aa,ha,da,Wr],encapsulation:2,data:{animation:[wn("iconOpenClose",[Ke("open",qe({transform:"rotate(180deg)"})),Ke("closed",qe({transform:"rotate(0deg)"})),Ze("open => closed",[Xe("0.15s")]),Ze("closed => open",[Xe("0.15s")])])]}})};function zp(e,t){if(e&1&&(T(0,"div",24),g(1,"div",25),k(2),m()),e&2){let i=t.$implicit;gt("background",i.REPRESENTATIVE_COLOR),v(2),lt(i.CN_FULL_NAME)}}function Dp(e,t){if(e&1&&(g(0,"div",23),rt(1,zp,3,3,null,null,_t),m()),e&2){let i=H(3);v(),ot(i.activePartyOrder)}}function $p(e,t){if(e&1){let i=St();g(0,"div",19)(1,"button",20),W("click",function(){ft(i);let r=H(2);return pt(r.backToPreviousLevel())}),T(2,"img",21),m(),g(3,"div",22),k(4,"\u8FD4\u56DE"),m()(),Z(5,Dp,3,0,"div",23)}if(e&2){let i=H(2);v(5),q(i.activePartyOrder.length>0?5:-1)}}function Yp(e,t){if(e&1){let i=St();g(0,"div",3)(1,"div",15)(2,"button",16),W("click",function(){ft(i);let r=H();return pt(r.selectMobileMap())}),k(3," \u9032\u5165\u5730\u5716 "),m()(),g(4,"div",17),Z(5,$p,6,1),g(6,"app-zh-tw-map",18),W("regionCodeChange",function(r){ft(i);let o=H();return pt(o.changeRegionCode(r))})("districtCodeChange",function(r){ft(i);let o=H();return pt(o.changeDistrictCode(r))}),m()()()}if(e&2){let i=H();v(5),q(i.adminTitle!==i.adminCentralTitle?5:-1),v(),V("mapColorConfig",i.mapColorConfig)("countyFeatures",i.regionFeatures)("townshipFeatures",i.districtFeatures)("regionCode",i.regionCode)("districtCode",i.districtCode)}}function Up(e,t){if(e&1){let i=St();g(0,"button",20),W("click",function(){ft(i);let r=H();return pt(r.backToPreviousLevel())}),T(1,"img",21),m()}}function jp(e,t){if(e&1&&T(0,"app-breadcrumb",10),e&2){let i=H();V("breadcrumbList",i.breadcrumbList)}}var Bu=class e{_route=w(ua);_apiService=w(ti);_commonService=w(Tt);_dialogService=w(kn);_destroy=new Y;_refetchVoteData$=new Y;adminCentralTitle="\u5168\u81FA\u7E23\u5E02\u7E3D\u7D71\u5F97\u7968";gregorianYearOptions=this._commonService.getYearsSince1996().map(t=>this._commonService.convertOption(t,t));regionOptions=[];districtOptions=[];regionFeatures=[];districtFeatures=[];mapColorConfig={};gregorianYear="";regionCode="";districtCode="";adminTitle=this.adminCentralTitle;breadcrumbList=[];candidateNoOrder=[];activePartyOrder=[];electionInfo;historicalVoteCounts=[];historicalVoteRates=[];isLoaded=!1;ngOnInit(){this._fetchMapGeoJson(),this._refetchVoteData$.pipe(ct(this._destroy),hn(100),to((i,n)=>JSON.stringify(i)===JSON.stringify(n)),eo(i=>this._fetchVotingData(...i))).subscribe(i=>this._renderVotingData(...i));let{beginGregorianYear:t}=this._route.snapshot.queryParams;this.gregorianYear=t||this._commonService.getYearsSince1996().pop(),this._refetchVoteData$.next([this.gregorianYear,this.regionCode,this.districtCode])}ngOnDestroy(){this._destroy.next(),this._destroy.complete()}_fetchMapGeoJson(){this._apiService.fetchCountyGeoJson().subscribe(t=>this.regionFeatures=t),this._apiService.fetchTownshipGeoJson().subscribe(t=>this.districtFeatures=t)}_fetchVotingData(t,i,n){let r=this._commonService.getYearsSince1996().map(o=>n!==""?this._apiService.fetchTownVotesJson(o,n):i!==""?this._apiService.fetchCountyVotesJson(o,i):this._apiService.fetchCentralVotesJson(o)).map(o=>o.pipe(wi(()=>Se(void 0))));return Ks(r).pipe(Mt(o=>[t,i,n,o]))}_renderVotingData(t,i,n,r){return Pe(this,null,function*(){if(this.gregorianYear!==t&&(this.mapColorConfig={},i!=="")){let s=this._apiService.fetchCentralVotesJson(t).pipe(wi(()=>Se(void 0))),a=(yield cn(s))||new Yt;this._updateMapColorConfig(a)}this.regionOptions.length===1&&(this.regionOptions=this.regionFeatures.map(s=>s.properties).map(s=>this._commonService.convertOption(s.COUNTYNAME,s.COUNTYCODE)).sort((s,a)=>s.value.localeCompare(a.value)*-1)||[]),i===""&&(this.districtOptions=[]),i!==""&&n===""&&(this.districtOptions=this.districtFeatures.map(s=>s.properties).filter(s=>s.COUNTYCODE===i).map(s=>this._commonService.convertOption(s.TOWNNAME,s.TOWNCODE)).sort((s,a)=>s.value.localeCompare(a.value)*-1)||[]),this.gregorianYear=t,this.regionCode=i,this.districtCode=n;let o=r.findIndex(s=>s?.ELECTION_GREGORIAN_YEAR===t);if(this.electionInfo=r[o],i==="")this.adminTitle=this.adminCentralTitle,this.breadcrumbList=[];else{let a=this.regionOptions.find(l=>l.value===i)?.label||"Unknown Region Code: "+i,c=this.districtOptions.find(l=>l.value===n)?.label||"Unknown District Code: "+n;this.adminTitle=n===""?a:c,this.breadcrumbList=[this.adminCentralTitle,a],n!==""&&this.breadcrumbList.push(c)}this.candidateNoOrder=[...this.electionInfo?.TOTAL_STATISTICS?.CANDIDATES_VOTES||[]].sort((s,a)=>(a.VOTE_COUNT||0)-(s.VOTE_COUNT||0)).map(s=>s.NO||0),this.activePartyOrder=this.candidateNoOrder.reduce((s,a)=>{let u=this.electionInfo?.CANDIDATES.find(c=>c.NO==a);return u&&s.push(It[u.PARTY]),s},[]),this._calculateHistoricalVotingData(this.activePartyOrder,r),this._updateMapColorConfig(this.electionInfo||new Yt),this._commonService.scrollToTop(),this.isLoaded||(this.isLoaded=!0)})}_updateMapColorConfig(t){let i=t.ADMIN_COLLECTION.map(n=>{let r=n.CANDIDATES_VOTES.reduce((a,u)=>{let c=a.VOTE_COUNT??-1/0;return(u.VOTE_COUNT??-1/0)>c?u:a},n.CANDIDATES_VOTES[0]),o=t.CANDIDATES.findIndex(a=>a.NO==r.NO),s=It[t.CANDIDATES[o].PARTY]?.REPRESENTATIVE_COLOR||"";return{[n.ADMIN_CODE]:s}}).reduce((n,r)=>ht(ht({},n),r),{});this.mapColorConfig=ht(ht({},this.mapColorConfig),i)}_calculateHistoricalVotingData(t,i){let n=[],r=[];if(i.every(o=>o===void 0)||t.length===0){this.historicalVoteCounts=n,this.historicalVoteRates=r;return}this._commonService.getYearsSince1996().map(o=>String(o)).forEach(o=>{if(t.length===0){let l={groupId:o,subgroupId:"",value:0,color:""};n.push(l),r.push(l);return}let s=i.findIndex(l=>l?.ELECTION_GREGORIAN_YEAR===o),a=i[s]||new Yt,u=a.CANDIDATES,c=a.TOTAL_STATISTICS.CANDIDATES_VOTES;t.forEach(l=>{let d={groupId:o,subgroupId:l.EN_SHORT_NAME,value:0,color:l.REPRESENTATIVE_COLOR},h=u.find(x=>x.PARTY===l.EN_SHORT_NAME),f=c.find(x=>x.NO==h?.NO);d.value=f?.VOTE_COUNT||0,n.push(d);let p={groupId:o,subgroupId:l.EN_SHORT_NAME,value:0,color:l.REPRESENTATIVE_COLOR},_=a.TOTAL_STATISTICS.TOTAL_VOTES||0;p.value=_?d.value/_:0,r.push(p)})}),this.historicalVoteCounts=n,this.historicalVoteRates=r}changeGregorianYear(t){this._refetchVoteData$.next([t,this.regionCode,this.districtCode])}changeRegionCode(t){this._refetchVoteData$.next([this.gregorianYear,t,""])}changeDistrictCode(t){this._refetchVoteData$.next([this.gregorianYear,this.regionCode,t])}changeAdminCodeWithSubAdmin(t){this.regionCode===""?this.changeRegionCode(t):this.districtCode===""&&this.changeDistrictCode(t)}selectMobileMap(){let t={regionFeatures:this.regionFeatures,districtFeatures:this.districtFeatures,mapColorConfig:this.mapColorConfig,gregorianYear:this.gregorianYear},i={lockBackdrop:!0,lockScroll:!0};this._dialogService.open(Br,t,i).afterClosed().pipe(Mt(n=>n)).subscribe(n=>{if(!n)return;let{regionCode:r,districtCode:o}=n;this._refetchVoteData$.next([this.gregorianYear,r,o])})}backToPreviousLevel(){if(this.districtCode!==""){this.changeDistrictCode("");return}if(this.regionCode!==""){this.changeRegionCode("");return}}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=D({type:e,selectors:[["app-historical-review"]],decls:19,vars:21,consts:[[3,"gregorianYearChange","regionCodeChange","districtCodeChange","gregorianYearOptions","gregorianYear","regionOptions","regionCode","districtOptions","districtCode"],[1,"grid","grid-cols-1","2xl:grid-cols-[500px,1fr]"],[1,"relative","bg-[#E4FAFF]"],[1,"top:auto","static","h-[148px]","2xl:sticky","2xl:top-[65px]","2xl:h-[calc(100dvh-65px)]"],[1,"flex","flex-col","justify-between"],[1,"grid","auto-rows-min","grid-cols-1","gap-6","px-4","py-8","2xl:grid-cols-2","2xl:px-12"],[1,"grid","gap-y-3","2xl:col-span-2"],[1,"flex","items-center","gap-x-3"],["type","button",1,"flex","h-9","w-9","items-center","justify-center","rounded-full","bg-gray-200"],[1,"text-2xl","font-bold","text-dark","2xl:text-3xl"],[3,"breadcrumbList"],[3,"isLoaded","electionInfo","candidateNoOrder"],[3,"isLoaded","activePartyOrder","historicalVoteCounts"],[3,"isLoaded","activePartyOrder","historicalVoteRates"],[1,"2xl:col-span-2",3,"adminChange$","electionInfo","candidateNoOrder"],[1,"absolute","flex","size-full","items-center","justify-center","bg-[#49505799]","2xl:hidden"],["type","button",1,"rounded-md","bg-primary","px-4","py-2","text-sm","text-white",3,"click"],[1,"pointer-events-none","size-full","2xl:pointer-events-auto"],[1,"block","size-full",3,"regionCodeChange","districtCodeChange","mapColorConfig","countyFeatures","townshipFeatures","regionCode","districtCode"],[1,"absolute","left-6","top-6","z-10","hidden","items-center","rounded-[500px]","bg-white","p-1","2xl:flex"],["type","button",1,"flex","h-9","w-9","items-center","justify-center","rounded-full","bg-gray-200",3,"click"],["src","images/icons/arrow_back.png","alt","arrow_back",1,"pointer-events-none","h-5","w-5"],[1,"mx-2","text-base","font-bold","text-dark"],[1,"absolute","bottom-4","left-4","z-10","hidden","items-center","gap-x-1","rounded-[500px]","bg-white","px-2","2xl:flex"],[1,"h-2","w-2","rounded-full"],[1,"text-xs","leading-5","text-dark"]],template:function(i,n){i&1&&(g(0,"app-header",0),W("gregorianYearChange",function(o){return n.changeGregorianYear(o)})("regionCodeChange",function(o){return n.changeRegionCode(o)})("districtCodeChange",function(o){return n.changeDistrictCode(o)}),m(),g(1,"div",1)(2,"div",2),Z(3,Yp,7,6,"div",3),m(),g(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7),Z(8,Up,2,0,"button",8),g(9,"h2",9),k(10),m()(),g(11,"div"),Z(12,jp,1,1,"app-breadcrumb",10),m(),T(13,"app-presidential-votes",11),m(),T(14,"app-historical-party-vote-counts",12)(15,"app-historical-party-vote-rates",13),g(16,"app-voting-overview",14),W("adminChange$",function(o){return n.changeAdminCodeWithSubAdmin(o)}),m()(),T(17,"app-footer"),m()(),T(18,"app-to-top-button")),i&2&&(V("gregorianYearOptions",n.gregorianYearOptions)("gregorianYear",n.gregorianYear)("regionOptions",n.regionOptions)("regionCode",n.regionCode)("districtOptions",n.districtOptions)("districtCode",n.districtCode),v(3),q(n.regionFeatures.length!==0&&n.districtFeatures.length!==0?3:-1),v(5),q(n.adminTitle!==n.adminCentralTitle?8:-1),v(2),lt(n.adminTitle),v(2),q(n.breadcrumbList.length>1?12:-1),v(),V("isLoaded",n.isLoaded)("electionInfo",n.electionInfo)("candidateNoOrder",n.candidateNoOrder),v(),V("isLoaded",n.isLoaded)("activePartyOrder",n.activePartyOrder)("historicalVoteCounts",n.historicalVoteCounts),v(),V("isLoaded",n.isLoaded)("activePartyOrder",n.activePartyOrder)("historicalVoteRates",n.historicalVoteRates),v(),V("electionInfo",n.electionInfo)("candidateNoOrder",n.candidateNoOrder))},dependencies:[Xr,vi,Mn,Yr,Hr,Dr,Ur,jr,Ln],encapsulation:2})};export{Bu as HistoricalReviewComponent};
