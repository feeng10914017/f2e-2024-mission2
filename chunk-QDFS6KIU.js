import{a as ea}from"./chunk-R6QM66A5.js";import{c as Wn,d as Ge,f as Fe,g as $e,h as Be}from"./chunk-ZSSD5RUB.js";import{b as Zo,i as Io,k as Do,m as ta,n as Nt}from"./chunk-DEUMQ5O3.js";import{$a as B,A as rn,B as Yo,D as xi,F as zn,Fa as on,Ia as w,J as oe,K as qo,Mb as Yn,Ob as qn,Pb as ke,Q as vi,Qa as q,Qb as Qo,S as Wo,T as $t,U as _i,Ua as Q,V as ae,X as Xo,a as xe,aa as yi,ab as Ct,ba as D,bb as Jo,cb as K,d as nn,db as At,e as Uo,eb as rt,fb as it,gb as x,hb as h,ia as dt,ib as H,ja as wt,jb as St,k as Lt,ka as bt,kb as tt,la as jo,lb as z,mb as C,nb as et,o as gi,ob as Vt,pb as Ve,qb as Bt,ra as Ot,rb as Tn,s as zo,sb as Ko,t as yt,tb as lt,ub as Ht,va as se,vb as ve,z as To}from"./chunk-EHXI66MR.js";var qt={KMT:{EMBLEM:"https://upload.wikimedia.org/wikipedia/commons/a/a1/Emblem_of_the_Kuomintang.svg",CN_FULL_NAME:"\u4E2D\u570B\u570B\u6C11\u9EE8",CN_SHORT_NAME:"\u570B\u6C11\u9EE8",EN_FULL_NAME:"Kuomintang Chinese Nationalist Party",EN_SHORT_NAME:"KMT",PRESIDENT_3D_IMG:"images/3d-president/man-vampire.png",REPRESENTATIVE_COLOR:"#8082FF"},DPP:{EMBLEM:"https://upload.wikimedia.org/wikipedia/zh/c/c1/Emblem_of_Democratic_Progressive_Party_%28new%29.svg",CN_FULL_NAME:"\u6C11\u4E3B\u9032\u6B65\u9EE8",CN_SHORT_NAME:"\u6C11\u9032\u9EE8",EN_FULL_NAME:"Democratic Progressive Party",EN_SHORT_NAME:"DPP",PRESIDENT_3D_IMG:"images/3d-president/troll.png",REPRESENTATIVE_COLOR:"#57D2A9"},TPP:{EMBLEM:"https://upload.wikimedia.org/wikipedia/commons/0/0c/Emblem_of_Taiwan_People%27s_Party_2019.svg",CN_FULL_NAME:"\u53F0\u7063\u6C11\u773E\u9EE8",CN_SHORT_NAME:"\u6C11\u773E\u9EE8",EN_FULL_NAME:"Taiwan People's Party",EN_SHORT_NAME:"TPP",PRESIDENT_3D_IMG:"images/3d-president/man_in_steamy_room.png",REPRESENTATIVE_COLOR:"#77DBEE"},PFP:{EMBLEM:"https://upload.wikimedia.org/wikipedia/zh/6/65/Flag_of_People_First_Party.png",CN_FULL_NAME:"\u89AA\u6C11\u9EE8",CN_SHORT_NAME:"\u89AA\u6C11\u9EE8",EN_FULL_NAME:"People First Party",EN_SHORT_NAME:"PFP",PRESIDENT_3D_IMG:"images/3d-president/man-elf.png",REPRESENTATIVE_COLOR:"#F4A76F"},NP:{EMBLEM:"https://upload.wikimedia.org/wikipedia/commons/0/01/Np_logo.svg",CN_FULL_NAME:"\u65B0\u9EE8",CN_SHORT_NAME:"\u65B0\u9EE8",EN_FULL_NAME:"New Party",EN_SHORT_NAME:"NP",PRESIDENT_3D_IMG:"images/3d-president/person-mage.png",REPRESENTATIVE_COLOR:"#F9DA4A"},PETITION:{EMBLEM:"",CN_FULL_NAME:"\u9023\u7F72",CN_SHORT_NAME:"",EN_FULL_NAME:"Petition",EN_SHORT_NAME:"PETITION",PRESIDENT_3D_IMG:"images/3d-president/man-genie.png",REPRESENTATIVE_COLOR:"#CED4DA"},EMPTY:{EMBLEM:"",CN_FULL_NAME:"\u7121\u9EE8\u7C4D\u53CA\u672A\u7D93\u653F\u9EE8\u63A8\u85A6",CN_SHORT_NAME:"",EN_FULL_NAME:"Empty",EN_SHORT_NAME:"EMPTY",PRESIDENT_3D_IMG:"images/3d-president/woman-zombie.png",REPRESENTATIVE_COLOR:"#CED4DA"}};var He=class{NO;VOTE_COUNT;constructor(e){this.NO=Number.isNaN(parseInt(e?.NO))?null:e.NO,this.VOTE_COUNT=Number.isNaN(parseInt(e?.VOTE_COUNT))?null:e.VOTE_COUNT}};var Xn=class{CANDIDATES_VOTES;VALID_VOTES;INVALID_VOTES;TOTAL_VOTES;UNRETURNED_BALLOTS;TOTAL_ISSUED_BALLOTS;UNUSED_BALLOTS;ELIGIBLE_VOTERS;TURNOUT_RATE;constructor(e){this.CANDIDATES_VOTES=Array.isArray(e?.CANDIDATES_VOTES)?e.CANDIDATES_VOTES.map(n=>new He(n)):[],this.VALID_VOTES=Number.isNaN(parseInt(e?.VALID_VOTES))?null:e.VALID_VOTES,this.INVALID_VOTES=Number.isNaN(parseInt(e?.INVALID_VOTES))?null:e.INVALID_VOTES,this.TOTAL_VOTES=Number.isNaN(parseInt(e?.TOTAL_VOTES))?null:e.TOTAL_VOTES,this.UNRETURNED_BALLOTS=Number.isNaN(parseInt(e?.UNRETURNED_BALLOTS))?null:e.UNRETURNED_BALLOTS,this.TOTAL_ISSUED_BALLOTS=Number.isNaN(parseInt(e?.TOTAL_ISSUED_BALLOTS))?null:e.TOTAL_ISSUED_BALLOTS,this.UNUSED_BALLOTS=Number.isNaN(parseInt(e?.UNUSED_BALLOTS))?null:e.UNUSED_BALLOTS,this.ELIGIBLE_VOTERS=Number.isNaN(parseInt(e?.ELIGIBLE_VOTERS))?null:e.ELIGIBLE_VOTERS,this.TURNOUT_RATE=Number.isNaN(parseInt(e?.TURNOUT_RATE))?null:e.TURNOUT_RATE}};var _e=class extends Xn{ADMIN_LEVEL;ADMIN_NAME;ADMIN_CODE;constructor(e){super(e),this.ADMIN_LEVEL=e?.ADMIN_LEVEL||"\u672A\u77E5",this.ADMIN_NAME=e?.ADMIN_NAME||"",this.ADMIN_CODE=e?.ADMIN_CODE||""}};var Re=class{NO;PARTY;PRESIDENT;VICE_PRESIDENT;constructor(e){this.NO=Number.isNaN(parseInt(e?.NO))?null:e.NO,this.PARTY=e?.PARTY||"",this.PRESIDENT=e?.PRESIDENT||"",this.VICE_PRESIDENT=e?.VICE_PRESIDENT||""}};var Wt=class{ELECTION_TITLE;ELECTION_TERM;ELECTION_GREGORIAN_YEAR;CANDIDATES;TOTAL_STATISTICS;ADMIN_COLLECTION;constructor(e){this.ELECTION_TITLE=e?.ELECTION_TITLE||"",this.ELECTION_TERM=Number.isNaN(parseInt(e?.ELECTION_TERM))?null:e.ELECTION_TERM,this.ELECTION_GREGORIAN_YEAR=e?.ELECTION_GREGORIAN_YEAR||"",this.CANDIDATES=Array.isArray(e?.CANDIDATES)?e.CANDIDATES.map(n=>new Re(n)):[],this.TOTAL_STATISTICS=new _e(e?.TOTAL_STATISTICS),this.ADMIN_COLLECTION=Array.isArray(e?.ADMIN_COLLECTION)?e.ADMIN_COLLECTION.map(n=>new _e(n)):[]}};var an=class{COUNTYCODE;COUNTYENG;COUNTYID;COUNTYNAME;NOTE;TOWNCODE;TOWNID;TOWNNAME;VILLCODE;VILLENG;VILLNAME;constructor(e){this.COUNTYCODE=e.COUNTYCODE||"",this.COUNTYENG=e.COUNTYENG||"",this.COUNTYID=e.COUNTYID||"",this.COUNTYNAME=e.COUNTYNAME||"",this.NOTE=e.NOTE||"",this.TOWNCODE=e.TOWNCODE||"",this.TOWNID=e.TOWNID||"",this.TOWNNAME=e.TOWNNAME||"",this.VILLCODE=e.VILLCODE||"",this.VILLENG=e.VILLENG||"",this.VILLNAME=e.VILLNAME||""}};var jn=class t{constructor(e,n){this.http=e;this.commonService=n}fetchCountyGeoJson(){let e="COUNTY_MOI_1130718",n="map-topo-json/"+e+".json";return this.http.get(n).pipe(yt(r=>r),yt(r=>this.commonService.convertTopoToFeatures(r,e)),yt(r=>r.features),_i(r=>r.forEach(i=>i.properties=new an(i.properties))),vi(1))}fetchTownshipGeoJson(){let e="TOWN_MOI_1130718",n="map-topo-json/"+e+".json";return this.http.get(n).pipe(yt(r=>r),yt(r=>this.commonService.convertTopoToFeatures(r,e)),yt(r=>r.features),_i(r=>r.forEach(i=>i.properties=new an(i.properties))),vi(1))}fetchCentralVotesJson(e){let n=`presidential-election-json/${e}/CENTRAL.json`;return this.http.get(n).pipe(yt(r=>new Wt(r)))}fetchCountyVotesJson(e,n){let r=`presidential-election-json/${e}/COUNTY_${n}.json`;return this.http.get(r).pipe(yt(i=>new Wt(i)))}fetchTownVotesJson(e,n){let r=`presidential-election-json/${e}/TOWN_${n}.json`;return this.http.get(r).pipe(yt(i=>new Wt(i)))}static \u0275fac=function(n){return new(n||t)(yi(Zo),yi(Nt))};static \u0275prov=Xo({token:t,factory:t.\u0275fac,providedIn:"root"})};function uu(t,e){t&1&&(x(0,"span"),C(1,"/"),h())}function cu(t,e){if(t&1&&(x(0,"span"),C(1),h()),t&2){let n=z().$implicit;w(),et(n)}}function fu(t,e){if(t&1&&(x(0,"span",1),C(1),h()),t&2){let n=z().$implicit;w(),et(n)}}function pu(t,e){if(t&1&&Q(0,uu,2,0,"span")(1,cu,2,1,"span")(2,fu,2,1,"span",1),t&2){let n=e.$index,r=e.$count;K(n!==0?0:-1),w(),K(n!==r-1?1:2)}}var Jn=class t{breadcrumbList;static \u0275fac=function(n){return new(n||t)};static \u0275cmp=q({type:t,selectors:[["app-breadcrumb"]],inputs:{breadcrumbList:"breadcrumbList"},decls:3,vars:0,consts:[[1,"flex","h-full","items-center","gap-x-2","text-base","leading-4","text-light"],[1,"text-primary"]],template:function(n,r){n&1&&(x(0,"div",0),rt(1,pu,3,2,null,null,At),h()),n&2&&(w(),it(r.breadcrumbList))},styles:["span[_ngcontent-%COMP%]{cursor:default}"]})};var Kn=class t{commonService=D(Nt);toTopBtnVisible$=rn(window,"scroll").pipe(yt(()=>document.documentElement.scrollTop>50));static \u0275fac=function(n){return new(n||t)};static \u0275cmp=q({type:t,selectors:[["app-to-top-button"]],decls:4,vars:3,consts:[[1,"fixed","bottom-6","right-6","opacity-0"],["type","button",1,"flex","h-11","w-11","items-center","justify-center","rounded-full","border","border-solid","border-primary","bg-white",3,"click"],["src","images/icons/arrow_upward.png","alt","arrow_upward",1,"pointer-events-none","h-5","w-5"]],template:function(n,r){n&1&&(x(0,"div",0),lt(1,"async"),x(2,"button",1),tt("click",function(){return r.commonService.scrollToTop()}),H(3,"img",2),h()()),n&2&&B("@opacityVisibleHidden",Ht(1,1,r.toTopBtnVisible$)?"visible":"hidden")},dependencies:[qn],encapsulation:2,data:{animation:[Wn("opacityVisibleHidden",[$e("visible",Fe({opacity:"1"})),$e("hidden",Fe({opacity:"0"})),Be("visible => hidden",[Ge("0.2s")]),Be("hidden => visible",[Ge("0.2s")])])]}})};function ye(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function wi(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Qn(t){let e,n,r;t.length!==2?(e=ye,n=(s,c)=>ye(t(s),c),r=(s,c)=>t(s)-c):(e=t===ye||t===wi?t:du,n=t,r=t);function i(s,c,l=0,u=s.length){if(l<u){if(e(c,c)!==0)return u;do{let p=l+u>>>1;n(s[p],c)<0?l=p+1:u=p}while(l<u)}return l}function o(s,c,l=0,u=s.length){if(l<u){if(e(c,c)!==0)return u;do{let p=l+u>>>1;n(s[p],c)<=0?l=p+1:u=p}while(l<u)}return l}function a(s,c,l=0,u=s.length){let p=i(s,c,l,u-1);return p>l&&r(s[p-1],c)>-r(s[p],c)?p-1:p}return{left:i,center:a,right:o}}function du(){return 0}function bi(t){return t===null?NaN:+t}var na=Qn(ye),ra=na.right,mu=na.left,hu=Qn(bi).center,Ai=ra;var kt=class{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){let n=this._partials,r=0;for(let i=0;i<this._n&&i<32;i++){let o=n[i],a=e+o,s=Math.abs(e)<Math.abs(o)?e-(a-o):o-(a-e);s&&(n[r++]=s),e=a}return n[r]=e,this._n=r+1,this}valueOf(){let e=this._partials,n=this._n,r,i,o,a=0;if(n>0){for(a=e[--n];n>0&&(r=a,i=e[--n],a=r+i,o=i-(a-r),!o););n>0&&(o<0&&e[n-1]<0||o>0&&e[n-1]>0)&&(i=o*2,r=a+i,i==r-a&&(a=r))}return a}};var le=class extends Map{constructor(e,n=vu){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(let[r,i]of e)this.set(r,i)}get(e){return super.get(ia(this,e))}has(e){return super.has(ia(this,e))}set(e,n){return super.set(gu(this,e),n)}delete(e){return super.delete(xu(this,e))}};function ia({_intern:t,_key:e},n){let r=e(n);return t.has(r)?t.get(r):n}function gu({_intern:t,_key:e},n){let r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function xu({_intern:t,_key:e},n){let r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function vu(t){return t!==null&&typeof t=="object"?t.valueOf():t}function Zn(t){return t}function Ue(t,...e){return _u(t,Zn,Zn,e)}function _u(t,e,n,r){return function i(o,a){if(a>=r.length)return n(o);let s=new le,c=r[a++],l=-1;for(let u of o){let p=c(u,++l,o),f=s.get(p);f?f.push(u):s.set(p,[u])}for(let[u,p]of s)s.set(u,i(p,a));return e(s)}(t,0)}var yu=Math.sqrt(50),wu=Math.sqrt(10),bu=Math.sqrt(2);function In(t,e,n){let r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=yu?10:o>=wu?5:o>=bu?2:1,s,c,l;return i<0?(l=Math.pow(10,-i)/a,s=Math.round(t*l),c=Math.round(e*l),s/l<t&&++s,c/l>e&&--c,l=-l):(l=Math.pow(10,i)*a,s=Math.round(t/l),c=Math.round(e/l),s*l<t&&++s,c*l>e&&--c),c<s&&.5<=n&&n<2?In(t,e,n*2):[s,c,l]}function ze(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];let r=e<t,[i,o,a]=r?In(e,t,n):In(t,e,n);if(!(o>=i))return[];let s=o-i+1,c=new Array(s);if(r)if(a<0)for(let l=0;l<s;++l)c[l]=(o-l)/-a;else for(let l=0;l<s;++l)c[l]=(o-l)*a;else if(a<0)for(let l=0;l<s;++l)c[l]=(i+l)/-a;else for(let l=0;l<s;++l)c[l]=(i+l)*a;return c}function sn(t,e,n){return e=+e,t=+t,n=+n,In(t,e,n)[2]}function Ni(t,e,n){e=+e,t=+t,n=+n;let r=e<t,i=r?sn(e,t,n):sn(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function Dn(t,e){let n;if(e===void 0)for(let r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function*Au(t){for(let e of t)yield*Uo(e)}function Te(t){return Array.from(Au(t))}function tr(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,o=new Array(i);++r<i;)o[r]=t+r*n;return o}function oa(t){return t}var Ei=1,Pi=2,aa=3,ln=4,sa=1e-6;function Nu(t){return"translate("+t+",0)"}function Eu(t){return"translate(0,"+t+")"}function Pu(t){return e=>+t(e)}function Mu(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function Lu(){return!this.__axis}function Ou(t,e){var n=[],r=null,i=null,o=6,a=6,s=3,c=typeof window<"u"&&window.devicePixelRatio>1?0:.5,l=t===Ei||t===ln?-1:1,u=t===ln||t===Pi?"x":"y",p=t===Ei||t===aa?Nu:Eu;function f(d){var m=r??(e.ticks?e.ticks.apply(e,n):e.domain()),_=i??(e.tickFormat?e.tickFormat.apply(e,n):oa),y=Math.max(o,0)+s,A=e.range(),E=+A[0]+c,P=+A[A.length-1]+c,N=(e.bandwidth?Mu:Pu)(e.copy(),c),M=d.selection?d.selection():d,O=M.selectAll(".domain").data([null]),S=M.selectAll(".tick").data(m,e).order(),V=S.exit(),k=S.enter().append("g").attr("class","tick"),F=S.select("line"),v=S.select("text");O=O.merge(O.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),S=S.merge(k),F=F.merge(k.append("line").attr("stroke","currentColor").attr(u+"2",l*o)),v=v.merge(k.append("text").attr("fill","currentColor").attr(u,l*y).attr("dy",t===Ei?"0em":t===aa?"0.71em":"0.32em")),d!==M&&(O=O.transition(d),S=S.transition(d),F=F.transition(d),v=v.transition(d),V=V.transition(d).attr("opacity",sa).attr("transform",function($){return isFinite($=N($))?p($+c):this.getAttribute("transform")}),k.attr("opacity",sa).attr("transform",function($){var b=this.parentNode.__axis;return p((b&&isFinite(b=b($))?b:N($))+c)})),V.remove(),O.attr("d",t===ln||t===Pi?a?"M"+l*a+","+E+"H"+c+"V"+P+"H"+l*a:"M"+c+","+E+"V"+P:a?"M"+E+","+l*a+"V"+c+"H"+P+"V"+l*a:"M"+E+","+c+"H"+P),S.attr("opacity",1).attr("transform",function($){return p(N($)+c)}),F.attr(u+"2",l*o),v.attr(u,l*y).text(_),M.filter(Lu).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===Pi?"start":t===ln?"end":"middle"),M.each(function(){this.__axis=N})}return f.scale=function(d){return arguments.length?(e=d,f):e},f.ticks=function(){return n=Array.from(arguments),f},f.tickArguments=function(d){return arguments.length?(n=d==null?[]:Array.from(d),f):n.slice()},f.tickValues=function(d){return arguments.length?(r=d==null?null:Array.from(d),f):r&&r.slice()},f.tickFormat=function(d){return arguments.length?(i=d,f):i},f.tickSize=function(d){return arguments.length?(o=a=+d,f):o},f.tickSizeInner=function(d){return arguments.length?(o=+d,f):o},f.tickSizeOuter=function(d){return arguments.length?(a=+d,f):a},f.tickPadding=function(d){return arguments.length?(s=+d,f):s},f.offset=function(d){return arguments.length?(c=+d,f):c},f}function un(t){return Ou(ln,t)}var Cu={value:()=>{}};function ua(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new er(n)}function er(t){this._=t}function Su(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}er.prototype=ua.prototype={constructor:er,on:function(t,e){var n=this._,r=Su(t+"",n),i,o=-1,a=r.length;if(arguments.length<2){for(;++o<a;)if((i=(t=r[o]).type)&&(i=Vu(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<a;)if(i=(t=r[o]).type)n[i]=la(n[i],t.name,e);else if(e==null)for(i in n)n[i]=la(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new er(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],r=0,i=o.length;r<i;++r)o[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};function Vu(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function la(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=Cu,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var Mi=ua;var nr="http://www.w3.org/1999/xhtml",Li={svg:"http://www.w3.org/2000/svg",xhtml:nr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Zt(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Li.hasOwnProperty(e)?{space:Li[e],local:t}:t}function ku(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===nr&&e.documentElement.namespaceURI===nr?e.createElement(t):e.createElementNS(n,t)}}function Gu(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function rr(t){var e=Zt(t);return(e.local?Gu:ku)(e)}function Fu(){}function we(t){return t==null?Fu:function(){return this.querySelector(t)}}function ca(t){typeof t!="function"&&(t=we(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],a=o.length,s=r[i]=new Array(a),c,l,u=0;u<a;++u)(c=o[u])&&(l=t.call(c,c.__data__,u,o))&&("__data__"in c&&(l.__data__=c.__data__),s[u]=l);return new I(r,this._parents)}function Oi(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function $u(){return[]}function cn(t){return t==null?$u:function(){return this.querySelectorAll(t)}}function Bu(t){return function(){return Oi(t.apply(this,arguments))}}function fa(t){typeof t=="function"?t=Bu(t):t=cn(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var a=e[o],s=a.length,c,l=0;l<s;++l)(c=a[l])&&(r.push(t.call(c,c.__data__,l,a)),i.push(c));return new I(r,i)}function fn(t){return function(){return this.matches(t)}}function ir(t){return function(e){return e.matches(t)}}var Hu=Array.prototype.find;function Ru(t){return function(){return Hu.call(this.children,t)}}function Uu(){return this.firstElementChild}function pa(t){return this.select(t==null?Uu:Ru(typeof t=="function"?t:ir(t)))}var zu=Array.prototype.filter;function Tu(){return Array.from(this.children)}function Yu(t){return function(){return zu.call(this.children,t)}}function da(t){return this.selectAll(t==null?Tu:Yu(typeof t=="function"?t:ir(t)))}function ma(t){typeof t!="function"&&(t=fn(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],a=o.length,s=r[i]=[],c,l=0;l<a;++l)(c=o[l])&&t.call(c,c.__data__,l,o)&&s.push(c);return new I(r,this._parents)}function or(t){return new Array(t.length)}function ha(){return new I(this._enter||this._groups.map(or),this._parents)}function pn(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}pn.prototype={constructor:pn,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function ga(t){return function(){return t}}function qu(t,e,n,r,i,o){for(var a=0,s,c=e.length,l=o.length;a<l;++a)(s=e[a])?(s.__data__=o[a],r[a]=s):n[a]=new pn(t,o[a]);for(;a<c;++a)(s=e[a])&&(i[a]=s)}function Wu(t,e,n,r,i,o,a){var s,c,l=new Map,u=e.length,p=o.length,f=new Array(u),d;for(s=0;s<u;++s)(c=e[s])&&(f[s]=d=a.call(c,c.__data__,s,e)+"",l.has(d)?i[s]=c:l.set(d,c));for(s=0;s<p;++s)d=a.call(t,o[s],s,o)+"",(c=l.get(d))?(r[s]=c,c.__data__=o[s],l.delete(d)):n[s]=new pn(t,o[s]);for(s=0;s<u;++s)(c=e[s])&&l.get(f[s])===c&&(i[s]=c)}function Xu(t){return t.__data__}function xa(t,e){if(!arguments.length)return Array.from(this,Xu);var n=e?Wu:qu,r=this._parents,i=this._groups;typeof t!="function"&&(t=ga(t));for(var o=i.length,a=new Array(o),s=new Array(o),c=new Array(o),l=0;l<o;++l){var u=r[l],p=i[l],f=p.length,d=ju(t.call(u,u&&u.__data__,l,r)),m=d.length,_=s[l]=new Array(m),y=a[l]=new Array(m),A=c[l]=new Array(f);n(u,p,_,y,A,d,e);for(var E=0,P=0,N,M;E<m;++E)if(N=_[E]){for(E>=P&&(P=E+1);!(M=y[P])&&++P<m;);N._next=M||null}}return a=new I(a,r),a._enter=s,a._exit=c,a}function ju(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function va(){return new I(this._exit||this._groups.map(or),this._parents)}function _a(t,e,n){var r=this.enter(),i=this,o=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function ya(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,o=r.length,a=Math.min(i,o),s=new Array(i),c=0;c<a;++c)for(var l=n[c],u=r[c],p=l.length,f=s[c]=new Array(p),d,m=0;m<p;++m)(d=l[m]||u[m])&&(f[m]=d);for(;c<i;++c)s[c]=n[c];return new I(s,this._parents)}function wa(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,o=r[i],a;--i>=0;)(a=r[i])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function ba(t){t||(t=Ju);function e(p,f){return p&&f?t(p.__data__,f.__data__):!p-!f}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a=n[o],s=a.length,c=i[o]=new Array(s),l,u=0;u<s;++u)(l=a[u])&&(c[u]=l);c.sort(e)}return new I(i,this._parents).order()}function Ju(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Aa(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Na(){return Array.from(this)}function Ea(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null}function Pa(){let t=0;for(let e of this)++t;return t}function Ma(){return!this.node()}function La(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],o=0,a=i.length,s;o<a;++o)(s=i[o])&&t.call(s,s.__data__,o,i);return this}function Ku(t){return function(){this.removeAttribute(t)}}function Qu(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Zu(t,e){return function(){this.setAttribute(t,e)}}function Iu(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Du(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function tc(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Oa(t,e){var n=Zt(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Qu:Ku:typeof e=="function"?n.local?tc:Du:n.local?Iu:Zu)(n,e))}function ar(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function ec(t){return function(){this.style.removeProperty(t)}}function nc(t,e,n){return function(){this.style.setProperty(t,e,n)}}function rc(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Ca(t,e,n){return arguments.length>1?this.each((e==null?ec:typeof e=="function"?rc:nc)(t,e,n??"")):ue(this.node(),t)}function ue(t,e){return t.style.getPropertyValue(e)||ar(t).getComputedStyle(t,null).getPropertyValue(e)}function ic(t){return function(){delete this[t]}}function oc(t,e){return function(){this[t]=e}}function ac(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Sa(t,e){return arguments.length>1?this.each((e==null?ic:typeof e=="function"?ac:oc)(t,e)):this.node()[t]}function Va(t){return t.trim().split(/^|\s+/)}function Ci(t){return t.classList||new ka(t)}function ka(t){this._node=t,this._names=Va(t.getAttribute("class")||"")}ka.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Ga(t,e){for(var n=Ci(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function Fa(t,e){for(var n=Ci(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function sc(t){return function(){Ga(this,t)}}function lc(t){return function(){Fa(this,t)}}function uc(t,e){return function(){(e.apply(this,arguments)?Ga:Fa)(this,t)}}function $a(t,e){var n=Va(t+"");if(arguments.length<2){for(var r=Ci(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?uc:e?sc:lc)(n,e))}function cc(){this.textContent=""}function fc(t){return function(){this.textContent=t}}function pc(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Ba(t){return arguments.length?this.each(t==null?cc:(typeof t=="function"?pc:fc)(t)):this.node().textContent}function dc(){this.innerHTML=""}function mc(t){return function(){this.innerHTML=t}}function hc(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function Ha(t){return arguments.length?this.each(t==null?dc:(typeof t=="function"?hc:mc)(t)):this.node().innerHTML}function gc(){this.nextSibling&&this.parentNode.appendChild(this)}function Ra(){return this.each(gc)}function xc(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ua(){return this.each(xc)}function za(t){var e=typeof t=="function"?t:rr(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function vc(){return null}function Ta(t,e){var n=typeof t=="function"?t:rr(t),r=e==null?vc:typeof e=="function"?e:we(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function _c(){var t=this.parentNode;t&&t.removeChild(this)}function Ya(){return this.each(_c)}function yc(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function wc(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function qa(t){return this.select(t?wc:yc)}function Wa(t){return arguments.length?this.property("__data__",t):this.node().__data__}function bc(t){return function(e){t.call(this,e,this.__data__)}}function Ac(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Nc(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,o;n<i;++n)o=e[n],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):e[++r]=o;++r?e.length=r:delete this.__on}}}function Ec(t,e,n){return function(){var r=this.__on,i,o=bc(e);if(r){for(var a=0,s=r.length;a<s;++a)if((i=r[a]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=e;return}}this.addEventListener(t.type,o,n),i={type:t.type,name:t.name,value:e,listener:o,options:n},r?r.push(i):this.__on=[i]}}function Xa(t,e,n){var r=Ac(t+""),i,o=r.length,a;if(arguments.length<2){var s=this.node().__on;if(s){for(var c=0,l=s.length,u;c<l;++c)for(i=0,u=s[c];i<o;++i)if((a=r[i]).type===u.type&&a.name===u.name)return u.value}return}for(s=e?Ec:Nc,i=0;i<o;++i)this.each(s(r[i],e,n));return this}function ja(t,e,n){var r=ar(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Pc(t,e){return function(){return ja(this,t,e)}}function Mc(t,e){return function(){return ja(this,t,e.apply(this,arguments))}}function Ja(t,e){return this.each((typeof e=="function"?Mc:Pc)(t,e))}function*Ka(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length,a;i<o;++i)(a=r[i])&&(yield a)}var Si=[null];function I(t,e){this._groups=t,this._parents=e}function Qa(){return new I([[document.documentElement]],Si)}function Lc(){return this}I.prototype=Qa.prototype={constructor:I,select:ca,selectAll:fa,selectChild:pa,selectChildren:da,filter:ma,data:xa,enter:ha,exit:va,join:_a,merge:ya,selection:Lc,order:wa,sort:ba,call:Aa,nodes:Na,node:Ea,size:Pa,empty:Ma,each:La,attr:Oa,style:Ca,property:Sa,classed:$a,text:Ba,html:Ha,raise:Ra,lower:Ua,append:za,insert:Ta,remove:Ya,clone:qa,datum:Wa,on:Xa,dispatch:Ja,[Symbol.iterator]:Ka};var It=Qa;function Dt(t){return typeof t=="string"?new I([[document.querySelector(t)]],[document.documentElement]):new I([[t]],Si)}function sr(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Vi(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function hn(){}var dn=.7,cr=1/dn,Ye="\\s*([+-]?\\d+)\\s*",mn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Xt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Oc=/^#([0-9a-f]{3,8})$/,Cc=new RegExp(`^rgb\\(${Ye},${Ye},${Ye}\\)$`),Sc=new RegExp(`^rgb\\(${Xt},${Xt},${Xt}\\)$`),Vc=new RegExp(`^rgba\\(${Ye},${Ye},${Ye},${mn}\\)$`),kc=new RegExp(`^rgba\\(${Xt},${Xt},${Xt},${mn}\\)$`),Gc=new RegExp(`^hsl\\(${mn},${Xt},${Xt}\\)$`),Fc=new RegExp(`^hsla\\(${mn},${Xt},${Xt},${mn}\\)$`),Za={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};sr(hn,Ut,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Ia,formatHex:Ia,formatHex8:$c,formatHsl:Bc,formatRgb:Da,toString:Da});function Ia(){return this.rgb().formatHex()}function $c(){return this.rgb().formatHex8()}function Bc(){return os(this).formatHsl()}function Da(){return this.rgb().formatRgb()}function Ut(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Oc.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?ts(e):n===3?new Pt(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?lr(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?lr(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Cc.exec(t))?new Pt(e[1],e[2],e[3],1):(e=Sc.exec(t))?new Pt(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Vc.exec(t))?lr(e[1],e[2],e[3],e[4]):(e=kc.exec(t))?lr(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Gc.exec(t))?rs(e[1],e[2]/100,e[3]/100,1):(e=Fc.exec(t))?rs(e[1],e[2]/100,e[3]/100,e[4]):Za.hasOwnProperty(t)?ts(Za[t]):t==="transparent"?new Pt(NaN,NaN,NaN,0):null}function ts(t){return new Pt(t>>16&255,t>>8&255,t&255,1)}function lr(t,e,n,r){return r<=0&&(t=e=n=NaN),new Pt(t,e,n,r)}function Hc(t){return t instanceof hn||(t=Ut(t)),t?(t=t.rgb(),new Pt(t.r,t.g,t.b,t.opacity)):new Pt}function qe(t,e,n,r){return arguments.length===1?Hc(t):new Pt(t,e,n,r??1)}function Pt(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}sr(Pt,qe,Vi(hn,{brighter(t){return t=t==null?cr:Math.pow(cr,t),new Pt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?dn:Math.pow(dn,t),new Pt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Pt(Ae(this.r),Ae(this.g),Ae(this.b),fr(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:es,formatHex:es,formatHex8:Rc,formatRgb:ns,toString:ns}));function es(){return`#${be(this.r)}${be(this.g)}${be(this.b)}`}function Rc(){return`#${be(this.r)}${be(this.g)}${be(this.b)}${be((isNaN(this.opacity)?1:this.opacity)*255)}`}function ns(){let t=fr(this.opacity);return`${t===1?"rgb(":"rgba("}${Ae(this.r)}, ${Ae(this.g)}, ${Ae(this.b)}${t===1?")":`, ${t})`}`}function fr(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Ae(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function be(t){return t=Ae(t),(t<16?"0":"")+t.toString(16)}function rs(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Rt(t,e,n,r)}function os(t){if(t instanceof Rt)return new Rt(t.h,t.s,t.l,t.opacity);if(t instanceof hn||(t=Ut(t)),!t)return new Rt;if(t instanceof Rt)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,c=(o+i)/2;return s?(e===o?a=(n-r)/s+(n<r)*6:n===o?a=(r-e)/s+2:a=(e-n)/s+4,s/=c<.5?o+i:2-o-i,a*=60):s=c>0&&c<1?0:a,new Rt(a,s,c,t.opacity)}function as(t,e,n,r){return arguments.length===1?os(t):new Rt(t,e,n,r??1)}function Rt(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}sr(Rt,as,Vi(hn,{brighter(t){return t=t==null?cr:Math.pow(cr,t),new Rt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?dn:Math.pow(dn,t),new Rt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Pt(ki(t>=240?t-240:t+120,i,r),ki(t,i,r),ki(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Rt(is(this.h),ur(this.s),ur(this.l),fr(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let t=fr(this.opacity);return`${t===1?"hsl(":"hsla("}${is(this.h)}, ${ur(this.s)*100}%, ${ur(this.l)*100}%${t===1?")":`, ${t})`}`}}));function is(t){return t=(t||0)%360,t<0?t+360:t}function ur(t){return Math.max(0,Math.min(1,t||0))}function ki(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function Gi(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}function ss(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,s=r<e-1?t[r+2]:2*o-i;return Gi((n-r/e)*e,a,i,o,s)}}function ls(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],o=t[r%e],a=t[(r+1)%e],s=t[(r+2)%e];return Gi((n-r/e)*e,i,o,a,s)}}var gn=t=>()=>t;function Uc(t,e){return function(n){return t+n*e}}function zc(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function us(t){return(t=+t)==1?pr:function(e,n){return n-e?zc(e,n,t):gn(isNaN(e)?n:e)}}function pr(t,e){var n=e-t;return n?Uc(t,n):gn(isNaN(t)?e:t)}var Ne=function t(e){var n=us(e);function r(i,o){var a=n((i=qe(i)).r,(o=qe(o)).r),s=n(i.g,o.g),c=n(i.b,o.b),l=pr(i.opacity,o.opacity);return function(u){return i.r=a(u),i.g=s(u),i.b=c(u),i.opacity=l(u),i+""}}return r.gamma=t,r}(1);function cs(t){return function(e){var n=e.length,r=new Array(n),i=new Array(n),o=new Array(n),a,s;for(a=0;a<n;++a)s=qe(e[a]),r[a]=s.r||0,i[a]=s.g||0,o[a]=s.b||0;return r=t(r),i=t(i),o=t(o),s.opacity=1,function(c){return s.r=r(c),s.g=i(c),s.b=o(c),s+""}}}var Tc=cs(ss),Yc=cs(ls);function fs(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=t[i]*(1-o)+e[i]*o;return r}}function ps(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function ds(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),o=new Array(n),a;for(a=0;a<r;++a)i[a]=te(t[a],e[a]);for(;a<n;++a)o[a]=e[a];return function(s){for(a=0;a<r;++a)o[a]=i[a](s);return o}}function ms(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function ut(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function hs(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=te(t[i],e[i]):r[i]=e[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var $i=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Fi=new RegExp($i.source,"g");function qc(t){return function(){return t}}function Wc(t){return function(e){return t(e)+""}}function xn(t,e){var n=$i.lastIndex=Fi.lastIndex=0,r,i,o,a=-1,s=[],c=[];for(t=t+"",e=e+"";(r=$i.exec(t))&&(i=Fi.exec(e));)(o=i.index)>n&&(o=e.slice(n,o),s[a]?s[a]+=o:s[++a]=o),(r=r[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,c.push({i:a,x:ut(r,i)})),n=Fi.lastIndex;return n<e.length&&(o=e.slice(n),s[a]?s[a]+=o:s[++a]=o),s.length<2?c[0]?Wc(c[0].x):qc(e):(e=c.length,function(l){for(var u=0,p;u<e;++u)s[(p=c[u]).i]=p.x(l);return s.join("")})}function te(t,e){var n=typeof e,r;return e==null||n==="boolean"?gn(e):(n==="number"?ut:n==="string"?(r=Ut(e))?(e=r,Ne):xn:e instanceof Ut?Ne:e instanceof Date?ms:ps(e)?fs:Array.isArray(e)?ds:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?hs:ut)(t,e)}function Bi(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var gs=180/Math.PI,dr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Hi(t,e,n,r,i,o){var a,s,c;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),t*r<e*n&&(t=-t,e=-e,c=-c,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*gs,skewX:Math.atan(c)*gs,scaleX:a,scaleY:s}}var mr;function xs(t){let e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?dr:Hi(e.a,e.b,e.c,e.d,e.e,e.f)}function vs(t){return t==null?dr:(mr||(mr=document.createElementNS("http://www.w3.org/2000/svg","g")),mr.setAttribute("transform",t),(t=mr.transform.baseVal.consolidate())?(t=t.matrix,Hi(t.a,t.b,t.c,t.d,t.e,t.f)):dr)}function _s(t,e,n,r){function i(l){return l.length?l.pop()+" ":""}function o(l,u,p,f,d,m){if(l!==p||u!==f){var _=d.push("translate(",null,e,null,n);m.push({i:_-4,x:ut(l,p)},{i:_-2,x:ut(u,f)})}else(p||f)&&d.push("translate("+p+e+f+n)}function a(l,u,p,f){l!==u?(l-u>180?u+=360:u-l>180&&(l+=360),f.push({i:p.push(i(p)+"rotate(",null,r)-2,x:ut(l,u)})):u&&p.push(i(p)+"rotate("+u+r)}function s(l,u,p,f){l!==u?f.push({i:p.push(i(p)+"skewX(",null,r)-2,x:ut(l,u)}):u&&p.push(i(p)+"skewX("+u+r)}function c(l,u,p,f,d,m){if(l!==p||u!==f){var _=d.push(i(d)+"scale(",null,",",null,")");m.push({i:_-4,x:ut(l,p)},{i:_-2,x:ut(u,f)})}else(p!==1||f!==1)&&d.push(i(d)+"scale("+p+","+f+")")}return function(l,u){var p=[],f=[];return l=t(l),u=t(u),o(l.translateX,l.translateY,u.translateX,u.translateY,p,f),a(l.rotate,u.rotate,p,f),s(l.skewX,u.skewX,p,f),c(l.scaleX,l.scaleY,u.scaleX,u.scaleY,p,f),l=u=null,function(d){for(var m=-1,_=f.length,y;++m<_;)p[(y=f[m]).i]=y.x(d);return p.join("")}}}var Ri=_s(xs,"px, ","px)","deg)"),Ui=_s(vs,", ",")",")");var We=0,_n=0,vn=0,ws=1e3,hr,yn,gr=0,Ee=0,xr=0,wn=typeof performance=="object"&&performance.now?performance:Date,bs=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function An(){return Ee||(bs(Xc),Ee=wn.now()+xr)}function Xc(){Ee=0}function bn(){this._call=this._time=this._next=null}bn.prototype=vr.prototype={constructor:bn,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?An():+n)+(e==null?0:+e),!this._next&&yn!==this&&(yn?yn._next=this:hr=this,yn=this),this._call=t,this._time=n,zi()},stop:function(){this._call&&(this._call=null,this._time=1/0,zi())}};function vr(t,e,n){var r=new bn;return r.restart(t,e,n),r}function As(){An(),++We;for(var t=hr,e;t;)(e=Ee-t._time)>=0&&t._call.call(void 0,e),t=t._next;--We}function ys(){Ee=(gr=wn.now())+xr,We=_n=0;try{As()}finally{We=0,Jc(),Ee=0}}function jc(){var t=wn.now(),e=t-gr;e>ws&&(xr-=e,gr=t)}function Jc(){for(var t,e=hr,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:hr=n);yn=t,zi(r)}function zi(t){if(!We){_n&&(_n=clearTimeout(_n));var e=t-Ee;e>24?(t<1/0&&(_n=setTimeout(ys,t-wn.now()-xr)),vn&&(vn=clearInterval(vn))):(vn||(gr=wn.now(),vn=setInterval(jc,ws)),We=1,bs(ys))}}function _r(t,e,n){var r=new bn;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var Kc=Mi("start","end","cancel","interrupt"),Qc=[],Ps=0,Ns=1,wr=2,yr=3,Es=4,br=5,Nn=6;function ce(t,e,n,r,i,o){var a=t.__transition;if(!a)t.__transition={};else if(n in a)return;Zc(t,n,{name:e,index:r,group:i,on:Kc,tween:Qc,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:Ps})}function En(t,e){var n=nt(t,e);if(n.state>Ps)throw new Error("too late; already scheduled");return n}function ct(t,e){var n=nt(t,e);if(n.state>yr)throw new Error("too late; already running");return n}function nt(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Zc(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=vr(o,0,n.time);function o(l){n.state=Ns,n.timer.restart(a,n.delay,n.time),n.delay<=l&&a(l-n.delay)}function a(l){var u,p,f,d;if(n.state!==Ns)return c();for(u in r)if(d=r[u],d.name===n.name){if(d.state===yr)return _r(a);d.state===Es?(d.state=Nn,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[u]):+u<e&&(d.state=Nn,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[u])}if(_r(function(){n.state===yr&&(n.state=Es,n.timer.restart(s,n.delay,n.time),s(l))}),n.state=wr,n.on.call("start",t,t.__data__,n.index,n.group),n.state===wr){for(n.state=yr,i=new Array(f=n.tween.length),u=0,p=-1;u<f;++u)(d=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(i[++p]=d);i.length=p+1}}function s(l){for(var u=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=br,1),p=-1,f=i.length;++p<f;)i[p].call(t,u);n.state===br&&(n.on.call("end",t,t.__data__,n.index,n.group),c())}function c(){n.state=Nn,n.timer.stop(),delete r[e];for(var l in r)return;delete t.__transition}}function Ar(t,e){var n=t.__transition,r,i,o=!0,a;if(n){e=e==null?null:e+"";for(a in n){if((r=n[a]).name!==e){o=!1;continue}i=r.state>wr&&r.state<br,r.state=Nn,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[a]}o&&delete t.__transition}}function Ms(t){return this.each(function(){Ar(this,t)})}function Ic(t,e){var n,r;return function(){var i=ct(this,t),o=i.tween;if(o!==n){r=n=o;for(var a=0,s=r.length;a<s;++a)if(r[a].name===e){r=r.slice(),r.splice(a,1);break}}i.tween=r}}function Dc(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var o=ct(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:e,value:n},c=0,l=i.length;c<l;++c)if(i[c].name===e){i[c]=s;break}c===l&&i.push(s)}o.tween=i}}function Ls(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=nt(this.node(),n).tween,i=0,o=r.length,a;i<o;++i)if((a=r[i]).name===t)return a.value;return null}return this.each((e==null?Ic:Dc)(n,t,e))}function Xe(t,e,n){var r=t._id;return t.each(function(){var i=ct(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return nt(i,r).value[e]}}function Nr(t,e){var n;return(typeof e=="number"?ut:e instanceof Ut?Ne:(n=Ut(e))?(e=n,Ne):xn)(t,e)}function t0(t){return function(){this.removeAttribute(t)}}function e0(t){return function(){this.removeAttributeNS(t.space,t.local)}}function n0(t,e,n){var r,i=n+"",o;return function(){var a=this.getAttribute(t);return a===i?null:a===r?o:o=e(r=a,n)}}function r0(t,e,n){var r,i=n+"",o;return function(){var a=this.getAttributeNS(t.space,t.local);return a===i?null:a===r?o:o=e(r=a,n)}}function i0(t,e,n){var r,i,o;return function(){var a,s=n(this),c;return s==null?void this.removeAttribute(t):(a=this.getAttribute(t),c=s+"",a===c?null:a===r&&c===i?o:(i=c,o=e(r=a,s)))}}function o0(t,e,n){var r,i,o;return function(){var a,s=n(this),c;return s==null?void this.removeAttributeNS(t.space,t.local):(a=this.getAttributeNS(t.space,t.local),c=s+"",a===c?null:a===r&&c===i?o:(i=c,o=e(r=a,s)))}}function Os(t,e){var n=Zt(t),r=n==="transform"?Ui:Nr;return this.attrTween(t,typeof e=="function"?(n.local?o0:i0)(n,r,Xe(this,"attr."+t,e)):e==null?(n.local?e0:t0)(n):(n.local?r0:n0)(n,r,e))}function a0(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function s0(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function l0(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&s0(t,o)),n}return i._value=e,i}function u0(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&a0(t,o)),n}return i._value=e,i}function Cs(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=Zt(t);return this.tween(n,(r.local?l0:u0)(r,e))}function c0(t,e){return function(){En(this,t).delay=+e.apply(this,arguments)}}function f0(t,e){return e=+e,function(){En(this,t).delay=e}}function Ss(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?c0:f0)(e,t)):nt(this.node(),e).delay}function p0(t,e){return function(){ct(this,t).duration=+e.apply(this,arguments)}}function d0(t,e){return e=+e,function(){ct(this,t).duration=e}}function Vs(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?p0:d0)(e,t)):nt(this.node(),e).duration}function m0(t,e){if(typeof e!="function")throw new Error;return function(){ct(this,t).ease=e}}function ks(t){var e=this._id;return arguments.length?this.each(m0(e,t)):nt(this.node(),e).ease}function h0(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;ct(this,t).ease=n}}function Gs(t){if(typeof t!="function")throw new Error;return this.each(h0(this._id,t))}function Fs(t){typeof t!="function"&&(t=fn(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],a=o.length,s=r[i]=[],c,l=0;l<a;++l)(c=o[l])&&t.call(c,c.__data__,l,o)&&s.push(c);return new xt(r,this._parents,this._name,this._id)}function $s(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var c=e[s],l=n[s],u=c.length,p=a[s]=new Array(u),f,d=0;d<u;++d)(f=c[d]||l[d])&&(p[d]=f);for(;s<r;++s)a[s]=e[s];return new xt(a,this._parents,this._name,this._id)}function g0(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function x0(t,e,n){var r,i,o=g0(e)?En:ct;return function(){var a=o(this,t),s=a.on;s!==r&&(i=(r=s).copy()).on(e,n),a.on=i}}function Bs(t,e){var n=this._id;return arguments.length<2?nt(this.node(),n).on.on(t):this.each(x0(n,t,e))}function v0(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function Hs(){return this.on("end.remove",v0(this._id))}function Rs(t){var e=this._name,n=this._id;typeof t!="function"&&(t=we(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s=r[a],c=s.length,l=o[a]=new Array(c),u,p,f=0;f<c;++f)(u=s[f])&&(p=t.call(u,u.__data__,f,s))&&("__data__"in u&&(p.__data__=u.__data__),l[f]=p,ce(l[f],e,n,f,l,nt(u,n)));return new xt(o,this._parents,e,n)}function Us(t){var e=this._name,n=this._id;typeof t!="function"&&(t=cn(t));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var c=r[s],l=c.length,u,p=0;p<l;++p)if(u=c[p]){for(var f=t.call(u,u.__data__,p,c),d,m=nt(u,n),_=0,y=f.length;_<y;++_)(d=f[_])&&ce(d,e,n,_,f,m);o.push(f),a.push(u)}return new xt(o,a,e,n)}var _0=It.prototype.constructor;function zs(){return new _0(this._groups,this._parents)}function y0(t,e){var n,r,i;return function(){var o=ue(this,t),a=(this.style.removeProperty(t),ue(this,t));return o===a?null:o===n&&a===r?i:i=e(n=o,r=a)}}function Ts(t){return function(){this.style.removeProperty(t)}}function w0(t,e,n){var r,i=n+"",o;return function(){var a=ue(this,t);return a===i?null:a===r?o:o=e(r=a,n)}}function b0(t,e,n){var r,i,o;return function(){var a=ue(this,t),s=n(this),c=s+"";return s==null&&(c=s=(this.style.removeProperty(t),ue(this,t))),a===c?null:a===r&&c===i?o:(i=c,o=e(r=a,s))}}function A0(t,e){var n,r,i,o="style."+e,a="end."+o,s;return function(){var c=ct(this,t),l=c.on,u=c.value[o]==null?s||(s=Ts(e)):void 0;(l!==n||i!==u)&&(r=(n=l).copy()).on(a,i=u),c.on=r}}function Ys(t,e,n){var r=(t+="")=="transform"?Ri:Nr;return e==null?this.styleTween(t,y0(t,r)).on("end.style."+t,Ts(t)):typeof e=="function"?this.styleTween(t,b0(t,r,Xe(this,"style."+t,e))).each(A0(this._id,t)):this.styleTween(t,w0(t,r,e),n).on("end.style."+t,null)}function N0(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function E0(t,e,n){var r,i;function o(){var a=e.apply(this,arguments);return a!==i&&(r=(i=a)&&N0(t,a,n)),r}return o._value=e,o}function qs(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,E0(t,e,n??""))}function P0(t){return function(){this.textContent=t}}function M0(t){return function(){var e=t(this);this.textContent=e??""}}function Ws(t){return this.tween("text",typeof t=="function"?M0(Xe(this,"text",t)):P0(t==null?"":t+""))}function L0(t){return function(e){this.textContent=t.call(this,e)}}function O0(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&L0(i)),e}return r._value=t,r}function Xs(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,O0(t))}function js(){for(var t=this._name,e=this._id,n=Er(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,c,l=0;l<s;++l)if(c=a[l]){var u=nt(c,e);ce(c,t,n,l,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new xt(r,this._parents,t,n)}function Js(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(o,a){var s={value:a},c={value:function(){--i===0&&o()}};n.each(function(){var l=ct(this,r),u=l.on;u!==t&&(e=(t=u).copy(),e._.cancel.push(s),e._.interrupt.push(s),e._.end.push(c)),l.on=e}),i===0&&o()})}var C0=0;function xt(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Ks(t){return It().transition(t)}function Er(){return++C0}var ee=It.prototype;xt.prototype=Ks.prototype={constructor:xt,select:Rs,selectAll:Us,selectChild:ee.selectChild,selectChildren:ee.selectChildren,filter:Fs,merge:$s,selection:zs,transition:js,call:ee.call,nodes:ee.nodes,node:ee.node,size:ee.size,empty:ee.empty,each:ee.each,on:Bs,attr:Os,attrTween:Cs,style:Ys,styleTween:qs,text:Ws,textTween:Xs,remove:Hs,tween:Ls,delay:Ss,duration:Vs,ease:ks,easeVarying:Gs,end:Js,[Symbol.iterator]:ee[Symbol.iterator]};function Pr(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var S0={time:null,delay:0,duration:250,ease:Pr};function V0(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Qs(t){var e,n;t instanceof xt?(e=t._id,t=t._name):(e=Er(),(n=S0).time=An(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,c,l=0;l<s;++l)(c=a[l])&&ce(c,t,e,l,a,n||V0(c,e));return new xt(r,this._parents,t,e)}It.prototype.interrupt=Ms;It.prototype.transition=Qs;var{abs:zx,max:Tx,min:Yx}=Math;function Zs(t){return[+t[0],+t[1]]}function k0(t){return[Zs(t[0]),Zs(t[1])]}var qx={name:"x",handles:["w","e"].map(Ti),input:function(t,e){return t==null?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},Wx={name:"y",handles:["n","s"].map(Ti),input:function(t,e){return t==null?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},Xx={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(Ti),input:function(t){return t==null?null:k0(t)},output:function(t){return t}};function Ti(t){return{type:t}}var Yi=Math.PI,qi=2*Yi,Pe=1e-6,G0=qi-Pe;function Is(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function F0(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Is;let n=10**e;return function(r){this._+=r[0];for(let i=1,o=r.length;i<o;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}var Me=class{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?Is:F0(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,o,a){this._append`C${+e},${+n},${+r},${+i},${this._x1=+o},${this._y1=+a}`}arcTo(e,n,r,i,o){if(e=+e,n=+n,r=+r,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let a=this._x1,s=this._y1,c=r-e,l=i-n,u=a-e,p=s-n,f=u*u+p*p;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(f>Pe)if(!(Math.abs(p*c-l*u)>Pe)||!o)this._append`L${this._x1=e},${this._y1=n}`;else{let d=r-a,m=i-s,_=c*c+l*l,y=d*d+m*m,A=Math.sqrt(_),E=Math.sqrt(f),P=o*Math.tan((Yi-Math.acos((_+f-y)/(2*A*E)))/2),N=P/E,M=P/A;Math.abs(N-1)>Pe&&this._append`L${e+N*u},${n+N*p}`,this._append`A${o},${o},0,0,${+(p*d>u*m)},${this._x1=e+M*c},${this._y1=n+M*l}`}}arc(e,n,r,i,o,a){if(e=+e,n=+n,r=+r,a=!!a,r<0)throw new Error(`negative radius: ${r}`);let s=r*Math.cos(i),c=r*Math.sin(i),l=e+s,u=n+c,p=1^a,f=a?i-o:o-i;this._x1===null?this._append`M${l},${u}`:(Math.abs(this._x1-l)>Pe||Math.abs(this._y1-u)>Pe)&&this._append`L${l},${u}`,r&&(f<0&&(f=f%qi+qi),f>G0?this._append`A${r},${r},0,1,${p},${e-s},${n-c}A${r},${r},0,1,${p},${this._x1=l},${this._y1=u}`:f>Pe&&this._append`A${r},${r},0,${+(f>=Yi)},${p},${this._x1=e+r*Math.cos(o)},${this._y1=n+r*Math.sin(o)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}};function Ds(){return new Me}Ds.prototype=Me.prototype;function tl(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Le(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function jt(t){return t=Le(Math.abs(t)),t?t[1]:NaN}function el(t,e){return function(n,r){for(var i=n.length,o=[],a=0,s=t[0],c=0;i>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),o.push(n.substring(i-=s,i+s)),!((c+=s+1)>r));)s=t[a=(a+1)%t.length];return o.reverse().join(e)}}function nl(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var $0=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function fe(t){if(!(e=$0.exec(t)))throw new Error("invalid format: "+t);var e;return new Mr({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}fe.prototype=Mr.prototype;function Mr(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Mr.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function rl(t){t:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var Wi;function il(t,e){var n=Le(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(Wi=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Le(t,Math.max(0,e+o-1))[0]}function Xi(t,e){var n=Le(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var ji={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:tl,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Xi(t*100,e),r:Xi,s:il,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Ji(t){return t}var ol=Array.prototype.map,al=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function sl(t){var e=t.grouping===void 0||t.thousands===void 0?Ji:el(ol.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?Ji:nl(ol.call(t.numerals,String)),a=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"\u2212":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function l(p){p=fe(p);var f=p.fill,d=p.align,m=p.sign,_=p.symbol,y=p.zero,A=p.width,E=p.comma,P=p.precision,N=p.trim,M=p.type;M==="n"?(E=!0,M="g"):ji[M]||(P===void 0&&(P=12),N=!0,M="g"),(y||f==="0"&&d==="=")&&(y=!0,f="0",d="=");var O=_==="$"?n:_==="#"&&/[boxX]/.test(M)?"0"+M.toLowerCase():"",S=_==="$"?r:/[%p]/.test(M)?a:"",V=ji[M],k=/[defgprs%]/.test(M);P=P===void 0?6:/[gprs]/.test(M)?Math.max(1,Math.min(21,P)):Math.max(0,Math.min(20,P));function F(v){var $=O,b=S,L,g,G;if(M==="c")b=V(v)+b,v="";else{v=+v;var Y=v<0||1/v<0;if(v=isNaN(v)?c:V(Math.abs(v),P),N&&(v=rl(v)),Y&&+v==0&&m!=="+"&&(Y=!1),$=(Y?m==="("?m:s:m==="-"||m==="("?"":m)+$,b=(M==="s"?al[8+Wi/3]:"")+b+(Y&&m==="("?")":""),k){for(L=-1,g=v.length;++L<g;)if(G=v.charCodeAt(L),48>G||G>57){b=(G===46?i+v.slice(L+1):v.slice(L))+b,v=v.slice(0,L);break}}}E&&!y&&(v=e(v,1/0));var J=$.length+v.length+b.length,X=J<A?new Array(A-J+1).join(f):"";switch(E&&y&&(v=e(X+v,X.length?A-b.length:1/0),X=""),d){case"<":v=$+v+b+X;break;case"=":v=$+X+v+b;break;case"^":v=X.slice(0,J=X.length>>1)+$+v+b+X.slice(J);break;default:v=X+$+v+b;break}return o(v)}return F.toString=function(){return p+""},F}function u(p,f){var d=l((p=fe(p),p.type="f",p)),m=Math.max(-8,Math.min(8,Math.floor(jt(f)/3)))*3,_=Math.pow(10,-m),y=al[8+m/3];return function(A){return d(_*A)+y}}return{format:l,formatPrefix:u}}var Lr,Or,Cr;Ki({thousands:",",grouping:[3],currency:["$",""]});function Ki(t){return Lr=sl(t),Or=Lr.format,Cr=Lr.formatPrefix,Lr}function Qi(t){return Math.max(0,-jt(Math.abs(t)))}function Zi(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(jt(e)/3)))*3-jt(Math.abs(t)))}function Ii(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,jt(e)-jt(t))+1}var U=1e-6,ll=1e-12,R=Math.PI,ot=R/2,Di=R/4,at=R*2,mt=180/R,Z=R/180,T=Math.abs,Sr=Math.atan,ne=Math.atan2,W=Math.cos;var ul=Math.exp;var cl=Math.log;var j=Math.sin,fl=Math.sign||function(t){return t>0?1:t<0?-1:0},Gt=Math.sqrt,pl=Math.tan;function dl(t){return t>1?0:t<-1?R:Math.acos(t)}function re(t){return t>1?ot:t<-1?-ot:Math.asin(t)}function st(){}function Vr(t,e){t&&hl.hasOwnProperty(t.type)&&hl[t.type](t,e)}var ml={Feature:function(t,e){Vr(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)Vr(n[r].geometry,e)}},hl={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){to(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)to(n[r],e,0)},Polygon:function(t,e){gl(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)gl(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)Vr(n[r],e)}};function to(t,e,n){var r=-1,i=t.length-n,o;for(e.lineStart();++r<i;)o=t[r],e.point(o[0],o[1],o[2]);e.lineEnd()}function gl(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)to(t[n],e,1);e.polygonEnd()}function pe(t,e){t&&ml.hasOwnProperty(t.type)?ml[t.type](t,e):Vr(t,e)}function Pn(t){return[ne(t[1],t[0]),re(t[2])]}function Jt(t){var e=t[0],n=t[1],r=W(n);return[r*W(e),r*j(e),j(n)]}function Mn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function je(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function kr(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Ln(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function On(t){var e=Gt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function Cn(t,e){function n(r,i){return r=t(r,i),e(r[0],r[1])}return t.invert&&e.invert&&(n.invert=function(r,i){return r=e.invert(r,i),r&&t.invert(r[0],r[1])}),n}function eo(t,e){return T(t)>R&&(t-=Math.round(t/at)*at),[t,e]}eo.invert=eo;function no(t,e,n){return(t%=at)?e||n?Cn(vl(t),_l(e,n)):vl(t):e||n?_l(e,n):eo}function xl(t){return function(e,n){return e+=t,T(e)>R&&(e-=Math.round(e/at)*at),[e,n]}}function vl(t){var e=xl(t);return e.invert=xl(-t),e}function _l(t,e){var n=W(t),r=j(t),i=W(e),o=j(e);function a(s,c){var l=W(c),u=W(s)*l,p=j(s)*l,f=j(c),d=f*n+u*r;return[ne(p*i-d*o,u*n-f*r),re(d*i+p*o)]}return a.invert=function(s,c){var l=W(c),u=W(s)*l,p=j(s)*l,f=j(c),d=f*i-p*o;return[ne(p*i+f*o,u*n+d*r),re(d*n-u*r)]},a}function yl(t){t=no(t[0]*Z,t[1]*Z,t.length>2?t[2]*Z:0);function e(n){return n=t(n[0]*Z,n[1]*Z),n[0]*=mt,n[1]*=mt,n}return e.invert=function(n){return n=t.invert(n[0]*Z,n[1]*Z),n[0]*=mt,n[1]*=mt,n},e}function bl(t,e,n,r,i,o){if(n){var a=W(e),s=j(e),c=r*n;i==null?(i=e+r*at,o=e-c/2):(i=wl(a,i),o=wl(a,o),(r>0?i<o:i>o)&&(i+=r*at));for(var l,u=i;r>0?u>o:u<o;u-=c)l=Pn([a,-s*W(u),-s*j(u)]),t.point(l[0],l[1])}}function wl(t,e){e=Jt(e),e[0]-=t,On(e);var n=dl(-e[1]);return((-e[2]<0?-n:n)+at-U)%at}function Gr(){var t=[],e;return{point:function(n,r,i){e.push([n,r,i])},lineStart:function(){t.push(e=[])},lineEnd:st,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}function Je(t,e){return T(t[0]-e[0])<U&&T(t[1]-e[1])<U}function Fr(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function $r(t,e,n,r,i){var o=[],a=[],s,c;if(t.forEach(function(m){if(!((_=m.length-1)<=0)){var _,y=m[0],A=m[_],E;if(Je(y,A)){if(!y[2]&&!A[2]){for(i.lineStart(),s=0;s<_;++s)i.point((y=m[s])[0],y[1]);i.lineEnd();return}A[0]+=2*U}o.push(E=new Fr(y,m,null,!0)),a.push(E.o=new Fr(y,null,E,!1)),o.push(E=new Fr(A,m,null,!1)),a.push(E.o=new Fr(A,null,E,!0))}}),!!o.length){for(a.sort(e),Al(o),Al(a),s=0,c=a.length;s<c;++s)a[s].e=n=!n;for(var l=o[0],u,p;;){for(var f=l,d=!0;f.v;)if((f=f.n)===l)return;u=f.z,i.lineStart();do{if(f.v=f.o.v=!0,f.e){if(d)for(s=0,c=u.length;s<c;++s)i.point((p=u[s])[0],p[1]);else r(f.x,f.n.x,1,i);f=f.n}else{if(d)for(u=f.p.z,s=u.length-1;s>=0;--s)i.point((p=u[s])[0],p[1]);else r(f.x,f.p.x,-1,i);f=f.p}f=f.o,u=f.z,d=!d}while(!f.v);i.lineEnd()}}}function Al(t){if(e=t.length){for(var e,n=0,r=t[0],i;++n<e;)r.n=i=t[n],i.p=r,r=i;r.n=i=t[0],i.p=r}}function ro(t){return T(t[0])<=R?t[0]:fl(t[0])*((T(t[0])+R)%at-R)}function Nl(t,e){var n=ro(e),r=e[1],i=j(r),o=[j(n),-W(n),0],a=0,s=0,c=new kt;i===1?r=ot+U:i===-1&&(r=-ot-U);for(var l=0,u=t.length;l<u;++l)if(f=(p=t[l]).length)for(var p,f,d=p[f-1],m=ro(d),_=d[1]/2+Di,y=j(_),A=W(_),E=0;E<f;++E,m=N,y=O,A=S,d=P){var P=p[E],N=ro(P),M=P[1]/2+Di,O=j(M),S=W(M),V=N-m,k=V>=0?1:-1,F=k*V,v=F>R,$=y*O;if(c.add(ne($*k*j(F),A*S+$*W(F))),a+=v?V+k*at:V,v^m>=n^N>=n){var b=je(Jt(d),Jt(P));On(b);var L=je(o,b);On(L);var g=(v^V>=0?-1:1)*re(L[2]);(r>g||r===g&&(b[0]||b[1]))&&(s+=v^V>=0?1:-1)}}return(a<-U||a<U&&c<-ll)^s&1}function Br(t,e,n,r){return function(i){var o=e(i),a=Gr(),s=e(a),c=!1,l,u,p,f={point:d,lineStart:_,lineEnd:y,polygonStart:function(){f.point=A,f.lineStart=E,f.lineEnd=P,u=[],l=[]},polygonEnd:function(){f.point=d,f.lineStart=_,f.lineEnd=y,u=Te(u);var N=Nl(l,r);u.length?(c||(i.polygonStart(),c=!0),$r(u,H0,N,n,i)):N&&(c||(i.polygonStart(),c=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),c&&(i.polygonEnd(),c=!1),u=l=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function d(N,M){t(N,M)&&i.point(N,M)}function m(N,M){o.point(N,M)}function _(){f.point=m,o.lineStart()}function y(){f.point=d,o.lineEnd()}function A(N,M){p.push([N,M]),s.point(N,M)}function E(){s.lineStart(),p=[]}function P(){A(p[0][0],p[0][1]),s.lineEnd();var N=s.clean(),M=a.result(),O,S=M.length,V,k,F;if(p.pop(),l.push(p),p=null,!!S){if(N&1){if(k=M[0],(V=k.length-1)>0){for(c||(i.polygonStart(),c=!0),i.lineStart(),O=0;O<V;++O)i.point((F=k[O])[0],F[1]);i.lineEnd()}return}S>1&&N&2&&M.push(M.pop().concat(M.shift())),u.push(M.filter(B0))}}return f}}function B0(t){return t.length>1}function H0(t,e){return((t=t.x)[0]<0?t[1]-ot-U:ot-t[1])-((e=e.x)[0]<0?e[1]-ot-U:ot-e[1])}var io=Br(function(){return!0},R0,z0,[-R,-ot]);function R0(t){var e=NaN,n=NaN,r=NaN,i;return{lineStart:function(){t.lineStart(),i=1},point:function(o,a){var s=o>0?R:-R,c=T(o-e);T(c-R)<U?(t.point(e,n=(n+a)/2>0?ot:-ot),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(s,n),t.point(o,n),i=0):r!==s&&c>=R&&(T(e-r)<U&&(e-=r*U),T(o-s)<U&&(o-=s*U),n=U0(e,n,o,a),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(s,n),i=0),t.point(e=o,n=a),r=s},lineEnd:function(){t.lineEnd(),e=n=NaN},clean:function(){return 2-i}}}function U0(t,e,n,r){var i,o,a=j(t-n);return T(a)>U?Sr((j(e)*(o=W(r))*j(n)-j(r)*(i=W(e))*j(t))/(i*o*a)):(e+r)/2}function z0(t,e,n,r){var i;if(t==null)i=n*ot,r.point(-R,i),r.point(0,i),r.point(R,i),r.point(R,0),r.point(R,-i),r.point(0,-i),r.point(-R,-i),r.point(-R,0),r.point(-R,i);else if(T(t[0]-e[0])>U){var o=t[0]<e[0]?R:-R;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(e[0],e[1])}function El(t){var e=W(t),n=2*Z,r=e>0,i=T(e)>U;function o(u,p,f,d){bl(d,t,n,f,u,p)}function a(u,p){return W(u)*W(p)>e}function s(u){var p,f,d,m,_;return{lineStart:function(){m=d=!1,_=1},point:function(y,A){var E=[y,A],P,N=a(y,A),M=r?N?0:l(y,A):N?l(y+(y<0?R:-R),A):0;if(!p&&(m=d=N)&&u.lineStart(),N!==d&&(P=c(p,E),(!P||Je(p,P)||Je(E,P))&&(E[2]=1)),N!==d)_=0,N?(u.lineStart(),P=c(E,p),u.point(P[0],P[1])):(P=c(p,E),u.point(P[0],P[1],2),u.lineEnd()),p=P;else if(i&&p&&r^N){var O;!(M&f)&&(O=c(E,p,!0))&&(_=0,r?(u.lineStart(),u.point(O[0][0],O[0][1]),u.point(O[1][0],O[1][1]),u.lineEnd()):(u.point(O[1][0],O[1][1]),u.lineEnd(),u.lineStart(),u.point(O[0][0],O[0][1],3)))}N&&(!p||!Je(p,E))&&u.point(E[0],E[1]),p=E,d=N,f=M},lineEnd:function(){d&&u.lineEnd(),p=null},clean:function(){return _|(m&&d)<<1}}}function c(u,p,f){var d=Jt(u),m=Jt(p),_=[1,0,0],y=je(d,m),A=Mn(y,y),E=y[0],P=A-E*E;if(!P)return!f&&u;var N=e*A/P,M=-e*E/P,O=je(_,y),S=Ln(_,N),V=Ln(y,M);kr(S,V);var k=O,F=Mn(S,k),v=Mn(k,k),$=F*F-v*(Mn(S,S)-1);if(!($<0)){var b=Gt($),L=Ln(k,(-F-b)/v);if(kr(L,S),L=Pn(L),!f)return L;var g=u[0],G=p[0],Y=u[1],J=p[1],X;G<g&&(X=g,g=G,G=X);var Yt=G-g,_t=T(Yt-R)<U,Ft=_t||Yt<U;if(!_t&&J<Y&&(X=Y,Y=J,J=X),Ft?_t?Y+J>0^L[1]<(T(L[0]-g)<U?Y:J):Y<=L[1]&&L[1]<=J:Yt>R^(g<=L[0]&&L[0]<=G)){var Mt=Ln(k,(-F+b)/v);return kr(Mt,S),[L,Pn(Mt)]}}}function l(u,p){var f=r?t:R-t,d=0;return u<-f?d|=1:u>f&&(d|=2),p<-f?d|=4:p>f&&(d|=8),d}return Br(a,s,o,r?[0,-t]:[-R,t-R])}function Pl(t,e,n,r,i,o){var a=t[0],s=t[1],c=e[0],l=e[1],u=0,p=1,f=c-a,d=l-s,m;if(m=n-a,!(!f&&m>0)){if(m/=f,f<0){if(m<u)return;m<p&&(p=m)}else if(f>0){if(m>p)return;m>u&&(u=m)}if(m=i-a,!(!f&&m<0)){if(m/=f,f<0){if(m>p)return;m>u&&(u=m)}else if(f>0){if(m<u)return;m<p&&(p=m)}if(m=r-s,!(!d&&m>0)){if(m/=d,d<0){if(m<u)return;m<p&&(p=m)}else if(d>0){if(m>p)return;m>u&&(u=m)}if(m=o-s,!(!d&&m<0)){if(m/=d,d<0){if(m>p)return;m>u&&(u=m)}else if(d>0){if(m<u)return;m<p&&(p=m)}return u>0&&(t[0]=a+u*f,t[1]=s+u*d),p<1&&(e[0]=a+p*f,e[1]=s+p*d),!0}}}}}var Sn=1e9,Hr=-Sn;function oo(t,e,n,r){function i(l,u){return t<=l&&l<=n&&e<=u&&u<=r}function o(l,u,p,f){var d=0,m=0;if(l==null||(d=a(l,p))!==(m=a(u,p))||c(l,u)<0^p>0)do f.point(d===0||d===3?t:n,d>1?r:e);while((d=(d+p+4)%4)!==m);else f.point(u[0],u[1])}function a(l,u){return T(l[0]-t)<U?u>0?0:3:T(l[0]-n)<U?u>0?2:1:T(l[1]-e)<U?u>0?1:0:u>0?3:2}function s(l,u){return c(l.x,u.x)}function c(l,u){var p=a(l,1),f=a(u,1);return p!==f?p-f:p===0?u[1]-l[1]:p===1?l[0]-u[0]:p===2?l[1]-u[1]:u[0]-l[0]}return function(l){var u=l,p=Gr(),f,d,m,_,y,A,E,P,N,M,O,S={point:V,lineStart:$,lineEnd:b,polygonStart:F,polygonEnd:v};function V(g,G){i(g,G)&&u.point(g,G)}function k(){for(var g=0,G=0,Y=d.length;G<Y;++G)for(var J=d[G],X=1,Yt=J.length,_t=J[0],Ft,Mt,ie=_t[0],pt=_t[1];X<Yt;++X)Ft=ie,Mt=pt,_t=J[X],ie=_t[0],pt=_t[1],Mt<=r?pt>r&&(ie-Ft)*(r-Mt)>(pt-Mt)*(t-Ft)&&++g:pt<=r&&(ie-Ft)*(r-Mt)<(pt-Mt)*(t-Ft)&&--g;return g}function F(){u=p,f=[],d=[],O=!0}function v(){var g=k(),G=O&&g,Y=(f=Te(f)).length;(G||Y)&&(l.polygonStart(),G&&(l.lineStart(),o(null,null,1,l),l.lineEnd()),Y&&$r(f,s,g,o,l),l.polygonEnd()),u=l,f=d=m=null}function $(){S.point=L,d&&d.push(m=[]),M=!0,N=!1,E=P=NaN}function b(){f&&(L(_,y),A&&N&&p.rejoin(),f.push(p.result())),S.point=V,N&&u.lineEnd()}function L(g,G){var Y=i(g,G);if(d&&m.push([g,G]),M)_=g,y=G,A=Y,M=!1,Y&&(u.lineStart(),u.point(g,G));else if(Y&&N)u.point(g,G);else{var J=[E=Math.max(Hr,Math.min(Sn,E)),P=Math.max(Hr,Math.min(Sn,P))],X=[g=Math.max(Hr,Math.min(Sn,g)),G=Math.max(Hr,Math.min(Sn,G))];Pl(J,X,t,e,n,r)?(N||(u.lineStart(),u.point(J[0],J[1])),u.point(X[0],X[1]),Y||u.lineEnd(),O=!1):Y&&(u.lineStart(),u.point(g,G),O=!1)}E=g,P=G,N=Y}return S}}var Vn=t=>t;var ao=new kt,so=new kt,Ml,Ll,lo,uo,de={point:st,lineStart:st,lineEnd:st,polygonStart:function(){de.lineStart=T0,de.lineEnd=q0},polygonEnd:function(){de.lineStart=de.lineEnd=de.point=st,ao.add(T(so)),so=new kt},result:function(){var t=ao/2;return ao=new kt,t}};function T0(){de.point=Y0}function Y0(t,e){de.point=Ol,Ml=lo=t,Ll=uo=e}function Ol(t,e){so.add(uo*t-lo*e),lo=t,uo=e}function q0(){Ol(Ml,Ll)}var co=de;var Ke=1/0,Rr=Ke,kn=-Ke,Ur=kn,W0={point:X0,lineStart:st,lineEnd:st,polygonStart:st,polygonEnd:st,result:function(){var t=[[Ke,Rr],[kn,Ur]];return kn=Ur=-(Rr=Ke=1/0),t}};function X0(t,e){t<Ke&&(Ke=t),t>kn&&(kn=t),e<Rr&&(Rr=e),e>Ur&&(Ur=e)}var Qe=W0;var fo=0,po=0,Gn=0,zr=0,Tr=0,Ze=0,mo=0,ho=0,Fn=0,Vl,kl,Kt,Qt,zt={point:Oe,lineStart:Cl,lineEnd:Sl,polygonStart:function(){zt.lineStart=K0,zt.lineEnd=Q0},polygonEnd:function(){zt.point=Oe,zt.lineStart=Cl,zt.lineEnd=Sl},result:function(){var t=Fn?[mo/Fn,ho/Fn]:Ze?[zr/Ze,Tr/Ze]:Gn?[fo/Gn,po/Gn]:[NaN,NaN];return fo=po=Gn=zr=Tr=Ze=mo=ho=Fn=0,t}};function Oe(t,e){fo+=t,po+=e,++Gn}function Cl(){zt.point=j0}function j0(t,e){zt.point=J0,Oe(Kt=t,Qt=e)}function J0(t,e){var n=t-Kt,r=e-Qt,i=Gt(n*n+r*r);zr+=i*(Kt+t)/2,Tr+=i*(Qt+e)/2,Ze+=i,Oe(Kt=t,Qt=e)}function Sl(){zt.point=Oe}function K0(){zt.point=Z0}function Q0(){Gl(Vl,kl)}function Z0(t,e){zt.point=Gl,Oe(Vl=Kt=t,kl=Qt=e)}function Gl(t,e){var n=t-Kt,r=e-Qt,i=Gt(n*n+r*r);zr+=i*(Kt+t)/2,Tr+=i*(Qt+e)/2,Ze+=i,i=Qt*t-Kt*e,mo+=i*(Kt+t),ho+=i*(Qt+e),Fn+=i*3,Oe(Kt=t,Qt=e)}var go=zt;function Yr(t){this._context=t}Yr.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:{this._context.moveTo(t,e),this._point=1;break}case 1:{this._context.lineTo(t,e);break}default:{this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,at);break}}},result:st};var vo=new kt,xo,Fl,$l,$n,Bn,qr={point:st,lineStart:function(){qr.point=I0},lineEnd:function(){xo&&Bl(Fl,$l),qr.point=st},polygonStart:function(){xo=!0},polygonEnd:function(){xo=null},result:function(){var t=+vo;return vo=new kt,t}};function I0(t,e){qr.point=Bl,Fl=$n=t,$l=Bn=e}function Bl(t,e){$n-=t,Bn-=e,vo.add(Gt($n*$n+Bn*Bn)),$n=t,Bn=e}var _o=qr;var Hl,Wr,Rl,Ul,Hn=class{constructor(e){this._append=e==null?zl:D0(e),this._radius=4.5,this._=""}pointRadius(e){return this._radius=+e,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(e,n){switch(this._point){case 0:{this._append`M${e},${n}`,this._point=1;break}case 1:{this._append`L${e},${n}`;break}default:{if(this._append`M${e},${n}`,this._radius!==Rl||this._append!==Wr){let r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,Rl=r,Wr=this._append,Ul=this._,this._=i}this._+=Ul;break}}}result(){let e=this._;return this._="",e.length?e:null}};function zl(t){let e=1;this._+=t[0];for(let n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function D0(t){let e=Math.floor(t);if(!(e>=0))throw new RangeError(`invalid digits: ${t}`);if(e>15)return zl;if(e!==Hl){let n=10**e;Hl=e,Wr=function(i){let o=1;this._+=i[0];for(let a=i.length;o<a;++o)this._+=Math.round(arguments[o]*n)/n+i[o]}}return Wr}function Xr(t,e){let n=3,r=4.5,i,o;function a(s){return s&&(typeof r=="function"&&o.pointRadius(+r.apply(this,arguments)),pe(s,i(o))),o.result()}return a.area=function(s){return pe(s,i(co)),co.result()},a.measure=function(s){return pe(s,i(_o)),_o.result()},a.bounds=function(s){return pe(s,i(Qe)),Qe.result()},a.centroid=function(s){return pe(s,i(go)),go.result()},a.projection=function(s){return arguments.length?(i=s==null?(t=null,Vn):(t=s).stream,a):t},a.context=function(s){return arguments.length?(o=s==null?(e=null,new Hn(n)):new Yr(e=s),typeof r!="function"&&o.pointRadius(r),a):e},a.pointRadius=function(s){return arguments.length?(r=typeof s=="function"?s:(o.pointRadius(+s),+s),a):r},a.digits=function(s){if(!arguments.length)return n;if(s==null)n=null;else{let c=Math.floor(s);if(!(c>=0))throw new RangeError(`invalid digits: ${s}`);n=c}return e===null&&(o=new Hn(n)),a},a.projection(t).digits(n).context(e)}function Rn(t){return function(e){var n=new yo;for(var r in t)n[r]=t[r];return n.stream=e,n}}function yo(){}yo.prototype={constructor:yo,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function wo(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),r!=null&&t.clipExtent(null),pe(n,t.stream(Qe)),e(Qe.result()),r!=null&&t.clipExtent(r),t}function bo(t,e,n){return wo(t,function(r){var i=e[1][0]-e[0][0],o=e[1][1]-e[0][1],a=Math.min(i/(r[1][0]-r[0][0]),o/(r[1][1]-r[0][1])),s=+e[0][0]+(i-a*(r[1][0]+r[0][0]))/2,c=+e[0][1]+(o-a*(r[1][1]+r[0][1]))/2;t.scale(150*a).translate([s,c])},n)}function Tl(t,e,n){return bo(t,[[0,0],e],n)}function Yl(t,e,n){return wo(t,function(r){var i=+e,o=i/(r[1][0]-r[0][0]),a=(i-o*(r[1][0]+r[0][0]))/2,s=-o*r[0][1];t.scale(150*o).translate([a,s])},n)}function ql(t,e,n){return wo(t,function(r){var i=+e,o=i/(r[1][1]-r[0][1]),a=-o*r[0][0],s=(i-o*(r[1][1]+r[0][1]))/2;t.scale(150*o).translate([a,s])},n)}var Wl=16,tf=W(30*Z);function Ao(t,e){return+e?nf(t,e):ef(t)}function ef(t){return Rn({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}function nf(t,e){function n(r,i,o,a,s,c,l,u,p,f,d,m,_,y){var A=l-r,E=u-i,P=A*A+E*E;if(P>4*e&&_--){var N=a+f,M=s+d,O=c+m,S=Gt(N*N+M*M+O*O),V=re(O/=S),k=T(T(O)-1)<U||T(o-p)<U?(o+p)/2:ne(M,N),F=t(k,V),v=F[0],$=F[1],b=v-r,L=$-i,g=E*b-A*L;(g*g/P>e||T((A*b+E*L)/P-.5)>.3||a*f+s*d+c*m<tf)&&(n(r,i,o,a,s,c,v,$,k,N/=S,M/=S,O,_,y),y.point(v,$),n(v,$,k,N,M,O,l,u,p,f,d,m,_,y))}}return function(r){var i,o,a,s,c,l,u,p,f,d,m,_,y={point:A,lineStart:E,lineEnd:N,polygonStart:function(){r.polygonStart(),y.lineStart=M},polygonEnd:function(){r.polygonEnd(),y.lineStart=E}};function A(V,k){V=t(V,k),r.point(V[0],V[1])}function E(){p=NaN,y.point=P,r.lineStart()}function P(V,k){var F=Jt([V,k]),v=t(V,k);n(p,f,u,d,m,_,p=v[0],f=v[1],u=V,d=F[0],m=F[1],_=F[2],Wl,r),r.point(p,f)}function N(){y.point=A,r.lineEnd()}function M(){E(),y.point=O,y.lineEnd=S}function O(V,k){P(i=V,k),o=p,a=f,s=d,c=m,l=_,y.point=P}function S(){n(p,f,u,d,m,_,o,a,i,s,c,l,Wl,r),y.lineEnd=N,N()}return y}}var rf=Rn({point:function(t,e){this.stream.point(t*Z,e*Z)}});function of(t){return Rn({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}function af(t,e,n,r,i){function o(a,s){return a*=r,s*=i,[e+t*a,n-t*s]}return o.invert=function(a,s){return[(a-e)/t*r,(n-s)/t*i]},o}function Xl(t,e,n,r,i,o){if(!o)return af(t,e,n,r,i);var a=W(o),s=j(o),c=a*t,l=s*t,u=a/t,p=s/t,f=(s*n-a*e)/t,d=(s*e+a*n)/t;function m(_,y){return _*=r,y*=i,[c*_-l*y+e,n-l*_-c*y]}return m.invert=function(_,y){return[r*(u*_-p*y+f),i*(d-p*_-u*y)]},m}function No(t){return sf(function(){return t})()}function sf(t){var e,n=150,r=480,i=250,o=0,a=0,s=0,c=0,l=0,u,p=0,f=1,d=1,m=null,_=io,y=null,A,E,P,N=Vn,M=.5,O,S,V,k,F;function v(g){return V(g[0]*Z,g[1]*Z)}function $(g){return g=V.invert(g[0],g[1]),g&&[g[0]*mt,g[1]*mt]}v.stream=function(g){return k&&F===g?k:k=rf(of(u)(_(O(N(F=g)))))},v.preclip=function(g){return arguments.length?(_=g,m=void 0,L()):_},v.postclip=function(g){return arguments.length?(N=g,y=A=E=P=null,L()):N},v.clipAngle=function(g){return arguments.length?(_=+g?El(m=g*Z):(m=null,io),L()):m*mt},v.clipExtent=function(g){return arguments.length?(N=g==null?(y=A=E=P=null,Vn):oo(y=+g[0][0],A=+g[0][1],E=+g[1][0],P=+g[1][1]),L()):y==null?null:[[y,A],[E,P]]},v.scale=function(g){return arguments.length?(n=+g,b()):n},v.translate=function(g){return arguments.length?(r=+g[0],i=+g[1],b()):[r,i]},v.center=function(g){return arguments.length?(o=g[0]%360*Z,a=g[1]%360*Z,b()):[o*mt,a*mt]},v.rotate=function(g){return arguments.length?(s=g[0]%360*Z,c=g[1]%360*Z,l=g.length>2?g[2]%360*Z:0,b()):[s*mt,c*mt,l*mt]},v.angle=function(g){return arguments.length?(p=g%360*Z,b()):p*mt},v.reflectX=function(g){return arguments.length?(f=g?-1:1,b()):f<0},v.reflectY=function(g){return arguments.length?(d=g?-1:1,b()):d<0},v.precision=function(g){return arguments.length?(O=Ao(S,M=g*g),L()):Gt(M)},v.fitExtent=function(g,G){return bo(v,g,G)},v.fitSize=function(g,G){return Tl(v,g,G)},v.fitWidth=function(g,G){return Yl(v,g,G)},v.fitHeight=function(g,G){return ql(v,g,G)};function b(){var g=Xl(n,0,0,f,d,p).apply(null,e(o,a)),G=Xl(n,r-g[0],i-g[1],f,d,p);return u=no(s,c,l),S=Cn(e,G),V=Cn(u,S),O=Ao(S,M),L()}function L(){return k=F=null,v}return function(){return e=t.apply(this,arguments),v.invert=e.invert&&$,b()}}function jr(t,e){return[t,cl(pl((ot+e)/2))]}jr.invert=function(t,e){return[t,2*Sr(ul(e))-ot]};function Jr(){return lf(jr).scale(961/at)}function lf(t){var e=No(t),n=e.center,r=e.scale,i=e.translate,o=e.clipExtent,a=null,s,c,l;e.scale=function(p){return arguments.length?(r(p),u()):r()},e.translate=function(p){return arguments.length?(i(p),u()):i()},e.center=function(p){return arguments.length?(n(p),u()):n()},e.clipExtent=function(p){return arguments.length?(p==null?a=s=c=l=null:(a=+p[0][0],s=+p[0][1],c=+p[1][0],l=+p[1][1]),u()):a==null?null:[[a,s],[c,l]]};function u(){var p=R*r(),f=e(yl(e.rotate()).invert([0,0]));return o(a==null?[[f[0]-p,f[1]-p],[f[0]+p,f[1]+p]]:t===jr?[[Math.max(f[0]-p,a),s],[Math.min(f[0]+p,c),l]]:[[a,Math.max(f[1]-p,s)],[c,Math.min(f[1]+p,l)]])}return u()}function Ie(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}var jl=Symbol("implicit");function Kr(){var t=new le,e=[],n=[],r=jl;function i(o){let a=t.get(o);if(a===void 0){if(r!==jl)return r;t.set(o,a=e.push(o)-1)}return n[a%n.length]}return i.domain=function(o){if(!arguments.length)return e.slice();e=[],t=new le;for(let a of o)t.has(a)||t.set(a,e.push(a)-1);return i},i.range=function(o){return arguments.length?(n=Array.from(o),i):n.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return Kr(e,n).unknown(r)},Ie.apply(i,arguments),i}function Qr(){var t=Kr().unknown(void 0),e=t.domain,n=t.range,r=0,i=1,o,a,s=!1,c=0,l=0,u=.5;delete t.unknown;function p(){var f=e().length,d=i<r,m=d?i:r,_=d?r:i;o=(_-m)/Math.max(1,f-c+l*2),s&&(o=Math.floor(o)),m+=(_-m-o*(f-c))*u,a=o*(1-c),s&&(m=Math.round(m),a=Math.round(a));var y=tr(f).map(function(A){return m+o*A});return n(d?y.reverse():y)}return t.domain=function(f){return arguments.length?(e(f),p()):e()},t.range=function(f){return arguments.length?([r,i]=f,r=+r,i=+i,p()):[r,i]},t.rangeRound=function(f){return[r,i]=f,r=+r,i=+i,s=!0,p()},t.bandwidth=function(){return a},t.step=function(){return o},t.round=function(f){return arguments.length?(s=!!f,p()):s},t.padding=function(f){return arguments.length?(c=Math.min(1,l=+f),p()):c},t.paddingInner=function(f){return arguments.length?(c=Math.min(1,f),p()):c},t.paddingOuter=function(f){return arguments.length?(l=+f,p()):l},t.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),p()):u},t.copy=function(){return Qr(e(),[r,i]).round(s).paddingInner(c).paddingOuter(l).align(u)},Ie.apply(p(),arguments)}function Jl(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return Jl(e())},t}function Eo(){return Jl(Qr.apply(null,arguments).paddingInner(1))}function Po(t){return function(){return t}}function Mo(t){return+t}var Kl=[0,1];function De(t){return t}function Lo(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:Po(isNaN(e)?NaN:.5)}function uf(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function cf(t,e,n){var r=t[0],i=t[1],o=e[0],a=e[1];return i<r?(r=Lo(i,r),o=n(a,o)):(r=Lo(r,i),o=n(o,a)),function(s){return o(r(s))}}function ff(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=Lo(t[a],t[a+1]),o[a]=n(e[a],e[a+1]);return function(s){var c=Ai(t,s,1,r)-1;return o[c](i[c](s))}}function Ql(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function pf(){var t=Kl,e=Kl,n=te,r,i,o,a=De,s,c,l;function u(){var f=Math.min(t.length,e.length);return a!==De&&(a=uf(t[0],t[f-1])),s=f>2?ff:cf,c=l=null,p}function p(f){return f==null||isNaN(f=+f)?o:(c||(c=s(t.map(r),e,n)))(r(a(f)))}return p.invert=function(f){return a(i((l||(l=s(e,t.map(r),ut)))(f)))},p.domain=function(f){return arguments.length?(t=Array.from(f,Mo),u()):t.slice()},p.range=function(f){return arguments.length?(e=Array.from(f),u()):e.slice()},p.rangeRound=function(f){return e=Array.from(f),n=Bi,u()},p.clamp=function(f){return arguments.length?(a=f?!0:De,u()):a!==De},p.interpolate=function(f){return arguments.length?(n=f,u()):n},p.unknown=function(f){return arguments.length?(o=f,p):o},function(f,d){return r=f,i=d,u()}}function Oo(){return pf()(De,De)}function Co(t,e,n,r){var i=Ni(t,e,n),o;switch(r=fe(r??",f"),r.type){case"s":{var a=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(o=Zi(i,a))&&(r.precision=o),Cr(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=Ii(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=Qi(i))&&(r.precision=o-(r.type==="%")*2);break}}return Or(r)}function df(t){var e=t.domain;return t.ticks=function(n){var r=e();return ze(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return Co(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,o=r.length-1,a=r[i],s=r[o],c,l,u=10;for(s<a&&(l=a,a=s,s=l,l=i,i=o,o=l);u-- >0;){if(l=sn(a,s,n),l===c)return r[i]=a,r[o]=s,e(r);if(l>0)a=Math.floor(a/l)*l,s=Math.ceil(s/l)*l;else if(l<0)a=Math.ceil(a*l)/l,s=Math.floor(s*l)/l;else break;c=l}return t},t}function me(){var t=Oo();return t.copy=function(){return Ql(t,me())},Ie.apply(t,arguments),df(t)}function ht(t){return function(){return t}}var So=Math.abs,ft=Math.atan2,he=Math.cos,Zl=Math.max,Zr=Math.min,Tt=Math.sin,Ce=Math.sqrt,vt=1e-12,tn=Math.PI,Un=tn/2,Il=2*tn;function Dl(t){return t>1?0:t<-1?tn:Math.acos(t)}function Vo(t){return t>=1?Un:t<=-1?-Un:Math.asin(t)}function Ir(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{let r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new Me(e)}function mf(t){return t.innerRadius}function hf(t){return t.outerRadius}function gf(t){return t.startAngle}function xf(t){return t.endAngle}function vf(t){return t&&t.padAngle}function _f(t,e,n,r,i,o,a,s){var c=n-t,l=r-e,u=a-i,p=s-o,f=p*c-u*l;if(!(f*f<vt))return f=(u*(e-o)-p*(t-i))/f,[t+f*c,e+f*l]}function Dr(t,e,n,r,i,o,a){var s=t-n,c=e-r,l=(a?o:-o)/Ce(s*s+c*c),u=l*c,p=-l*s,f=t+u,d=e+p,m=n+u,_=r+p,y=(f+m)/2,A=(d+_)/2,E=m-f,P=_-d,N=E*E+P*P,M=i-o,O=f*_-m*d,S=(P<0?-1:1)*Ce(Zl(0,M*M*N-O*O)),V=(O*P-E*S)/N,k=(-O*E-P*S)/N,F=(O*P+E*S)/N,v=(-O*E+P*S)/N,$=V-y,b=k-A,L=F-y,g=v-A;return $*$+b*b>L*L+g*g&&(V=F,k=v),{cx:V,cy:k,x01:-u,y01:-p,x11:V*(i/M-1),y11:k*(i/M-1)}}function ko(){var t=mf,e=hf,n=ht(0),r=null,i=gf,o=xf,a=vf,s=null,c=Ir(l);function l(){var u,p,f=+t.apply(this,arguments),d=+e.apply(this,arguments),m=i.apply(this,arguments)-Un,_=o.apply(this,arguments)-Un,y=So(_-m),A=_>m;if(s||(s=u=c()),d<f&&(p=d,d=f,f=p),!(d>vt))s.moveTo(0,0);else if(y>Il-vt)s.moveTo(d*he(m),d*Tt(m)),s.arc(0,0,d,m,_,!A),f>vt&&(s.moveTo(f*he(_),f*Tt(_)),s.arc(0,0,f,_,m,A));else{var E=m,P=_,N=m,M=_,O=y,S=y,V=a.apply(this,arguments)/2,k=V>vt&&(r?+r.apply(this,arguments):Ce(f*f+d*d)),F=Zr(So(d-f)/2,+n.apply(this,arguments)),v=F,$=F,b,L;if(k>vt){var g=Vo(k/f*Tt(V)),G=Vo(k/d*Tt(V));(O-=g*2)>vt?(g*=A?1:-1,N+=g,M-=g):(O=0,N=M=(m+_)/2),(S-=G*2)>vt?(G*=A?1:-1,E+=G,P-=G):(S=0,E=P=(m+_)/2)}var Y=d*he(E),J=d*Tt(E),X=f*he(M),Yt=f*Tt(M);if(F>vt){var _t=d*he(P),Ft=d*Tt(P),Mt=f*he(N),ie=f*Tt(N),pt;if(y<tn)if(pt=_f(Y,J,Mt,ie,_t,Ft,X,Yt)){var pi=Y-pt[0],di=J-pt[1],mi=_t-pt[0],hi=Ft-pt[1],Ho=1/Tt(Dl((pi*mi+di*hi)/(Ce(pi*pi+di*di)*Ce(mi*mi+hi*hi)))/2),Ro=Ce(pt[0]*pt[0]+pt[1]*pt[1]);v=Zr(F,(f-Ro)/(Ho-1)),$=Zr(F,(d-Ro)/(Ho+1))}else v=$=0}S>vt?$>vt?(b=Dr(Mt,ie,Y,J,d,$,A),L=Dr(_t,Ft,X,Yt,d,$,A),s.moveTo(b.cx+b.x01,b.cy+b.y01),$<F?s.arc(b.cx,b.cy,$,ft(b.y01,b.x01),ft(L.y01,L.x01),!A):(s.arc(b.cx,b.cy,$,ft(b.y01,b.x01),ft(b.y11,b.x11),!A),s.arc(0,0,d,ft(b.cy+b.y11,b.cx+b.x11),ft(L.cy+L.y11,L.cx+L.x11),!A),s.arc(L.cx,L.cy,$,ft(L.y11,L.x11),ft(L.y01,L.x01),!A))):(s.moveTo(Y,J),s.arc(0,0,d,E,P,!A)):s.moveTo(Y,J),!(f>vt)||!(O>vt)?s.lineTo(X,Yt):v>vt?(b=Dr(X,Yt,_t,Ft,f,-v,A),L=Dr(Y,J,Mt,ie,f,-v,A),s.lineTo(b.cx+b.x01,b.cy+b.y01),v<F?s.arc(b.cx,b.cy,v,ft(b.y01,b.x01),ft(L.y01,L.x01),!A):(s.arc(b.cx,b.cy,v,ft(b.y01,b.x01),ft(b.y11,b.x11),!A),s.arc(0,0,f,ft(b.cy+b.y11,b.cx+b.x11),ft(L.cy+L.y11,L.cx+L.x11),A),s.arc(L.cx,L.cy,v,ft(L.y11,L.x11),ft(L.y01,L.x01),!A))):s.arc(0,0,f,M,N,A)}if(s.closePath(),u)return s=null,u+""||null}return l.centroid=function(){var u=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,p=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-tn/2;return[he(p)*u,Tt(p)*u]},l.innerRadius=function(u){return arguments.length?(t=typeof u=="function"?u:ht(+u),l):t},l.outerRadius=function(u){return arguments.length?(e=typeof u=="function"?u:ht(+u),l):e},l.cornerRadius=function(u){return arguments.length?(n=typeof u=="function"?u:ht(+u),l):n},l.padRadius=function(u){return arguments.length?(r=u==null?null:typeof u=="function"?u:ht(+u),l):r},l.startAngle=function(u){return arguments.length?(i=typeof u=="function"?u:ht(+u),l):i},l.endAngle=function(u){return arguments.length?(o=typeof u=="function"?u:ht(+u),l):o},l.padAngle=function(u){return arguments.length?(a=typeof u=="function"?u:ht(+u),l):a},l.context=function(u){return arguments.length?(s=u??null,l):s},l}var p2=Array.prototype.slice;function tu(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function eu(t){this._context=t}eu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function nu(t){return new eu(t)}function ru(t){return t[0]}function iu(t){return t[1]}function Go(t,e){var n=ht(!0),r=null,i=nu,o=null,a=Ir(s);t=typeof t=="function"?t:t===void 0?ru:ht(t),e=typeof e=="function"?e:e===void 0?iu:ht(e);function s(c){var l,u=(c=tu(c)).length,p,f=!1,d;for(r==null&&(o=i(d=a())),l=0;l<=u;++l)!(l<u&&n(p=c[l],l,c))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+t(p,l,c),+e(p,l,c));if(d)return o=null,d+""||null}return s.x=function(c){return arguments.length?(t=typeof c=="function"?c:ht(+c),s):t},s.y=function(c){return arguments.length?(e=typeof c=="function"?c:ht(+c),s):e},s.defined=function(c){return arguments.length?(n=typeof c=="function"?c:ht(!!c),s):n},s.curve=function(c){return arguments.length?(i=c,r!=null&&(o=i(r)),s):i},s.context=function(c){return arguments.length?(c==null?r=o=null:o=i(r=c),s):r},s}function ge(t,e,n){this.k=t,this.x=e,this.y=n}ge.prototype={constructor:ge,scale:function(t){return t===1?this:new ge(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new ge(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Fo=new ge(1,0,0);$o.prototype=ge.prototype;function $o(t){for(;!t.__zoom;)if(!(t=t.parentNode))return Fo;return t.__zoom}var ei=class t{data=[];marginTop=24;marginRight=0;marginBottom=28;marginLeft=56;groupGap=.2;barGap=.2;tickInnerGap=16;tickCount=4;onPointer=new Ot;_elementRef=D(se);_commonService=D(Nt);width=124;height=124;svg;chartG;yAxisG;yScale;groups=[];subgroups=[];_destroy=new Lt;ngAfterViewInit(){this._initializeChart(),this._commonService.createResizeObservable(this._elementRef.nativeElement).pipe($t(this._destroy),ae(50),oe(0)).subscribe(()=>this._updateChartLayout(this.data))}ngOnChanges(e){if(this.svg){if(e.width||e.height||e.marginTop||e.marginRight||e.marginBottom||e.marginLeft||e.groupGap||e.barGap){let n=e.data?e.data.currentValue:this.data;this._updateChartLayout(n)}e.data&&this._updateChartRender(e.data.currentValue)}}ngOnDestroy(){this._destroy.next(null),this._destroy.complete()}_initializeChart(){this.svg=Dt(this._elementRef.nativeElement).append("svg"),this.yAxisG=this.svg.append("g"),this.chartG=this.svg.append("g"),this._updateChartLayout(this.data)}_updateChartLayout(e){this.width=this._elementRef.nativeElement.clientWidth,this.height=this._elementRef.nativeElement.clientHeight,this.svg.attr("width",this.width).attr("height",this.height).attr("viewBox",[0,0,this.width,this.height]),this._updateChartRender(e)}_updateChartRender(e){this.groups=Array.from(new Set(e.map(i=>i.groupId))),this.subgroups=Array.from(new Set(e.map(i=>i.subgroupId)));let n=this.width-this.marginLeft-this.tickInnerGap-this.marginRight,r=this.groups.length===0?0:n/this.groups.length;this._updateYAxis(n,e),this._updateGroupBars(r,e),this._updateLabels(r)}_calculateTickValues(e,n){let r=ze(0,e,n);r[r.length-1]<e&&(r[r.length]=r[r.length-1]+r[1]);let i=r[r.length-1]/n,o=String(i).length;if(o>=4){let c=Number(String(i).slice(0,1)),l=Number(String(i).slice(1,2));l<5&&l!==0?l=5:l>5&&(c+=1,l=0),i=Number(`${c}${l}`.padEnd(o,"0"))}let a=[0,1e3,2e3,3e3,4e3],s=Array(n+1).fill(i).map((c,l)=>c*l);return s.every(c=>c===0)?a:s}_updateYAxis(e,n){let r=Dn(n,c=>c.value)??0,i=this._calculateTickValues(r,this.tickCount);this.yScale=me().domain([0,i[i.length-1]]).range([this.height-this.marginBottom,this.marginTop]);let o=1e4,a=i[1]>=o,s=un(this.yScale).tickValues(i).tickFormat(c=>{let l=Number(c),u=a?l/o:l,p=a&&u?"\u842C":"";return Math.trunc(u).toLocaleString()+p}).tickPadding(this.marginLeft-this.tickInnerGap).tickSizeInner(0).tickSizeOuter(0);this.yAxisG.attr("transform",`translate(${this.marginLeft+this.tickInnerGap},0)`).call(s).call(c=>c.select(".domain").remove()).call(c=>{c.selectAll(".tick line").attr("x2",e).attr("stroke","#DEE2E6"),c.selectAll(".tick text").attr("class","d3-chart-label")})}_updateGroupBars(e,n){let r=e*(1-this.groupGap)/this.subgroups.length,i=Ue(n,l=>l.groupId),o=this.chartG.selectAll("g.d3-chart-data-group").data(Array.from(i.entries()));o.exit().remove();let c=o.enter().append("g").attr("class","d3-chart-data-group").merge(o).attr("transform",(l,u)=>`translate(${this.marginLeft+this.tickInnerGap+u*e},0)`).on("pointerover",(l,u)=>this.onPointer.emit({event:l,data:u[1]})).on("pointerleave",(l,u)=>this.onPointer.emit({event:l,data:u[1]})).selectAll("rect").data(([l,u])=>u);c.exit().remove(),c.enter().append("rect").merge(c).transition().duration(500).attr("x",l=>this.subgroups.indexOf(l.subgroupId)*r+this.groupGap*e/2).attr("y",l=>this.yScale(l.value)).attr("width",r*(1-this.barGap)).attr("height",l=>this.yScale(0)-this.yScale(l.value)).attr("fill",l=>l.color)}_updateLabels(e){let n=this.svg.selectAll("text.d3-chart-x-label").data(this.groups);n.exit().remove(),n.enter().append("text").attr("class","d3-chart-label d3-chart-x-label").merge(n).attr("x",(r,i)=>this.marginLeft+this.tickInnerGap+i*e+e/2).attr("y",this.height).text(r=>r)}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=q({type:t,selectors:[["app-grouped-bar-chart"]],hostAttrs:[1,"block"],inputs:{data:"data",marginTop:"marginTop",marginRight:"marginRight",marginBottom:"marginBottom",marginLeft:"marginLeft",groupGap:"groupGap",barGap:"barGap",tickInnerGap:"tickInnerGap",tickCount:"tickCount"},outputs:{onPointer:"onPointer"},features:[dt],decls:0,vars:0,template:function(n,r){},encapsulation:2})};var yf=()=>[];function wf(t,e){if(t&1&&(H(0,"div",6),x(1,"div",7),C(2),h()),t&2){let n=e.$implicit;Ct("background",n.REPRESENTATIVE_COLOR),w(2),et(n.CN_FULL_NAME)}}function bf(t,e){t&1&&H(0,"div",8)}function Af(t,e){t&1&&(x(0,"div",5),rt(1,bf,1,0,"div",8,At),h()),t&2&&(w(),it(Ve(0,yf).constructor(4)))}function Nf(t,e){t&1&&(x(0,"div",10),C(1,"\u66AB\u7121\u8CC7\u6599"),h())}function Ef(t,e){if(t&1){let n=St();x(0,"app-grouped-bar-chart",9),tt("onPointer",function(i){wt(n);let o=z();return bt(o.toggleVotesOverlay(i))}),h(),Q(1,Nf,2,0,"div",10)}if(t&2){let n=z();B("data",n.historicalVoteCounts),w(),K(n.historicalVoteCounts.length===0?1:-1)}}var ni=class t{isLoaded;activePartyOrder=[];historicalVoteCounts=[];toggleVotesOverlay(e){}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=q({type:t,selectors:[["app-historical-party-vote-counts"]],inputs:{isLoaded:"isLoaded",activePartyOrder:"activePartyOrder",historicalVoteCounts:"historicalVoteCounts"},decls:10,vars:1,consts:[[1,"rounded-xl","border","border-solid","border-gray-300","bg-white"],[1,"flex","items-center","justify-between","px-4","pb-3","pt-6"],[1,"text-xl","font-bold","text-dark"],[1,"flex","items-center","gap-x-1"],[1,"relative","h-64","px-4","pb-6","pt-3"],[1,"flex","h-full","flex-col","justify-evenly"],[1,"h-2","w-2","rounded-full"],[1,"text-xs","leading-5","text-dark"],[1,"cmp-loading","h-8"],[1,"block","h-full",3,"onPointer","data"],[1,"-translate-1/2","absolute","left-1/2","top-1/2","text-base","text-dark"]],template:function(n,r){n&1&&(x(0,"div",0)(1,"div",1)(2,"h5",2),C(3,"\u6B77\u5C46\u653F\u9EE8\u5F97\u7968\u6578"),h(),x(4,"div",3),rt(5,wf,3,3,null,null,At),h()(),x(7,"div",4),Q(8,Af,3,1,"div",5)(9,Ef,2,2),h()()),n&2&&(w(5),it(r.activePartyOrder),w(3),K(r.isLoaded?9:8))},dependencies:[ei],encapsulation:2})};var ri=class t{data=[];marginTop=24;marginRight=0;marginBottom=28;marginLeft=56;groupGap=.2;barGap=.2;tickInnerGap=16;tickCount=4;onPointer=new Ot;_elementRef=D(se);_commonService=D(Nt);width=124;height=124;svg;chartG;yAxisG;yScale;groups=[];subgroups=[];_destroy=new Lt;ngAfterViewInit(){this._initializeChart(),this._commonService.createResizeObservable(this._elementRef.nativeElement).pipe($t(this._destroy),ae(50),oe(0)).subscribe(()=>this._updateChartLayout(this.data))}ngOnChanges(e){if(this.svg){if(e.width||e.height||e.marginTop||e.marginRight||e.marginBottom||e.marginLeft||e.groupGap||e.barGap){let n=e.data?e.data.currentValue:this.data;this._updateChartLayout(n)}e.data&&this._updateChartRender(e.data.currentValue)}}ngOnDestroy(){this._destroy.next(null),this._destroy.complete()}_initializeChart(){this.svg=Dt(this._elementRef.nativeElement).append("svg"),this.yAxisG=this.svg.append("g"),this.chartG=this.svg.append("g"),this._updateChartLayout(this.data)}_updateChartLayout(e){this.width=this._elementRef.nativeElement.clientWidth,this.height=this._elementRef.nativeElement.clientHeight,this.svg.attr("width",this.width).attr("height",this.height).attr("viewBox",[0,0,this.width,this.height]),this._updateChartRender(e)}_updateChartRender(e){this.groups=Array.from(new Set(e.map(i=>i.groupId))),this.subgroups=Array.from(new Set(e.map(i=>i.subgroupId)));let n=this.width-this.marginLeft-this.tickInnerGap-this.marginRight,r=this.groups.length===0?0:n/this.groups.length;this._updateYAxis(n),this._updateGroupLines(r,e),this._updateLabels(r)}_updateYAxis(e){this.yScale=me().domain([0,1]).range([this.height-this.marginBottom,this.marginTop]);let n=un(this.yScale).tickValues([0,.2,.4,.6,.8,1]).tickFormat(r=>Number(r)*100+"%").tickPadding(this.marginLeft-this.tickInnerGap).tickSizeInner(0).tickSizeOuter(0);this.yAxisG.attr("transform",`translate(${this.marginLeft+this.tickInnerGap},0)`).call(n).call(r=>r.select(".domain").remove()).call(r=>{r.selectAll(".tick line").attr("x2",e).attr("stroke","#DEE2E6"),r.selectAll(".tick text").attr("class","d3-chart-label")})}_updateGroupLines(e,n){let r=Ue(n,m=>m.subgroupId),i=Array.from(new Set(n.map(m=>m.groupId))),o=Eo().domain(i).range([this.marginLeft+this.tickInnerGap+e/2,this.width-this.marginRight-e/2]),a=me().domain([0,1]).range([this.height-this.marginBottom,this.marginTop]),s=Go().x(m=>o(m.groupId)??0).y(m=>a(m.value)),c=this.chartG.selectAll("g.d3-chart-data-group").data(r);c.exit().remove();let u=c.enter().append("g").attr("class","d3-chart-data-group").merge(c),p=u.selectAll("path").data(m=>[m[1]]);p.exit().remove(),p.enter().append("path").merge(p).transition().duration(500).attr("fill","none").attr("stroke",m=>m[0].color).attr("stroke-width",1.5).attr("d",m=>s(m));let f=u.selectAll("circle").data(m=>m[1]);f.exit().remove();let d=f.enter().append("circle");d.merge(f).transition().duration(500).attr("cx",m=>o(m.groupId)??0).attr("cy",m=>a(m.value)).attr("r",3).attr("fill",m=>m.color),f.merge(d).on("pointerover",(m,_)=>{let y=n.filter(A=>A.groupId===_.groupId);this.onPointer.emit({event:m,data:y})}).on("pointerleave",(m,_)=>{let y=n.filter(A=>A.groupId===_.groupId);this.onPointer.emit({event:m,data:y})}),this._updateLabels(e)}_updateLabels(e){let n=this.svg.selectAll("text.d3-chart-x-label").data(this.groups);n.exit().remove(),n.enter().append("text").attr("class","d3-chart-label d3-chart-x-label").merge(n).attr("x",(r,i)=>this.marginLeft+this.tickInnerGap+i*e+e/2).attr("y",this.height).text(r=>r)}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=q({type:t,selectors:[["app-grouped-line-chart"]],hostAttrs:[1,"block"],inputs:{data:"data",marginTop:"marginTop",marginRight:"marginRight",marginBottom:"marginBottom",marginLeft:"marginLeft",groupGap:"groupGap",barGap:"barGap",tickInnerGap:"tickInnerGap",tickCount:"tickCount"},outputs:{onPointer:"onPointer"},features:[dt],decls:0,vars:0,template:function(n,r){},encapsulation:2})};var Pf=()=>[];function Mf(t,e){if(t&1&&(H(0,"div",6),x(1,"div",7),C(2),h()),t&2){let n=e.$implicit;Ct("background",n.REPRESENTATIVE_COLOR),w(2),et(n.CN_FULL_NAME)}}function Lf(t,e){t&1&&H(0,"div",8)}function Of(t,e){t&1&&(x(0,"div",5),rt(1,Lf,1,0,"div",8,At),h()),t&2&&(w(),it(Ve(0,Pf).constructor(4)))}function Cf(t,e){t&1&&(x(0,"div",10),C(1,"\u66AB\u7121\u8CC7\u6599"),h())}function Sf(t,e){if(t&1){let n=St();x(0,"app-grouped-line-chart",9),tt("onPointer",function(i){wt(n);let o=z();return bt(o.toggleVotesOverlay(i))}),h(),Q(1,Cf,2,0,"div",10)}if(t&2){let n=z();B("data",n.historicalVoteRates),w(),K(n.historicalVoteRates.length===0?1:-1)}}var ii=class t{isLoaded;activePartyOrder=[];historicalVoteRates=[];toggleVotesOverlay(e){}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=q({type:t,selectors:[["app-historical-party-vote-rates"]],inputs:{isLoaded:"isLoaded",activePartyOrder:"activePartyOrder",historicalVoteRates:"historicalVoteRates"},decls:10,vars:1,consts:[[1,"rounded-xl","border","border-solid","border-gray-300","bg-white"],[1,"flex","items-center","justify-between","px-4","pb-3","pt-6"],[1,"text-xl","font-bold","text-dark"],[1,"flex","items-center","gap-x-1"],[1,"relative","h-64","px-4","pb-6","pt-3"],[1,"flex","h-full","flex-col","justify-evenly"],[1,"h-2","w-2","rounded-full"],[1,"text-xs","leading-5","text-dark"],[1,"cmp-loading","h-8"],[1,"block","h-full",3,"onPointer","data"],[1,"-translate-1/2","absolute","left-1/2","top-1/2","text-base","text-dark"]],template:function(n,r){n&1&&(x(0,"div",0)(1,"div",1)(2,"h5",2),C(3,"\u6B77\u5C46\u653F\u9EE8\u5F97\u7968\u7387"),h(),x(4,"div",3),rt(5,Mf,3,3,null,null,At),h()(),x(7,"div",4),Q(8,Of,3,1,"div",5)(9,Sf,2,2),h()()),n&2&&(w(5),it(r.activePartyOrder),w(3),K(r.isLoaded?9:8))},dependencies:[ri],encapsulation:2})};var oi=class t{turnoutRate=null;_elementRef=D(se);_commonService=D(Nt);_width=124;_height=124;_svg;_g;_background;_foreground;_arc;_tau=2*Math.PI;_destroy=new Lt;ngOnChanges(e){let{turnoutRate:n}=e;n&&this._updatePipRender(n.currentValue)}ngAfterViewInit(){this._commonService.createResizeObservable(this._elementRef.nativeElement).pipe($t(this._destroy),ae(50),oe(0)).subscribe(()=>this._updatePipLayout()),this._initializeChart()}ngOnDestroy(){this._destroy.next(null),this._destroy.complete()}_initializeChart(){let n=Math.min(this._height,this._width)/2,r=n-12;this._svg=Dt(this._elementRef.nativeElement).append("svg"),this._g=this._svg.append("g"),this._arc=ko().innerRadius(r).outerRadius(n).startAngle(0),this._background=this._g.append("path").datum({endAngle:this._tau}).style("fill","#E2E8F0").attr("d",this._arc),this._foreground=this._g.append("path").datum({endAngle:0*this._tau}).style("fill","#D4009B").attr("d",this._arc),this._updatePipLayout(),this._updatePipRender(this.turnoutRate)}_updatePipLayout(){this._width=this._elementRef.nativeElement.clientWidth,this._height=this._elementRef.nativeElement.clientHeight,this._svg.attr("viewBox",[0,0,this._width,this._height]),this._g.attr("transform","translate("+this._width/2+","+this._height/2+")"),this._background.attr("d",this._arc),this._foreground.attr("d",this._arc)}_updatePipRender(e){this._foreground&&this._foreground.transition().duration(750).attrTween("d",this._arcTween((e||0)/100*this._tau))}_arcTween(e){return n=>{let r=te(n.endAngle,e);return i=>(n.endAngle=r(i),this._arc(n)||"")}}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=q({type:t,selectors:[["app-pip-chart"]],inputs:{turnoutRate:"turnoutRate"},features:[dt],decls:0,vars:0,template:function(n,r){},encapsulation:2})};var Vf=(t,e)=>({"h-2":t,"h-[18px]":e}),kf=t=>({"bg-gray-200":t});function Gf(t,e){if(t&1&&(C(0),lt(1,"number")),t&2){let n=z().$implicit,r=z();Vt(" ",ve(1,1,n.voteCount/r.totalVote*100,"1.2-2"),"% ")}}function Ff(t,e){if(t&1&&(x(0,"div",2),Q(1,Gf,2,4),h()),t&2){let n=e.$implicit,r=z();Ct("flex-basis",n.voteCount/r.totalVote*100+1,"%")("background",r.POLITICAL_PARTIES[n.party]?r.POLITICAL_PARTIES[n.party].REPRESENTATIVE_COLOR:""),B("ngClass",Bt(6,kf,!r.POLITICAL_PARTIES[n.party])),w(),K(r.visibleDesc?1:-1)}}var en=class t{visibleDesc;votePercentage;POLITICAL_PARTIES=qt;totalVote=0;ngOnChanges(e){let{votePercentage:n}=e;n&&(this.totalVote=n.currentValue.reduce((r,i)=>r+(i.voteCount||0),0))}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=q({type:t,selectors:[["app-vote-percentage-bar"]],hostAttrs:[1,"block"],inputs:{visibleDesc:"visibleDesc",votePercentage:"votePercentage"},features:[dt],decls:3,vars:4,consts:[[1,"flex","w-full","overflow-hidden","rounded-[500px]",3,"ngClass"],[1,"flex","min-h-full","items-center","justify-center","overflow-hidden","text-sm","leading-[18px]","text-white",3,"ngClass","flex-basis","background"],[1,"flex","min-h-full","items-center","justify-center","overflow-hidden","text-sm","leading-[18px]","text-white",3,"ngClass"]],template:function(n,r){n&1&&(x(0,"div",0),rt(1,Ff,2,8,"div",1,At),h()),n&2&&(B("ngClass",Tn(1,Vf,!r.visibleDesc,r.visibleDesc)),w(),it(r.votePercentage))},dependencies:[Yn,ke],encapsulation:2})};var au=t=>({"cmp-loading":t}),Se=t=>({"cmp-loading after:max-w-[90%]":t}),$f=(t,e,n)=>({"md:justify-start":t,"md:justify-center":e,"md:justify-end":n}),Bf=(t,e)=>({"cmp-loading":t,"bg-gray-200":e});function Hf(t,e){if(t&1&&(x(0,"div",27),H(1,"img",28),h()),t&2){let n=e;Ct("background",n.REPRESENTATIVE_COLOR),w(),B("src",n.PRESIDENT_3D_IMG,on)("alt",n.EN_SHORT_NAME)}}function Rf(t,e){t&1&&(jo(),x(0,"svg",25),H(1,"path",29),h())}function Uf(t,e){if(t&1&&(x(0,"div",5)(1,"div",18)(2,"div",19),Q(3,Hf,2,4,"div",20),h(),x(4,"div",21)(5,"div",22),C(6),h(),x(7,"div",23)(8,"div",24),C(9),h(),Q(10,Rf,2,0,":svg:svg",25),h(),x(11,"div",26),C(12),lt(13,"number"),h()()()()),t&2){let n,r=e.$implicit,i=e.$index,o=e.$index,a=z();B("ngClass",Ko(12,$f,i===0,i===1,i===2)),w(2),B("ngClass",Tn(16,Bf,!a.isLoaded,a.isLoaded&&!a.electionInfo)),w(),K((n=a.POLITICAL_PARTIES[r.PARTY])?3:-1,n),w(2),B("ngClass",Bt(19,Se,!a.isLoaded)),w(),Vt(" ",a.POLITICAL_PARTIES[r.PARTY]?a.POLITICAL_PARTIES[r.PARTY].CN_FULL_NAME:"\u66AB\u7121\u8CC7\u6599"," "),w(),B("ngClass",Bt(21,Se,!a.isLoaded)),w(2),et(r.PRESIDENT||"\u66AB\u7121\u8CC7\u6599"),w(),K(a.electionInfo&&o===0&&a.candidatesVotes[i].VOTE_COUNT?10:-1),w(),B("ngClass",Bt(23,Se,!a.isLoaded)),w(),Vt(" ",Ht(13,10,a.candidatesVotes[i].VOTE_COUNT||0),"\u7968 ")}}var ai=class t{isLoaded;electionInfo;candidateNoOrder=[];POLITICAL_PARTIES=qt;candidates;candidatesVotes;totalStatistics;votePercentage=[];ngOnChanges(e){let{electionInfo:n,candidateNoOrder:r}=e;if(n){let i=n.currentValue;this.candidates=i?[...i.CANDIDATES]:Array(3).fill(new Re),this.candidatesVotes=i?[...i.TOTAL_STATISTICS.CANDIDATES_VOTES]:Array(3).fill(new He),this.totalStatistics=i?xe({},i.TOTAL_STATISTICS):new _e}if(r){let i=r.currentValue;i.length>0&&(this.candidates=i.map(o=>o-1).reduce((o,a,s)=>(o[s]=this.candidates[a],o),[]),this.candidatesVotes=i.map(o=>o-1).reduce((o,a,s)=>(o[s]=this.candidatesVotes[a],o),[]))}if(n){let i=n.currentValue;this.votePercentage=i?this.candidates.map((o,a)=>({party:o.PARTY||"",voteCount:this.candidatesVotes[a].VOTE_COUNT||0})):[{party:"",voteCount:1}]}}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=q({type:t,selectors:[["app-presidential-votes"]],inputs:{isLoaded:"isLoaded",electionInfo:"electionInfo",candidateNoOrder:"candidateNoOrder"},features:[dt],decls:46,vars:38,consts:[[1,"rounded-xl","bg-gray-200","px-4","pb-4","pt-6"],[1,"mb-4","text-xl","font-bold","text-dark"],[1,"grid","gap-4","xl:grid-flow-col","xl:grid-cols-2","2xl:grid-cols-[3fr_2fr]","3xl:grid-cols-2"],[1,"grid","gap-y-3","rounded-xl","bg-white","px-6","py-4","md:py-8"],[1,"grid","gap-y-2","md:grid-flow-col","md:grid-cols-3"],[1,"flex",3,"ngClass"],[3,"ngClass","votePercentage","visibleDesc"],[1,"rounded-xl","bg-white","px-6","py-4","md:py-8"],[1,"flex","h-full","items-center"],[1,"basis-40","sm:grow","md:basis-32"],[1,"relative","h-[124px]","w-[124px]","overflow-hidden","rounded-full",3,"ngClass"],[1,"absolute","left-0","top-0","flex","h-full","w-full","flex-col","items-center","justify-center","gap-y-1"],[1,"text-sm","text-light"],[1,"ps-1","text-xl","font-bold","text-primary"],[1,"block","h-full","w-full",3,"turnoutRate"],[1,"grid-col-1","grid","grow-[5]","auto-rows-fr","gap-x-2","gap-y-4","sm:grid-cols-2"],[1,"statistic-item",3,"ngClass"],[1,"font-bold","text-dark"],[1,"grid","w-full","basis-[200px]","grid-flow-col","grid-cols-[auto_1fr]","gap-x-3"],[1,"h-12","w-12","overflow-hidden","rounded-2xl",3,"ngClass"],[1,"flex","h-full","w-full","items-center","justify-center",3,"background"],[1,"grid","grid-flow-row","gap-y-[2px]"],[1,"text-sm","text-light",3,"ngClass"],[1,"flex","items-center","justify-start","gap-x-1",3,"ngClass"],[1,"text-dark"],["width","18","height","18","viewBox","0 0 18 18","fill","none","xmlns","http://www.w3.org/2000/svg"],[1,"font-bold","text-dark",3,"ngClass"],[1,"flex","h-full","w-full","items-center","justify-center"],[1,"pointer-events-none","translate-y-[23%]","scale-[135%]",3,"src","alt"],["d","M7.32031 13.1797L14.8203 5.67969L13.6484 4.46875L7.32031 10.7969L4.35156 7.82812L3.17969 9L7.32031 13.1797ZM3.10156 3.14062C4.74219 1.5 6.70833 0.679688 9 0.679688C11.2917 0.679688 13.2448 1.5 14.8594 3.14062C16.5 4.75521 17.3203 6.70833 17.3203 9C17.3203 11.2917 16.5 13.2578 14.8594 14.8984C13.2448 16.513 11.2917 17.3203 9 17.3203C6.70833 17.3203 4.74219 16.513 3.10156 14.8984C1.48698 13.2578 0.679688 11.2917 0.679688 9C0.679688 6.70833 1.48698 4.75521 3.10156 3.14062Z","fill","#D4009B"]],template:function(n,r){n&1&&(x(0,"div",0)(1,"h5",1),C(2,"\u7E3D\u7D71\u5F97\u7968\u6578"),h(),x(3,"div",2)(4,"div",3)(5,"div",4),rt(6,Uf,14,25,"div",5,At),h(),x(8,"div"),H(9,"app-vote-percentage-bar",6),h()(),x(10,"div",7)(11,"div",8)(12,"div",9)(13,"div",10)(14,"div",11)(15,"div",12),C(16,"\u6295\u7968\u7387"),h(),x(17,"div",13),C(18),lt(19,"number"),h()(),H(20,"app-pip-chart",14),h()(),x(21,"div",15)(22,"div",16)(23,"div",12),C(24,"\u6295\u7968\u6578"),h(),x(25,"div",17),C(26),lt(27,"number"),h()(),x(28,"div",16)(29,"div",12),C(30,"\u6295\u7968\u7387"),h(),x(31,"div",17),C(32),lt(33,"number"),h()(),x(34,"div",16)(35,"div",12),C(36,"\u6709\u6548\u7968\u6578"),h(),x(37,"div",17),C(38),lt(39,"number"),h()(),x(40,"div",16)(41,"div",12),C(42,"\u7121\u6548\u7968\u6578"),h(),x(43,"div",17),C(44),lt(45,"number"),h()()()()()()()),n&2&&(w(6),it(r.candidates),w(3),B("ngClass",Bt(26,au,!r.isLoaded))("votePercentage",r.votePercentage)("visibleDesc",!0),w(4),B("ngClass",Bt(28,au,!r.isLoaded)),w(5),Vt(" ",r.electionInfo?ve(19,14,r.totalStatistics.TURNOUT_RATE||0,"1.2-2")+"%":"\u66AB\u7121\u8CC7\u6599"," "),w(2),B("turnoutRate",r.totalStatistics.TURNOUT_RATE),w(2),B("ngClass",Bt(30,Se,!r.isLoaded)),w(4),et(Ht(27,17,r.totalStatistics.TOTAL_VOTES||0)),w(2),B("ngClass",Bt(32,Se,!r.isLoaded)),w(4),Vt("",ve(33,19,r.totalStatistics.TURNOUT_RATE||0,"1.2-2"),"%"),w(2),B("ngClass",Bt(34,Se,!r.isLoaded)),w(4),et(Ht(39,22,r.totalStatistics.VALID_VOTES||0)),w(2),B("ngClass",Bt(36,Se,!r.isLoaded)),w(4),et(Ht(45,24,r.totalStatistics.INVALID_VOTES||0)))},dependencies:[Yn,ke,en,oi],styles:[".statistic-item[_ngcontent-%COMP%]{display:grid;grid-template-rows:auto 1fr;row-gap:.25rem}"]})};function zf(t,e){t&1&&(x(0,"div",10)(1,"div",11),H(2,"img",12),h()())}function Tf(t,e){if(t&1){let n=St();x(0,"tr",2),tt("click",function(){let i=wt(n).$implicit,o=z();return bt(o.onItemClick(i.ADMIN_CODE))}),x(1,"td"),C(2),h(),x(3,"td")(4,"div",3)(5,"div",4)(6,"span",5),C(7,"\u7576\u9078\u4EBA"),h(),x(8,"div",6),H(9,"img",7),h(),C(10),h(),H(11,"app-vote-percentage-bar",8),h()(),x(12,"td")(13,"div",9)(14,"div",6),H(15,"img",7),h(),C(16),h()(),x(17,"td"),C(18),lt(19,"number"),h(),x(20,"td"),C(21),lt(22,"number"),h(),x(23,"td"),Q(24,zf,3,0,"div",10),h()()}if(t&2){let n=e.$implicit;Jo("cursor-pointer",n.ADMIN_CODE),w(2),et(n.ADMIN_NAME),w(6),Ct("background",n.WINNER_COLOR),w(),B("src",n.WINNER_IMG,on),w(),Vt(" ",n.WINNER_NAME," "),w(),B("votePercentage",n.VOTE_PERCENTAGE)("visibleDesc",!1),w(3),Ct("background",n.WINNER_COLOR),w(),B("src",n.WINNER_IMG,on),w(),Vt(" ",n.WINNER_NAME," "),w(2),et(Ht(19,16,n.TOTAL_VOTES)),w(3),Vt("",ve(22,18,n.TURNOUT_RATE,"1.2-2"),"%"),w(3),K(n.ADMIN_CODE?24:-1)}}var si=class t{electionInfo;candidateNoOrder=[];adminChange$=new Ot;data=[];ngOnChanges(e){let{electionInfo:n}=e;n&&setTimeout(()=>this._handleTableData(),0)}_handleTableData(){if(!this.electionInfo){this.data=[];return}this.data=this.electionInfo.ADMIN_COLLECTION.map(e=>{let n=this.candidateNoOrder.map(o=>o-1).map(o=>({party:this.electionInfo?.CANDIDATES[o]?.PARTY||"",voteCount:e.CANDIDATES_VOTES[o].VOTE_COUNT||0})),r=e.CANDIDATES_VOTES.reduce((o,a)=>(a.VOTE_COUNT||0)>(o.VOTE_COUNT||0)?a:o).NO,i=this.electionInfo?.CANDIDATES.find(o=>o.NO==r);return{ADMIN_NAME:e.ADMIN_NAME,ADMIN_CODE:e.ADMIN_CODE,VOTE_PERCENTAGE:n,WINNER_NAME:i?.PRESIDENT||"Unknown Winner",WINNER_IMG:i?qt[i.PARTY].PRESIDENT_3D_IMG:"",WINNER_COLOR:i?qt[i.PARTY].REPRESENTATIVE_COLOR:"",TOTAL_VOTES:e.TOTAL_VOTES,TURNOUT_RATE:e.TURNOUT_RATE}})}onItemClick(e){e&&this.adminChange$.emit(e)}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=q({type:t,selectors:[["app-voting-overview"]],inputs:{electionInfo:"electionInfo",candidateNoOrder:"candidateNoOrder"},outputs:{adminChange$:"adminChange$"},features:[dt],decls:19,vars:0,consts:[[1,"mb-2","mt-4","text-xl","font-bold","text-dark"],[3,"cursor-pointer"],[3,"click"],[1,"grid","gap-y-1"],[1,"flex","items-center","gap-x-2","md:hidden"],[1,"text-light"],[1,"h-8","w-8","overflow-hidden","rounded-full"],["alt","winner_img",1,"pointer-events-none","translate-y-1.5","scale-125",3,"src"],[1,"py-1",3,"votePercentage","visibleDesc"],[1,"flex","items-center","gap-x-1"],[1,"flex","items-center","justify-end"],[1,"flex","h-9","w-9","items-center","justify-center"],["src","images/icons/expand_more.png","alt","expand_more",1,"-rotate-90"]],template:function(n,r){n&1&&(x(0,"h5",0),C(1,"\u5404\u5340\u57DF\u6295\u7968\u7E3D\u89BD"),h(),x(2,"table")(3,"thead")(4,"tr")(5,"th"),C(6,"\u5730\u5340"),h(),x(7,"th"),C(8,"\u5F97\u7968\u7387"),h(),x(9,"th"),C(10,"\u7576\u9078\u4EBA"),h(),x(11,"th"),C(12,"\u6295\u7968\u6578"),h(),x(13,"th"),C(14,"\u6295\u7968\u7387"),h(),H(15,"th"),h()(),x(16,"tbody"),rt(17,Tf,25,21,"tr",1,At),h()()),n&2&&(w(17),it(r.data))},dependencies:[ke,en],styles:["table[_ngcontent-%COMP%]{width:100%;text-wrap:nowrap;text-align:left;font-size:.875rem;line-height:1.25rem;--tw-text-opacity: 1;color:rgb(51 65 85 / var(--tw-text-opacity, 1))}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{--tw-bg-opacity: 1;background-color:rgb(233 236 239 / var(--tw-bg-opacity, 1))}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:400}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child{border-top-left-radius:.25rem}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{border-top-right-radius:.25rem}@media (min-width: 768px){thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(1){width:16%}}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(2){width:100%}@media (min-width: 768px){thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(2){width:24%}}@media (min-width: 768px){thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(3){width:8%}}@media (min-width: 768px){thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(4){width:16%}}@media (min-width: 768px){thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(5){width:16%}}@media (min-width: 768px){thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:nth-child(6){width:20%}}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom-width:1px;border-style:solid;--tw-border-opacity: 1;border-color:rgb(222 226 230 / var(--tw-border-opacity, 1))}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{vertical-align:baseline}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{font-weight:700}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{line-height:2rem}@media (min-width: 768px){tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{vertical-align:middle}}@media (min-width: 768px){tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:first-child{line-height:1.25rem}}tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-top:.75rem;padding-bottom:.75rem}@media (min-width: 768px){tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-top:.25rem;padding-bottom:.25rem;padding-inline-end:1.5rem}}[_ngcontent-%COMP%]:is(tr th,tr td):first-child{padding-inline-end:2rem}[_ngcontent-%COMP%]:is(tr th,tr td):first-child{padding-inline-start:.5rem}@media (min-width: 768px){[_ngcontent-%COMP%]:is(tr th,tr td):first-child{padding-inline-end:1.5rem}}:is(tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]):is([_ngcontent-%COMP%]:nth-child(4), [_ngcontent-%COMP%]:nth-child(5)){text-align:right}:is(tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]):is([_ngcontent-%COMP%]:nth-child(3), [_ngcontent-%COMP%]:nth-child(4), [_ngcontent-%COMP%]:nth-child(5)){display:none}@media (min-width: 768px){:is(tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]):is([_ngcontent-%COMP%]:nth-child(3), [_ngcontent-%COMP%]:nth-child(4), [_ngcontent-%COMP%]:nth-child(5)){display:table-cell}}"]})};var li=class t{static \u0275fac=function(n){return new(n||t)};static \u0275cmp=q({type:t,selectors:[["app-footer"]],decls:1,vars:0,template:function(n,r){n&1&&C(0,"\u7248\u6B0A\u6240\u6709\xA92023 \u53F0\u7063\u6B77\u5E74\u7E3D\u7D71 \u90FD\u5E7E?")},styles:["[_nghost-%COMP%]{display:flex;align-items:center;justify-content:center;--tw-bg-opacity: 1;background-color:rgb(233 236 239 / var(--tw-bg-opacity, 1));padding-top:1rem;padding-bottom:1rem;font-size:.875rem;line-height:1.25rem;--tw-text-opacity: 1;color:rgb(51 65 85 / var(--tw-text-opacity, 1))}"]})};function Yf(t,e){if(t&1&&(x(0,"div",1),H(1,"div",2),lt(2,"async"),h()),t&2){let n=z();w(),Ct("width",Ht(2,2,n.totalProgress$),"%")}}var ui=class t{loadingService=D(ea);isLoading$=this.loadingService.isLoading$;totalProgress$=this.loadingService.totalProgress$;static \u0275fac=function(n){return new(n||t)};static \u0275cmp=q({type:t,selectors:[["app-progress-bar"]],decls:3,vars:3,consts:[[1,"relative"],[1,"absolute","z-10","h-2","w-full","bg-gray-300"],[1,"h-full","bg-primary","transition-all"]],template:function(n,r){n&1&&(x(0,"div",0),Q(1,Yf,3,4,"div",1),lt(2,"async"),h()),n&2&&(w(),K(Ht(2,1,r.isLoading$)?1:-1))},dependencies:[qn],encapsulation:2})};var Bo=(t,e)=>e.value,Wf=()=>["/portal"];function Xf(t,e){if(t&1){let n=St();x(0,"li",26),tt("click",function(){let i=wt(n).$implicit,o=z(2);return bt(o.onYearChange(i.value))}),C(1),h()}if(t&2){let n=e.$implicit;w(),Vt(" ",n.label," ")}}function jf(t,e){if(t&1&&(x(0,"ul"),rt(1,Xf,2,1,"li",null,Bo),h()),t&2){let n=z();w(),it(n.gregorianYearOptions)}}function Jf(t,e){if(t&1){let n=St();x(0,"li",26),tt("click",function(){let i=wt(n).$implicit,o=z(2);return bt(o.onRegionChange(i.value))}),C(1),h()}if(t&2){let n=e.$implicit;w(),et(n.label)}}function Kf(t,e){if(t&1&&(x(0,"ul"),rt(1,Jf,2,1,"li",null,Bo),h()),t&2){let n=z();w(),it(n.regionOptions)}}function Qf(t,e){if(t&1){let n=St();x(0,"li",26),tt("click",function(){let i=wt(n).$implicit,o=z(2);return bt(o.onDistrictChange(i.value))}),C(1),h()}if(t&2){let n=e.$implicit;w(),et(n.label)}}function Zf(t,e){if(t&1&&(x(0,"ul"),rt(1,Qf,2,1,"li",null,Bo),h()),t&2){let n=z();w(),it(n.districtOptions)}}var ci=class t{_destroy=new Lt;gregorianYearOptions;gregorianYear;gregorianYearChange=new Ot;gregorianYearLabel="";isAdYearSelectOpen=!1;regionOptions;regionCode;regionCodeChange=new Ot;regionLabel="";isRegionSelectOpen=!1;districtOptions;districtCode;districtCodeChange=new Ot;districtLabel="";isDistrictSelectOpen=!1;ngOnChanges(e){let{regionOptions:n,districtOptions:r}=e;if(n&&Array.isArray(n.currentValue)){let s={label:"\u5168\u90E8\u7E23\u5E02",value:""};!!n.currentValue.find(l=>l.value===s.value)||n.currentValue.unshift(s)}if(r&&Array.isArray(r.currentValue)){let s={label:"\u5168\u90E8\u9109\u93AE\u5E02\u5340",value:""};!!r.currentValue.find(l=>l.value===s.value)||r.currentValue.unshift(s)}let{gregorianYear:i,regionCode:o,districtCode:a}=e;if(i){let s=this.gregorianYearOptions.find(c=>c.value===i.currentValue);s&&(this.gregorianYearLabel=s.label)}if(o){let s=this.regionOptions.find(c=>c.value===o.currentValue);s&&(this.regionLabel=s.label)}if(a){let s=this.districtOptions.find(c=>c.value===a.currentValue);s&&(this.districtLabel=s.label)}}ngOnInit(){Yo(rn(document,"click"),rn(document,"scroll")).pipe($t(this._destroy),zn(0)).subscribe(()=>this.closeAllSelects())}ngOnDestroy(){this._destroy.next(),this._destroy.complete()}closeAllSelects(){this.isAdYearSelectOpen=!1,this.isRegionSelectOpen=!1,this.isDistrictSelectOpen=!1}onYearChange(e){this.isAdYearSelectOpen=!this.isAdYearSelectOpen,this.gregorianYearChange.emit(e)}onRegionChange(e){this.isRegionSelectOpen=!this.isRegionSelectOpen,this.regionCodeChange.emit(e)}onDistrictChange(e){this.isDistrictSelectOpen=!this.isDistrictSelectOpen,this.districtCodeChange.emit(e)}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=q({type:t,selectors:[["app-header"]],inputs:{gregorianYearOptions:"gregorianYearOptions",gregorianYear:"gregorianYear",regionOptions:"regionOptions",regionCode:"regionCode",districtOptions:"districtOptions",districtCode:"districtCode"},outputs:{gregorianYearChange:"gregorianYearChange",regionCodeChange:"regionCodeChange",districtCodeChange:"districtCodeChange"},features:[dt],decls:39,vars:11,consts:[[1,"sticky","top-[-48px]","z-50","shadow","xl:top-0"],[1,"border-b-[1px]","border-solid","border-gray-300","bg-white","xl:px-6","xl:py-3"],[1,"flex","flex-col","justify-center","xl:flex-row","xl:items-center","xl:justify-between","xl:gap-x-4"],[1,"flex","items-center","justify-between","px-4","py-2","xl:justify-start","xl:gap-x-6","xl:p-0"],[3,"routerLink"],["src","images/logo.png","alt","logo",1,"h-[28px]","xl:h-[40px]"],[1,"flex","items-center","gap-x-3"],[1,"hidden","text-base","font-bold","text-dark","xl:block"],[1,"cmp-dropdown","w-[118px]"],["type","text","readonly","","placeholder","\u8ACB\u9078\u64C7",3,"click","value"],["src","images/icons/expand_more.png","alt","expand_more"],[1,"px-4","py-2","xl:static","xl:flex","xl:grow","xl:items-center","xl:justify-between","xl:p-0"],[1,"flex","items-center","rounded-full","bg-gray-200"],["src","images/icons/search.png","alt","search",1,"ml-3","hidden","xl:block"],[1,"cmp-dropdown","w-1/2","xl:w-[194px]"],["type","text","readonly","","placeholder","\u9078\u64C7\u7E23\u5E02",3,"click","value"],[1,"h-4","border-s","border-solid","border-gray-400"],["type","text","readonly","","placeholder","\u9078\u64C7\u5340\u57DF",3,"click","value"],[1,"hidden","grow","items-center","justify-end","gap-x-4","xl:flex"],[1,"text-base","font-normal","text-dark"],["href","http://www.facebook.com"],["src","images/icons/facebook-icon.png","alt","facebook-icon",1,"h-6"],["href","http://www.instagram.com"],["src","images/icons/instagram-icon.png","alt","instagram-icon",1,"h-6"],["href","http://www.youtube.com"],["src","images/icons/youtube-icon.png","alt","youtube-icon",1,"h-6"],[3,"click"]],template:function(n,r){n&1&&(x(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"a",4)(5,"h1"),H(6,"img",5),h()(),x(7,"div",6)(8,"div",7),C(9,"\u9078\u64C7\u5E74\u4EFD"),h(),x(10,"div",8)(11,"input",9),tt("click",function(o){return o.stopPropagation(),r.closeAllSelects(),r.isAdYearSelectOpen=!0}),h(),x(12,"div"),H(13,"img",10),h(),Q(14,jf,3,0,"ul"),h()()(),x(15,"div",11)(16,"div",12),H(17,"img",13),x(18,"div",14)(19,"input",15),tt("click",function(o){return o.stopPropagation(),r.closeAllSelects(),r.isRegionSelectOpen=!0}),h(),x(20,"div"),H(21,"img",10),h(),Q(22,Kf,3,0,"ul"),h(),H(23,"div",16),x(24,"div",14)(25,"input",17),tt("click",function(o){return o.stopPropagation(),r.closeAllSelects(),r.isDistrictSelectOpen=!0}),h(),x(26,"div"),H(27,"img",10),h(),Q(28,Zf,3,0,"ul"),h()(),x(29,"div",18)(30,"div",19),C(31,"\u5206\u4EAB"),h(),x(32,"a",20),H(33,"img",21),h(),x(34,"a",22),H(35,"img",23),h(),x(36,"a",24),H(37,"img",25),h()()()()(),H(38,"app-progress-bar"),h()),n&2&&(w(4),B("routerLink",Ve(10,Wf)),w(7),B("value",r.gregorianYearLabel),w(2),B("@iconOpenClose",r.isAdYearSelectOpen?"open":"closed"),w(),K(r.isAdYearSelectOpen?14:-1),w(5),B("value",r.regionLabel),w(2),B("@iconOpenClose",r.isRegionSelectOpen?"open":"closed"),w(),K(r.isRegionSelectOpen?22:-1),w(3),B("value",r.districtLabel),w(2),B("@iconOpenClose",r.isDistrictSelectOpen?"open":"closed"),w(),K(r.isDistrictSelectOpen?28:-1))},dependencies:[Qo,ta,Do,ui],encapsulation:2,data:{animation:[Wn("iconOpenClose",[$e("open",Fe({transform:"rotate(180deg)"})),$e("closed",Fe({transform:"rotate(0deg)"})),Be("open => closed",[Ge("0.15s")]),Be("closed => open",[Ge("0.15s")])])]}})};var fi=class t{countyFeatures=[];townshipFeatures=[];mapColorConfig={};regionCode;regionCodeChange=new Ot;districtCode;districtCodeChange=new Ot;_elementRef=D(se);_commonService=D(Nt);_width=800;_height=600;_svg;_container;_projection;_path;_currentZoom=1;_countiesCode=["09007","09020","10016"];_outerIslandCountySettings=[];_destroy=new Lt;ngOnChanges(e){return nn(this,null,function*(){let{regionCode:n,mapColorConfig:r}=e;if(n&&(yield this._handleRegionCodeChange(n.currentValue)),r&&r.currentValue){let i="#ddd";this._container.selectAll(".d3-county-path").attr("fill",o=>this.mapColorConfig[this._getRegionCode(o)]||i),this._container.select(`.${"d3-region-"+this.regionCode}`).selectAll(".d3-township-path").attr("fill",o=>this.mapColorConfig[this._getTownshipCode(o)]||i)}})}ngAfterViewInit(){this._commonService.createResizeObservable(this._elementRef.nativeElement).pipe($t(this._destroy),ae(50),oe(0)).subscribe(()=>this._rerenderMap()),this._initializeMap(),this._renderCountyLayer(this.countyFeatures)}ngOnDestroy(){this._destroy.next(null),this._destroy.complete()}_handleRegionCodeChange(e){return nn(this,null,function*(){if(!(!this._svg||!this._projection||!this._path)){if(this._container.selectAll(".d3-county-name").style("opacity","0"),this._renderTownshipLayer(""),e==="")this._toggleOuterIslandRectFocusRender(!1),yield this.zoomToAllCounty().end(),this._container.selectAll(".d3-county-name").style("opacity","1").raise();else{let n=!!this._outerIslandCountySettings.find(r=>r.code===e);this._toggleOuterIslandRectFocusRender(n),yield this._zoomToCounty(e)?.end()}this._renderTownshipLayer(e)}})}_updateSvgDimensions(){this._width=this._elementRef.nativeElement.clientWidth,this._height=this._elementRef.nativeElement.clientHeight}_updateMapLayout(){this._updateSvgDimensions(),this._projection.translate([this._width/2,this._height/2]),this._path=Xr().projection(this._projection)}_rerenderMap(){!this._svg||!this._projection||!this._path||(this._updateMapLayout(),this._container.selectAll(".d3-county-path").attr("d",e=>this._getTargetPath(this._getRegionCode(e))(e)),this._container.selectAll(".d3-township-path").attr("d",e=>this._getTargetPath(this._getRegionCode(e))(e)),this._container.selectAll(".d3-info-text").attr("x",e=>`${this._getPathCentroid(e)[0]}`).attr("y",e=>`${this._getPathCentroid(e)[1]}`).attr("transform",e=>this._getTextTransform(e)),this._zoomToCounty(this.regionCode))}_initializeMap(){this._svg=Dt(this._elementRef.nativeElement).append("svg").style("width","100%").style("height","100%").on("click",e=>{e.target.tagName==="path"||e.target.tagName==="rect"||this.regionCodeChange.emit("")}),this._container=this._svg.append("g"),this._projection=Jr().center([120.95,23.6]).scale(12500),this._updateMapLayout()}_renderHighlight(e,n){this._container.selectAll(".d3-highlight-path").data(e?[e]:[]).join(r=>(r.append("path").attr("d",i=>n(i)).attr("class","d3-highlight-path").style("fill","white").style("opacity","0.2").style("pointer-events","none"),this._svg.selectAll("text").raise(),r),r=>(this._svg.selectAll("text").raise(),r),r=>r.remove())}_renderCountyLayer(e){let n={spacing:8,marginTop:16,marginLeft:16};this._countiesCode.forEach((r,i)=>{let o=e.find(d=>d.properties.COUNTYCODE===r);if(!o)return;let a=72,s=r==="10016"?138:73,c=n.marginLeft,l=this._outerIslandCountySettings.slice(0,i).map(d=>d.boxHeight).reduce((d,m)=>d+m,n.marginTop+n.spacing*i),u=Jr().fitExtent([[c+a*.1,l+a*.1],[c+a*.8,l+s*.8]],o),p=Xr().projection(u),f=`translate(${c+a*.1}, ${l+s*.1})`;this._outerIslandCountySettings.push({code:r,x:c,y:l,boxWidth:a,boxHeight:s,projection:u,path:p,transform:f})}),this._container.selectAll(".d3-region-item").data(e).join("g").attr("class",r=>`d3-region-item ${"d3-region-"+this._getRegionCode(r)}`).call(r=>(this._drawMainIslandCountry(r.filter(i=>!this._countiesCode.includes(this._getRegionCode(i)))),this._drawOuterIslandCountry(r.filter(i=>this._countiesCode.includes(this._getRegionCode(i)))),r)),this._renderPlaceNameLayer(e,"d3-county-name")}_drawMainIslandCountry(e){e.selectAll(".d3-county-path").data(n=>[n]).join("path").attr("class",n=>`d3-county-path ${"d3-path-"+this._getRegionCode(n)}`).attr("d",this._path).on("mouseenter",(n,r)=>this._renderHighlight(r,this._path)).on("mouseleave",n=>this._renderHighlight(null,this._path)).on("click",(n,r)=>this.regionCodeChange.emit(this._getRegionCode(r)))}_drawOuterIslandCountry(e){let n=r=>{let i=this._outerIslandCountySettings.findIndex(o=>o.code===this._getRegionCode(r));return this._outerIslandCountySettings[i]};e.selectAll("rect").data(r=>[r]).join("rect").attr("x",r=>n(r).x).attr("y",r=>n(r).y).attr("rx",8).attr("ry",8).attr("width",r=>n(r).boxWidth).attr("height",r=>n(r).boxHeight).attr("fill","white").on("mouseenter",(r,i)=>this._renderHighlight(i,n(i).path)).on("mouseleave",(r,i)=>this._renderHighlight(null,n(i).path)).on("click",(r,i)=>this.regionCodeChange.emit(this._getRegionCode(i))),e.selectAll(".d3-county-path").data(r=>[r]).join("path").attr("class",r=>`d3-county-path ${"d3-path-"+this._getRegionCode(r)}`).attr("d",r=>n(r).path(r)).attr("pointer-events","none")}_renderTownshipLayer(e){if(this._container.selectAll(".d3-township-name").remove(),this._container.selectAll(".d3-township-path").remove(),e===""||!e)return;let n=this.townshipFeatures.filter(r=>r.properties.COUNTYCODE===e);this._container.select(`.${"d3-region-"+e}`).selectAll(".d3-township-path").data(n).join("path").attr("class",r=>`d3-township-path ${"d3-path-"+this._getTownshipCode(r)}`).attr("d",r=>this._getTargetPath(this._getRegionCode(r))(r)).on("mouseenter",(r,i)=>this._renderHighlight(i,this._getTargetPath(e))).on("mouseleave",r=>this._renderHighlight(null,this._getTargetPath(e))).on("click",(r,i)=>this.districtCodeChange.emit(this._getTownshipCode(i))),this._renderPlaceNameLayer(n,"d3-township-name")}_toggleOuterIslandRectFocusRender(e){this._container.selectAll("rect").style("opacity",e?"0":"1").style("pointer-events",e?"none":"auto")}_getRegionCode(e){return e.properties.COUNTYCODE}_getTownshipCode(e){return e.properties.TOWNCODE}_getTargetPath(e){let n=this._outerIslandCountySettings.find(r=>r.code===e);return n?n.path:this._path}_getPathCentroid(e){let n=this._outerIslandCountySettings.findIndex(i=>i.code===this._getRegionCode(e)),r=e.properties.COUNTYCODE&&!e.properties.TOWNCODE;return n!==-1&&r?[this._outerIslandCountySettings[n].x+this._outerIslandCountySettings[n].boxWidth/2,this._outerIslandCountySettings[n].y+this._outerIslandCountySettings[n].boxHeight-12]:this._getTargetPath(this._getRegionCode(e)).centroid(e).map((i,o)=>i+o*this._getTextFontSize()/2)}_getTextFontSize(){return 16/this._currentZoom}_getTextTransform(e){let n=!e.properties.TOWNCODE,r=(a,s)=>{if(!s)return{x:0,y:0};switch(a){case"10017":return{x:30,y:-15};case"63000":return{x:5,y:10};case"65000":return{x:-5,y:20};case"68000":return{x:-15,y:-25};case"10018":return{x:35,y:-10};case"10004":return{x:5,y:5};case"10005":return{x:-5,y:0};case"66000":return{x:-20,y:5};case"10009":return{x:0,y:-10};case"10020":return{x:0,y:10};case"10010":return{x:40,y:0};case"64000":return{x:10,y:0};case"10013":return{x:-15,y:-30};case"10015":return{x:5,y:0};default:return{x:0,y:0}}},{x:i,y:o}=r(this._getRegionCode(e),n);return`translate(${i}, ${o})`}_getTextContent(e){return e.properties.TOWNCODE?e.properties.TOWNNAME:this._countiesCode.includes(this._getRegionCode(e))?(r=>r==="\u9023\u6C5F"?"\u99AC\u7956":r)(e.properties.COUNTYNAME.replace("\u7E23","")):e.properties.COUNTYNAME}_renderPlaceNameLayer(e,n){let r=this._container;if(n==="d3-township-name"){let i=this._getRegionCode(e[0]);this._outerIslandCountySettings.findIndex(a=>a.code===i)!==-1&&(r=r.select(`.${"d3-region-"+i}`))}r.selectAll(`.${n}`).data(e).join("text").attr("class",`d3-info-text ${n}`).attr("font-size",`${this._getTextFontSize()}px`).attr("x",i=>`${this._getPathCentroid(i)[0]}`).attr("y",i=>`${this._getPathCentroid(i)[1]}`).attr("transform",i=>this._getTextTransform(i)).text(i=>this._getTextContent(i)).raise()}_zoomToCounty(e){let n=this.countyFeatures.find(p=>p.properties.COUNTYCODE===e);if(n===void 0)return;let i=this._getTargetPath(e).bounds(n),o=i[1][0]-i[0][0],a=i[1][1]-i[0][1],s=(i[0][0]+i[1][0])/2,c=(i[0][1]+i[1][1])/2,l=Math.max(1,Math.min(25,.9/Math.max(o/this._width,a/this._height))),u=[this._width/2-l*s,this._height/2-l*c];return this._currentZoom=l,this._container.interrupt().transition().duration(500).attr("transform",`translate(${u[0]},${u[1]}) scale(${l})`)}zoomToAllCounty(){return this._currentZoom=1,this._container.interrupt().transition().duration(500).attr("transform","translate(0, 0) scale(1)")}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=q({type:t,selectors:[["app-zh-tw-map"]],inputs:{countyFeatures:"countyFeatures",townshipFeatures:"townshipFeatures",mapColorConfig:"mapColorConfig",regionCode:"regionCode",districtCode:"districtCode"},outputs:{regionCodeChange:"regionCodeChange",districtCodeChange:"districtCodeChange"},features:[dt],decls:0,vars:0,template:function(n,r){},encapsulation:2})};function If(t,e){if(t&1){let n=St();x(0,"app-zh-tw-map",15),tt("regionCodeChange",function(i){wt(n);let o=z();return bt(o.changeRegionCode(i))})("districtCodeChange",function(i){wt(n);let o=z();return bt(o.changeDistrictCode(i))}),h()}if(t&2){let n=z();B("mapColorConfig",n.mapColorConfig)("countyFeatures",n.regionFeatures)("townshipFeatures",n.districtFeatures)("regionCode",n.regionCode)("districtCode",n.districtCode)}}function Df(t,e){if(t&1){let n=St();x(0,"button",16),tt("click",function(){wt(n);let i=z();return bt(i.backToPreviousLevel())}),H(1,"img",17),h()}}function tp(t,e){if(t&1&&H(0,"app-breadcrumb",10),t&2){let n=z();B("breadcrumbList",n.breadcrumbList)}}var lu=class t{_route=D(Io);_apiService=D(jn);_commonService=D(Nt);_destroy=new Lt;_refetchVoteData$=new Lt;adminCentralTitle="\u5168\u81FA\u7E23\u5E02\u7E3D\u7D71\u5F97\u7968";gregorianYearOptions=this._commonService.getYearsSince1996().map(e=>this._commonService.convertOption(e,e));regionOptions=[];districtOptions=[];regionFeatures=[];districtFeatures=[];mapColorConfig={};gregorianYear="";regionCode="";districtCode="";adminTitle=this.adminCentralTitle;breadcrumbList=[];candidateNoOrder=[];activePartyOrder=[];electionInfo;historicalVoteCounts=[];historicalVoteRates=[];isLoaded=!1;ngOnInit(){this._fetchMapGeoJson(),this._refetchVoteData$.pipe($t(this._destroy),zn(100),qo((n,r)=>JSON.stringify(n)===JSON.stringify(r)),Wo(n=>this._fetchVotingData(...n))).subscribe(n=>this._renderVotingData(...n));let{beginGregorianYear:e}=this._route.snapshot.queryParams;this.gregorianYear=e||this._commonService.getYearsSince1996().pop(),this._refetchVoteData$.next([this.gregorianYear,this.regionCode,this.districtCode])}ngOnDestroy(){this._destroy.next(),this._destroy.complete()}_fetchMapGeoJson(){this._apiService.fetchCountyGeoJson().subscribe(e=>this.regionFeatures=e),this._apiService.fetchTownshipGeoJson().subscribe(e=>this.districtFeatures=e)}_fetchVotingData(e,n,r){let i=this._commonService.getYearsSince1996().map(o=>r!==""?this._apiService.fetchTownVotesJson(o,r):n!==""?this._apiService.fetchCountyVotesJson(o,n):this._apiService.fetchCentralVotesJson(o)).map(o=>o.pipe(xi(()=>gi(void 0))));return To(i).pipe(yt(o=>[e,n,r,o]))}_renderVotingData(e,n,r,i){return nn(this,null,function*(){if(this.gregorianYear!==e&&(this.mapColorConfig={},n!=="")){let a=this._apiService.fetchCentralVotesJson(e).pipe(xi(()=>gi(void 0))),s=(yield zo(a))||new Wt;this._updateMapColorConfig(s)}this.regionOptions.length===1&&(this.regionOptions=this.regionFeatures.map(a=>a.properties).map(a=>this._commonService.convertOption(a.COUNTYNAME,a.COUNTYCODE)).sort((a,s)=>a.value.localeCompare(s.value)*-1)||[]),n===""&&(this.districtOptions=[]),n!==""&&r===""&&(this.districtOptions=this.districtFeatures.map(a=>a.properties).filter(a=>a.COUNTYCODE===n).map(a=>this._commonService.convertOption(a.TOWNNAME,a.TOWNCODE)).sort((a,s)=>a.value.localeCompare(s.value)*-1)||[]),this.gregorianYear=e,this.regionCode=n,this.districtCode=r;let o=i.findIndex(a=>a?.ELECTION_GREGORIAN_YEAR===e);if(this.electionInfo=i[o],n==="")this.adminTitle=this.adminCentralTitle,this.breadcrumbList=[];else{let s=this.regionOptions.find(u=>u.value===n)?.label||"Unknown Region Code: "+n,l=this.districtOptions.find(u=>u.value===r)?.label||"Unknown District Code: "+r;this.adminTitle=r===""?s:l,this.breadcrumbList=[this.adminCentralTitle,s],r!==""&&this.breadcrumbList.push(l)}this.candidateNoOrder=[...this.electionInfo?.TOTAL_STATISTICS?.CANDIDATES_VOTES||[]].sort((a,s)=>(s.VOTE_COUNT||0)-(a.VOTE_COUNT||0)).map(a=>a.NO||0),this.activePartyOrder=this.candidateNoOrder.reduce((a,s)=>{let c=this.electionInfo?.CANDIDATES.find(l=>l.NO==s);return c&&a.push(qt[c.PARTY]),a},[]),this._calculateHistoricalVotingData(this.activePartyOrder,i),this._updateMapColorConfig(this.electionInfo||new Wt),this._commonService.scrollToTop(),this.isLoaded||(this.isLoaded=!0)})}_updateMapColorConfig(e){let n=e.ADMIN_COLLECTION.map(r=>{let i=r.CANDIDATES_VOTES.reduce((s,c)=>{let l=s.VOTE_COUNT??-1/0;return(c.VOTE_COUNT??-1/0)>l?c:s},r.CANDIDATES_VOTES[0]),o=e.CANDIDATES.findIndex(s=>s.NO==i.NO),a=qt[e.CANDIDATES[o].PARTY]?.REPRESENTATIVE_COLOR||"";return{[r.ADMIN_CODE]:a}}).reduce((r,i)=>xe(xe({},r),i),{});this.mapColorConfig=xe(xe({},this.mapColorConfig),n)}_calculateHistoricalVotingData(e,n){let r=[],i=[];if(n.every(o=>o===void 0)||e.length===0){this.historicalVoteCounts=r,this.historicalVoteRates=i;return}this._commonService.getYearsSince1996().map(o=>String(o)).forEach(o=>{if(e.length===0){let u={groupId:o,subgroupId:"",value:0,color:""};r.push(u),i.push(u);return}let a=n.findIndex(u=>u?.ELECTION_GREGORIAN_YEAR===o),s=n[a]||new Wt,c=s.CANDIDATES,l=s.TOTAL_STATISTICS.CANDIDATES_VOTES;e.forEach(u=>{let p={groupId:o,subgroupId:u.EN_SHORT_NAME,value:0,color:u.REPRESENTATIVE_COLOR},f=c.find(y=>y.PARTY===u.EN_SHORT_NAME),d=l.find(y=>y.NO==f?.NO);p.value=d?.VOTE_COUNT||0,r.push(p);let m={groupId:o,subgroupId:u.EN_SHORT_NAME,value:0,color:u.REPRESENTATIVE_COLOR},_=s.TOTAL_STATISTICS.TOTAL_VOTES||0;m.value=_?p.value/_:0,i.push(m)})}),this.historicalVoteCounts=r,this.historicalVoteRates=i}changeGregorianYear(e){this._refetchVoteData$.next([e,this.regionCode,this.districtCode])}changeRegionCode(e){this._refetchVoteData$.next([this.gregorianYear,e,""])}changeDistrictCode(e){this._refetchVoteData$.next([this.gregorianYear,this.regionCode,e])}changeAdminCodeWithSubAdmin(e){this.regionCode===""?this.changeRegionCode(e):this.districtCode===""&&this.changeDistrictCode(e)}backToPreviousLevel(){if(this.districtCode!==""){this.changeDistrictCode("");return}if(this.regionCode!==""){this.changeRegionCode("");return}}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=q({type:t,selectors:[["app-historical-review"]],decls:19,vars:21,consts:[[3,"gregorianYearChange","regionCodeChange","districtCodeChange","gregorianYearOptions","gregorianYear","regionOptions","regionCode","districtOptions","districtCode"],[1,"grid","grid-cols-1","2xl:grid-cols-[500px,1fr]"],[1,"relative","bg-[#E4FAFF]"],[1,"top:auto","static","block","h-[148px]","2xl:sticky","2xl:top-[65px]","2xl:h-[calc(100dvh-65px)]",3,"mapColorConfig","countyFeatures","townshipFeatures","regionCode","districtCode"],[1,"flex","flex-col","justify-between"],[1,"grid","auto-rows-min","grid-cols-1","gap-6","px-4","py-8","2xl:grid-cols-2","2xl:px-12"],[1,"grid","gap-y-3","2xl:col-span-2"],[1,"flex","items-center","gap-x-3"],["type","button",1,"flex","h-9","w-9","items-center","justify-center","rounded-full","bg-gray-200"],[1,"text-2xl","font-bold","text-dark","2xl:text-3xl"],[3,"breadcrumbList"],[3,"isLoaded","electionInfo","candidateNoOrder"],[3,"isLoaded","activePartyOrder","historicalVoteCounts"],[3,"isLoaded","activePartyOrder","historicalVoteRates"],[1,"2xl:col-span-2",3,"adminChange$","electionInfo","candidateNoOrder"],[1,"top:auto","static","block","h-[148px]","2xl:sticky","2xl:top-[65px]","2xl:h-[calc(100dvh-65px)]",3,"regionCodeChange","districtCodeChange","mapColorConfig","countyFeatures","townshipFeatures","regionCode","districtCode"],["type","button",1,"flex","h-9","w-9","items-center","justify-center","rounded-full","bg-gray-200",3,"click"],["src","images/icons/arrow_back.png","alt","arrow_back",1,"pointer-events-none","h-5","w-5"]],template:function(n,r){n&1&&(x(0,"app-header",0),tt("gregorianYearChange",function(o){return r.changeGregorianYear(o)})("regionCodeChange",function(o){return r.changeRegionCode(o)})("districtCodeChange",function(o){return r.changeDistrictCode(o)}),h(),x(1,"div",1)(2,"div",2),Q(3,If,1,5,"app-zh-tw-map",3),h(),x(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7),Q(8,Df,2,0,"button",8),x(9,"h2",9),C(10),h()(),x(11,"div"),Q(12,tp,1,1,"app-breadcrumb",10),h(),H(13,"app-presidential-votes",11),h(),H(14,"app-historical-party-vote-counts",12)(15,"app-historical-party-vote-rates",13),x(16,"app-voting-overview",14),tt("adminChange$",function(o){return r.changeAdminCodeWithSubAdmin(o)}),h()(),H(17,"app-footer"),h()(),H(18,"app-to-top-button")),n&2&&(B("gregorianYearOptions",r.gregorianYearOptions)("gregorianYear",r.gregorianYear)("regionOptions",r.regionOptions)("regionCode",r.regionCode)("districtOptions",r.districtOptions)("districtCode",r.districtCode),w(3),K(r.regionFeatures.length!==0&&r.districtFeatures.length!==0?3:-1),w(5),K(r.adminTitle!==r.adminCentralTitle?8:-1),w(2),et(r.adminTitle),w(2),K(r.breadcrumbList.length>1?12:-1),w(),B("isLoaded",r.isLoaded)("electionInfo",r.electionInfo)("candidateNoOrder",r.candidateNoOrder),w(),B("isLoaded",r.isLoaded)("activePartyOrder",r.activePartyOrder)("historicalVoteCounts",r.historicalVoteCounts),w(),B("isLoaded",r.isLoaded)("activePartyOrder",r.activePartyOrder)("historicalVoteRates",r.historicalVoteRates),w(),B("electionInfo",r.electionInfo)("candidateNoOrder",r.candidateNoOrder))},dependencies:[ci,fi,Jn,ai,ni,ii,si,li,Kn],encapsulation:2})};export{lu as HistoricalReviewComponent};
